%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\def\STUDENT{} % \def すると計算問題の解答を印刷しなくなる.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% 線形代数学演習---行列の標準形
% 
% 黒木 玄 (東北大学理学部数学教室, kuroki@math.tohoku.ac.jp)
%
% この演習問題集は2005年度における東北大学理学部数学科2年生前期の
% 代数学序論B演習のために作成されました. 
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[12pt,twoside]{jarticle}
%\documentclass[12pt]{jarticle}
\usepackage{amsmath,amssymb,amscd}
\usepackage{eepic}
\usepackage{enshu}
%\usepackage{showkeys}
\allowdisplaybreaks
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\setcounter{page}{1}       % この数から始まる
\setcounter{section}{-1}   % この数の次から始まる%
\setcounter{theorem}{0}    % この数の次から始まる
\setcounter{question}{0}   % この数の次から始まる
\setcounter{footnote}{0}   % この数の次から始まる
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\ifx\STUDENT\undefined
% 教師専用
\newcommand\commentout[1]{#1}
\else
% 生徒専用
\newcommand\commentout[1]{}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\fi
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{\bf 代数学序論B演習}
\author{黒木 玄 \quad (東北大学大学院理学研究科数学専攻)}
\date{2007年4月10日}

\maketitle
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\tableofcontents

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{この演習のルール}

私が渡した文書に誤りを見つけた場合には気軽に指摘して欲しい.

\subsection{各演習時間の基本スケジュール}

\begin{description}
 \item[個人学習時間]
  渡された演習問題を解いて黒板の前で発表する準備をする. \\
  もしくは自主レポートの準備をする.
 \item[14時40分〜] 
  黒板の前で発表したい人はこのあいだに解答を黒板に書いておく. \\
  これと平行して自主レポートの提出を受け付ける. \\
  演習の時間に自主レポートを仕上げて演習の終わりに提出してはいけない. 
 \item[14時50分頃]
  解答を書き終えた人から黒板の前での発表開始.
 \item[演習終了後]
  個人的に数学の質問に答える. 
  数学の勉強の仕方に関する相談にものる.
\end{description}

なお, 毎週のように自主レポートを提出する必要はない. 
演習の最初の数回では熱心にレポートを提出していたが, 
終わりの方では全然レポートを出さなくなってしまうよりも, 
数週間に1回のペースでの提出を最後まで守る方が
ずっと優れていることに注意せよ.
数学の勉強は短距離走よりもマラソンに近い.

\subsection{数学をマスターするために必要な勉強法}

さて, ある程度以上のレベルの数学をマスターするためには
{\bf しっかり書かれた数学の本を丸ごと読む}
という勉強が必要になる. そのとき必要なことは
\begin{itemize}
 \item 証明の理解に論理的ギャップがあってはいけない,
 \item 数学的な具体例にはどのようなものがあるかをよく調べる,
 \item 本では説明が省略されている部分を完璧に埋める,
 \item 本よりも詳しい説明が書かれているノートを作る,
 \item 最終的には自家製の教科書を完成することを目指す,
 \item 何よりも重要なのは「数学的本質は何か」について考え続けること
\end{itemize}
などである. 
一冊の本を丸ごと読めない場合には
少なくとも章単位で丸ごと読むように努力するのが良い.
ノートの作成も重要である.
「教科書を読むよりも君のノートを読んだ方がわかりやすい」
と他人に言ってもらえるようなノートを書くことを目指して欲しい.

高校までの数学では問題単位で解き方を習得するような勉強の仕方をしていた人
が多いと思う. しかし現在勉強しているような数学を習得するためには
「数学の世界がどんな様子をしているか, その本質は何か」を理解するように
努力しなければいけない. 

私がたくさんの演習問題を渡すのはそれらの問題をすべて解いて欲しいからでは
ない. 演習問題を解く過程でまとまった知識の重要性に気付き, 
上に書いたような勉強に進むきっかけを作りたいからである.
演習の時間に「余計なこと」を話そうと努力しているのも同様の理由からである.

以上のような考え方に基づき, 
この演習では自主レポートとして
\begin{center}
 \large\bf 私が渡した問題を順番に大量に解いて提出することは禁止
\end{center}
する. 私が渡した問題を大量に解き続ける時間があるなら, 
上に書いたような勉強の仕方をした方が良い.
逆に, 上で説明した方法で数学を勉強しながら, 
\begin{center}
 \large\bf 疑問を質問にまとめてレポートとして提出することは推奨
\end{center}
される.
場合によっては問題を解いたレポートよりも質問のレポートの方を高く評価する
こともありえる.  自分が理解できていないことを論理的に説明することは
自分が理解していることをまとめるよりも圧倒的に難しい.
個人的に数学科の卒業生には「自分の疑問を論理的にまとめる能力」
が要求されると思う.

\subsection{論理的に口頭で説明できる能力も身に付けよう}

ここの数学科の卒業生が身に付けることができる能力は
\begin{itemize}
 \item 現代の進んだ数学の知識を身に付けること
 \item 英語で書かれた数学の文献を読めるようになること
 \item 単に日本語や英語の数学文献を読めるだけではなく, \\
  その内容を他人に対して口頭で論理的に説明できること
\end{itemize}
の3つだと思う.  4年生のときのセミナーで英語の文献を読むことになるので,
卒業までにしっかり勉強すれば英語で書かれた数学の文献も読めるようになる.
この演習では「数学の知識」だけではなく, 
「論理的に説明できること」をも身に付けてもらいたいと考えている.

以上の考え方に基づき, 
この演習では単位取得の必要条件として
一回以上黒板の前で発表することを義務として課すことにする. 
\begin{center}
 \large\bf 単位が欲しければ最低でも一回以上黒板の前で発表すること!
\end{center}
(自主)レポートも成績の参考にするが, 
単位を取得するためにはそれだけでは足りない. 
最終的に救済措置を設ける可能性もあるが, 
最初からそう期待しないこと.

しかし, 残念ながら演習の時間は限られているので話す練習を十分にできない
だろう. 一人当たり1〜3回程度黒板の前に立つだけで終わってしまうと思う.
しかし各自が問題の解答をノートにまとめるときに
他人に説明するために使えるような書き方を心がけるようにすれば
「話す準備の練習」は十分にできるように思われる.
数学の文章(問題の解答を含む)を書くときには
常に口頭での説明を要求されることを前提に書くべきである.
自分が説明するためにさえ使えないようでは書く意味がない.

問題の解答を書いたレポートや質問を書いたレポートを提出した場合には, 
レポートを見た後(提出の次週以降になる)に適当に見繕って
\begin{center}
 \large\bf
 レポートの内容を黒板の前で説明することを要求するかもしれない.
\end{center}
特に黒板に書かれた解答が少ない場合はそうするだろう.
主としてレポートを提出していても黒板の前で発表していない人
の中から選ぶ予定である.

黒板の前での発表を強制すると嫌われる場合があるのだが, 
数学について口頭での発表ができる能力は数学科の卒業生として
当然要求されるべき能力だと思うので以上のような方針を採用することにした.

\subsection{成績評価の方針}

%{\small
\begin{itemize}
 \item 黒板の前での発表と自主レポートの内容で成績を評価する.
 \item 各問題の基本点は10点であるが, 
       易しい問題にはそれ未満の点数が付けられ, 
       難しい問題には20点〜∞点の点数が付けられる.
       黒板の前で発表するとその基本点が5倍以上になり, 
       自主レポートで提出した場合には基本点がそのまま付けられる.
 \item {\bf 単位が欲しければ最低でも一回以上黒板の前で発表すること.}
 \item 救済措置があるかもしれないが, 最初からそう期待しないこと.
 \item 黒板の前で一回以上発表して最後まで
       論理的ギャップを埋めれば C 以上で単位を出す.
 \item 自力で解いた場合には他の人が黒板ですでに
       解いてしまったのと同じ問題の解答を黒板で発表してよい.
 \item 黒板の前での自主的な発表には自主レポート提出の5倍以上の点数を付ける.
 \item {\bf 自主レポートの内容を黒板の前で発表することを要求するかもしれない.}
 \item こちらが指名してレポートの内容を黒板の前で説明してもらった場合には
       「黒板の前での説明一回分」とはみなさない.
       しかし説明の内容が特別に良ければ例外的に
       「黒板の前での説明一回分」とみなされ, 
       5倍以上の点数が付けられることになる.
 \item 内容に論理的にギャップがある場合には減点する.
 \item {\bf 自主レポートで問題を大量に解いて提出することは禁止.\\
       1回のレポート提出あたり2問以下にして欲しい.}
 \item 一つのテーマについて同じような問題を複数解いて
       レポートとして提出するのではなく, 
       複数のテーマに関して複数のレポートを提出するように努力して欲しい.
 \item 線形代数学の本を読みながら感じた疑問を質問にまとめて
       レポートとして提出しても良い.
       そのようなレポートは高く評価し, 
       最低でも30点以上の点数を付ける.
       質問の内容が高度なものであれば
       100点以上の点数を付けてしまうかもしれない.
       ただし疑問の内容を私が理解できない場合は
       黒板の前での説明をお願いするかもしれない.
 \item 現在習っていることよりも進んだ数学について勉強した結果を
       自主レポートとして提出しても構わない.
 \item 問題に誤りを見つけた場合には適切に訂正して解こうとすること.
\end{itemize}
%}

黒板の前で一回以上発表しているという条件を満たしており, 
60点以上ならC, 90点以上ならB, 120点以上ならA, 150点以上ならAAの
成績を付ける予定である.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{群, 環, 体の紹介}

問題に誤りがある場合には訂正してから解くこと.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{群の定義}
\label{ss:group-def}

\begin{definition}[群]
\quad
\begin{enumerate}
\item 
  集合 $G$, 2項演算 $\cdot:G\times G\to G$, 要素 $1\in G$, 
  単項演算 $(\;\;)^{-1}:G\to G$ の4つ組 $(G,\,\cdot\,,1,(\;\;)^{-1})$ で以下
  の公理を満たすものを{\bf 群 (group)} と呼ぶ:
  \begin{enumerate}
  \item[(a)] $(xy)z = x(yz)$ \quad ($x,y,z\in G$)     \qquad {\bf (結合律)}.
  \item[(b)] $1x = x1 = x$ \quad ($x\in G$)           \qquad {\bf (単位元)}.
  \item[(c)] $x^{-1}x = xx^{-1} = 1$ \quad ($x\in G$) \qquad {\bf (逆元)}.
  \end{enumerate}
  $1$ を $G$ の単位元, $x^{-1}$ を $x$ の逆元と呼ぶ. 
  なお, 4つ組 $(G,\,\cdot\,,1,(\;\;)^{-1})$ を毎回並べて書くのは面倒なので, %
  単に $G$ は群であると言うのが普通である. 
\item
  群 $G$ がさらに次を満たしていると
  き, $G$ を{\bf 可換群 (commutative group)}
  もしくは {\bf Abel 群 (Abelian group)}と呼ぶ:
  \begin{enumerate}
  \item[(d)] $xy = yx$ \quad ($x,y\in G$) \qquad {\bf (可換性)}.
  \end{enumerate}
  Abel 群の $\,\cdot\,$, $1$, $(\;\;)^{-1}$ をそれぞれ %
  $+$, $0$, $-$ と書くことがある. 
  そのとき $G$ は{\bf 加法群 (additive group)}であると言う.
\item
  群 $G$ が有限集合であるとき, $G$ は{\bf 有限群 (finite group)}であると言い, 
  $G$ の要素の個数を $G$ の{\bf 位数 (order)}と呼ぶ.
\item
  群 $G$ の部分集合 $H$ が演算 $\cdot$, $(\;\;)^{-1}$ で閉じているならば, 
  $1\in H$ も成立し, $H$ は自然に群をなす.
  このとき $H$ は $G$ の{\bf 部分群 (subgroup)} であると言う.
  \qed
\end{enumerate}
\end{definition}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[群の定義に関する注意, 小問各3点]
  集合 $G$ に結合律を満たす2項演算 $\cdot:G\times G\to G$ が与えられていると
  き以下が成立する:
  \begin{enumerate}
  \item $1_L,1_R\in G$ が $1_Lx = x1_R = x\;(x\in G)$ を満たし
    ていれば $1_L=1_R$ である.  (つまり, 左単位元と右単位元は一致する.)
  \item $1_L\in G$ が $1_Lx = x\;(x\in G)$ を満たしていたとしても,
    $x1_R = x\;(x\in G)$ を満たす $1_R\in G$ が存在しない場合がある.
    (つまり, 左単位元があっても, 右単位元があるとは限らない.)
  \item $1\in G$ が $1x=x1=x$ ($x\in G$) を満たしているとき,
    任意の $a,l,r\in G$ に対して $la=ar=1$ ならば $l=r$ である. 
    (つまり, 両側単位元が存在するとき, 左逆元と右逆元は一致する.)
  \item $1_Lx=x\;(x\in G)$ を満たす要素 $1_L\in G$ と %
    $x^Lx=1_L\;(x\in G)$ を満たす写像 $(\;\;)^L:G\to G$ が存在する
    ならば $G$ は群である.
    (つまり, 左単位元と左逆元を持つような結合律を満たす2項演算が与えられた
    集合は群である.)
  \item $1_Lx=x\;(x\in G)$ を満たす要素 $1_L\in G$ と %
    $xx^R=1_L\;(x\in G)$ を満たす写像 $(\;\;)^R:G\to G$ が存在しても, 
    $G$ が群にならない場合がある.
    (つまり, 左単位元と右逆元があっても群になるとは限らない.)
    \qed
  \end{enumerate}
\end{question}

\begin{proof}[ヒント]
2. 集合 $A$ からそれ自身への写像 $p:A\to A$ が $p\circ p = p$ 
を満たしていると仮定する.  集合 $G$ 
を $G := \{\, p\circ f\mid \text{$f$ は $A$ からそれ自身への写像}\,\}$ と定め, %
$G$ に2項演算を写像の合成によって定めておく. 
このとき, その2項演算は結合律を満たし, $p\in G$ は左単位元になる.
しかし, $\id_A\not\in G$ であることもあり得るので, 右単位元が存在するとは
限らない. そのような例を具体的に構成して調べてみよ.

4.$x=1_Lx=x^{LL}x^Lx=x^{LL}1_L$ なので $xx^L=x^{LL}1_Lx^L=x^{LL}x^L=1_L$. 
よって, $x1_L=xx^Lx=1_Lx=x$.

5. 集合 $A$ と $a\in A$ に対して, $B:=A\setminus\{a\}$ と置き,
$G$ を次のように定める:
\begin{equation*}
  G = \{\, f:A\to A \mid
  \text{$f$ の $B$ への制限は $B$ から $B$ への全単射であり, 
        $f(a)\in B$} \,\}.
\end{equation*}
$G$ は写像の合成に関して閉じているので, 写像の合成によって結合律を満た
す2項演算を $G$ に定めることができる.
そのとき, 任意の $b\in B$ に対して, 
$1_b\in G$ を $1_b(x)=x$ ($x\in B$), $1_b(a)=b$ と定めると, 
$1_b$ は $G$ の左単位元である. 
$f\in G$ に対して $f^R\in G$ を %
$f^R(x)=f^{-1}(x)$ ($x\in B$), $f^R(a)=f^{-1}(b)$ と定め
ると $f\circ f^R = 1_b$ が成立する. 
しかし, $f(a)\ne f(b)$ を満たす $f\in G$ に対して %
$g\circ f = 1_b$ を満たす $g\in G$ は存在しない.
このような $f$ は $B$ が2つ以上の元を持てば存在する.
以上の議論の細部を埋めよ.
\qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[群の直積, 5点]
  $G$, $H$ が群であるとき, 直積集合 $G\times H$ に積を %
  $(g_1,h_1)(g_2,h_2) = (g_1g_2,h_1h_2)$ ($g_i\in G$, $h_i\in H$) と定義する
  と $G\times H$ は自然に群をなす.
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{definition}[生成系, 巡回群]
群の部分集合 $A\subset G$ が $G$ を{\bf 生成する(generate)} もしくは
$G$ の{\bf 生成系 (generating system)}であるとは, 
$G$ の任意の元を $A$ の元およびその逆元の有限個の積で表わすことができること
であると定義する. 1つの元から生成される群を{\bf 巡回群 (cyclic group)}と呼ぶ.
\qed
\end{definition}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[巡回群]
  以下を示せ:
  \begin{enumerate}
  \item $\Z$ は加法に関して巡回群である. (2点)
  \item 任意の巡回群は Abel 群である. (3点)
  \item 位数が素数に等しい有限群は巡回群である. (10点)
    \qed
  \end{enumerate}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{definition}[群の準同型 (homomorphism of groups)]
  群の間の写像 $f:G\to H$ が(群の)準同型写像 (homomorophism) であるとは, 
  $f$ が $f(xy) = f(x)f(y)$, $f(1)=1$, $f(x^{-1})=f(x)^{-1}$
  ($\forall x,y\in G$) を満たしていることである.
  \qed
\end{definition}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[群の準同型写像]
  以下を示せ:
  \begin{enumerate}
  \item 群の間の写像 $f:G\to H$ が $f(xy) = f(x)f(y)$ ($\forall x,y\in G$) 
    のみを満たしていることと, $f$ が準同型であることは同値である.
    (5点)
  \item 群 $G$ の恒等写像 $\id_G$ は準同型であり, 準同型写像の合成もまた準同
    型である. (2点)
  \item 準同型写像が逆写像を持てばその逆写像も準同型である. 逆写像を持つよう
    な群の準同型写像を群の{\bf 同型写像 (isomorphism of groups)} と呼ぶ.
    (3点)
  \qed
  \end{enumerate}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[像, 核]
 $f:G\to H$ は群のあいだの準同型写像であるとする.
 以下を示せ:
 \begin{enumerate}
  \item $f$ の{\bf 像 (image)} $\Image f$ を次のように定める:
   \begin{equation*}
    \Image f := f(G) = \{\, f(x) \mid x\in G \,\} \subset H.
   \end{equation*}
   $\Image f$ は群 $H$ の2項演算と逆元を取る操作で閉じており, 
   $H$ の単位元を含むので自然に群とみなせる.
   (つまり $\Image f$ は $H$ の{\bf 部分群 (subgroup)} である.)
  \item $f$ の{\bf 核 (kernel)} $\Ker f$ を次のように定める:
   \begin{equation*}
    \Ker f := f^{-1}(1) = \{\, x\in G \mid f(x)=1 \,\}.
   \end{equation*}
   $\Ker f$ は群 $G$ の2項演算と逆元を取る操作で閉じており, 
   $G$ の単位元を含むので自然に群とみなせ, 
   さらに任意の $x\in G$, $k\in\Ker f$ に対して $xkx^{-1}\in\Ker f$ となる.
   (つまり $\Ker f$ は $G$ の{\bf 正規部分群 (normal subgroup)}) である.)
   \qed
 \end{enumerate}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{群の例}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{置換群, 交代群}

\begin{definition}[置換群, 対称群]
 $n$ 個の元を持つ集合 $\{1,2,\ldots,n\}$ からそれ自身への全単射全体の
 集合を $S_n$ と書き, $S_n$ の元を $1,2,\ldots,n$ の{\bf 置換  (permutation)} 
 と呼ぶ.  
 写像の合成に関して $S_n$ は自然に群をなし, 
 {\bf 置換群 (permutation group)} もしくは{\bf 対称群 (symmetric group)} 
 と呼ばれる.
 $S_n$ の位数は $n!$ に等しい.
 互いに異なる $i,j\in\{1,2,\ldots,n\}$ に対して $i$ と $j$ を交換し, 他
 を動かさない置換を $(i,j)$ と書き, $i$ と $j$ の{\bf 互換 (transposition)} 
 と呼ぶ.
 \qed
\end{definition}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[置換群の生成系, あみだくじの原理, 20点]
  $i=1,\dots,n-1$ に対して隣り合う $i$ と $i+1$ の互換を $s_i=(i,i+1)$ 
  と書くことにする.
  このとき $\{s_1,s_2,\ldots,s_{n-1}\}$ は置換群 $S_n$ の生成系
  であり, それらは以下の関係式を満たしている:
  \begin{itemize}
  \item[(a)] $s_is_{i+1}s_i = s_{i+1}s_is_{i+1} \quad (i=1,\dots,n-2)$,
  \item[(b)] $s_is_j=s_js_i \quad (|i-j|\geqq2)$,
  \item[(c)] $s_i^2 = 1 \quad (i=1,\dots,n-1)$.
  \qed
  \end{itemize}
\end{question}

\begin{rem}
  上の問題の (a), (b), (c) は実は生成系 $\{s_1,s_2,\dots,s_{n-1}\}$ に
  関する置換群 $S_n$ の{\bf 基本関係式}になっている. \qed
\end{rem}

\begin{rem}
 $\{s_1,s_2,\dots,s_{n-1}\}$ から生成される群で基本関係式 (a), (b)
 を持つ群は{\bf 組紐群 (くみひも群, braid group)}と呼ばれている. 
 同様に置換群は{\bf 阿弥陀籤群 (あみだくじ群)}と呼ぶべきかもしれない.
 \qed
\end{rem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[10点]
  置換群と阿弥陀籤(あみだくじ)の関係について説明せよ. 
  あみだくじにおける横線は置換群のどの元に対応しているとみなせるか?
  \qed
\end{question}

\commentout{
\begin{proof}[略解]
  あみだくじにおける $i$ 番目と $i+1$ 番目の縦線のあいだの
  横線は互換 $s_i=(i,i+1)$ に対応している.
  基本関係式にも言及していればさらに20点追加する.
  \qed
\end{proof}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[偶置換, 奇置換, 20点]
  置換群 $S_n$ の元 $\sigma$ が, 互換の積で表わされているとき, そこに登場
  する互換が偶数個か奇数個かは表示によらずに決まっている. 
  偶数のとき $\sigma$ は{\bf 偶置換}であると言い, 
  奇数のとき{\bf 奇置換}であると言う. 
  $\sign:S_n\to\{\pm1\}$ を $\sigma$ が偶置換なら $\sign(\sigma)=1$,
  奇置換なら $\sign(\sigma)=-1$ と定めると, $\sign$ は群の準同型写像をなす.
  $\sign$ の核を $A_n$ と書き, $n$ 次{\bf 交代群 (alternating group)}と呼ぶ. 
  \qed
\end{question}

\begin{proof}[ヒント]
 互換 $\sigma_1,\ldots,\sigma_r$ の積で表示された
 置換 $\sigma = \sigma_1\cdots\sigma_r$ の
 差積 $\prod_{i<j}(x_i-x_j)$ への作用を自力で調べる. 
 もしくは任意の線形代数の教科書の行列式の節を参照せよ.
 \qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[15点]
  縦線が $100$ 本のあみだくじについて考える.
  縦線には左から順番に $1$ から $100$ までの番号を付けておく.
  $i$ 番目の縦線の一番上からスタートしてあみだくじの通常のルールに
  したがって進むと $\sigma(i)$ 番目の縦線でゴールに達するものとする.
  \begin{enumerate}
  \item 
    $i$ を $\sigma(i)$ に対応させる写像は $100$ 次の置換を与えることを説明せよ.
  \item
    あみだくじの横線の個数を $1000$ 本にすると, %
    $i=1,2,\ldots,99$ に対して $\sigma(i)=i+1$ となり $\sigma(100)=1$ と
    なるようなあみだくじを作ることができないことを証明せよ.
  \qed
  \end{enumerate}
\end{question}

\begin{proof}[ヒント]
  偶置換と奇置換の概念を自由に用いてよい.
  \qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[20点]
  縦線が $n$ 本のあみだくじについて考える.
  縦線には左から順番に $1$ から $n$ までの番号を付けておく.
  $i$ 番目の縦線の一番上からスタートしてあみだくじの通常のルールに
  したがって進むと $\sigma(i)$ 番目の縦線でゴールに達するものとする.
  \begin{enumerate}
  \item 
    $i$ を $\sigma(i)$ に対応させる写像は $n$ 次の置換を与えることを説明せよ.
  \item
    置換 $\sigma\in S_n$ の{\bf 長さ (length)}を $\ell(\sigma)$ と
    書くことにする:
    \begin{equation*}
      \ell(\sigma) 
      = \sharp
        \{\, (i,j) \mid 
        \text{$i,j=1,2,\ldots,n$ かつ $i<j$ かつ $\sigma(i)>\sigma(j)$}
        \,\}.
    \end{equation*}
    置換 $\sigma$ を与える横線の本数が $\ell(\sigma)$ 本のあみだくじを
    作れることを証明せよ.
    \qed
  \end{enumerate}
\end{question}  

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{一般線形群, 特殊線形群}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[一般線形群]
 $K$ は任意の体であるとする.
 $K$ の元を成分に持つ可逆な $n$ 次正方行列全体の集合を $GL_n(K)$ と書く
 と, $GL_n(K)$ は行列の積に関して自然に群をなすことを示せ.
 (ただし正方行列が可逆であることとその行列式が $0$ にならないことが
 同値であるという事実を使ってはいけない.)
 $GL_n(K)$ を $K$ 上の{\bf 一般線形群 (general linear group)} と呼ぶ.
 \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[三角行列のなす群]
  体 $K$ に対して, $GL_n(K)$ 内の上三角で対角線上の成分が全て 1 であるような
  行列全体の集合を $N_n(K)$ と書くと, $N_n(K)$ は $GL_n(K)$ の部分群である.
% しかし, $n\geqq2$ ならば $GL_n(K)$ の正規部分群ではない. 
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[有限体上の一般線形群の位数, 20点]
  $\F_q$ は位数 $q$ の(すなわち元の個数が $q$ 個であるような)有限体であるとする.
  このとき, $GL_n(\F_q)$ は有限群になり, その位数は
  \begin{equation*}
    (q^n-1)(q^n-q)(q^n-q^2)\cdots(q^n-q^{n-1})
    =q^{n(n-1)/2} (q^n-1)(q^{n-1}-1)\cdots(q^2-1)(q-1)
  \end{equation*}
  に等しい. $N_n(\F_q)$ の位数は $q^{n(n-1)/2}$ である.
  \qed
\end{question}

\begin{proof}[ヒント]
$GL_n(K)$ と $K^n$ の中の互いに一次独立な $n$ 本のベクトル
の組の全体のなす集合は自然に一対一に対応している. まず, 1本目のベクトルは
$0$ 以外のものを任意に選べる. 2本目のベクトルは1本目のベクトルで張られる
直線以外の場所から選ばなければいけない. 
3本目のベクトルは1本目と2本目のベクトルで張られる
平面以外の場所から選ばなければいけない. $\cdots\cdots$
もしも $K=\F_q$ ならば
1本目のベクトルの選び方は $q^n-1$ 通りあり, 
2本目のベクトルの選び方は $q^n-q$ 通りあり, 
3本目のベクトルの選び方は $q^n-q^2$ 通りあり, 
$\cdots\cdots$
\qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[特殊線形群]
  体 $K$ に対して, 行列式を取る写像 $\det:GL_n(K)\to K^\times$ は群の
  全射準同型写像である. $\det:GL_n(K)\to K^\times$ の核を $SL_n(K)$ と書き, 
  {\bf 特殊線形群 (special linear group)} と呼ぶ.
  位数 $q$ 有限体 $\F_q$ に対して, $SL_n(\F_q)$ の位数は次に等しい:
  \begin{equation*}
    q^{n(n-1)/2} (q^n-1)(q^{n-1}-1)\cdots(q^2-1). \qed
  \end{equation*}
\end{question}

\begin{rem}
 一般に有限群 $G$ の位数 $N$ の素因数分解を $N=p_1^{e_1}\cdots p_r^{e_r}$ 
 ($p_i$ は互いに異なる素数, $e_i$ は正の整数) と書くとき, 
 素数 $p=p_i$ に対して $G$ の位数 $p_i^{e_i}$ の部分群を $G$ 
 の {\bf Sylow $p$ 部分群 (Sylow $p$-subgroup)} と呼ぶ.
 有限体 $\F_q$ の位数 $q$ はある素数 $p$ のべき $p^e$ に等しい.
 以上の問題の結果から $N_n(\F_q)$ は $GL_n(\F_q)$ と $SL_n(\F_q)$ 
 の Sylow $p$ 部分群であることがわかる.
 \qed
\end{rem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{直交群, 特殊直交群}

体 $K$ の元を成分に持つ $n$ 次正方行列全体の集合を $M_n(K)$ と書く.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

実縦ベクトルの空間 $\R^n$ に
通常の内積とノルムを次のように入れておく:
\begin{alignat*}{2}
  &
  (x,y) := \tp{x}y = \sum_{i=1}^n x_i y_i 
  & &
  \quad (x=\tp{(x_1,\dots,x_n)}, y=\tp{(y_1,\dots,y_n)}\in\R^n),
  \\ &
  |x| := \sqrt{(x,x)} 
  & &
  \quad (x=\tp{(x_1,\dots,x_n)}\in\R^n).
\end{alignat*}
このとき次が成立していることに注意せよ:
\begin{equation*}
 |x+y|^2 - |x-y|^2 = 4(x,y).
\end{equation*}

\begin{question}[直交群, 特殊直交群]
 集合 $O(n)$ を次のように定める:
 \begin{equation*}
  O(n) := \{\, A\in M_n(\R) \mid \tp{A}A=E \,\}.
 \end{equation*}
 ここで $\tp{A}$ は $A$ の転置であり, $E$ は単位行列である.
 $O(n)$ の元を{\bf 直交行列 (orthogonal matrix)} と呼ぶ.
 以下を示せ:
 \begin{enumerate}
  \item $O(n)$ は行列の積に関して自然に群をなす.
   $O(n)$ を $n$ 次の{\bf 直交群 (orthogonal group)} と呼ぶ.
   (4点)
  \item $O(n)=\{\, A\in M_n(\R) \mid (Ax,Ay)=(x,y) \ (x,y\in\R^n) \,\}$.
   (2点)
  \item $O(n)=\{\, A\in M_n(\R) \mid |Ax|=|x| \ (x\in\R^n) \,\}$.
   (2点)
  \item 行列式を取る写像を $\det$ と書くと, $\det:O(n)\to\R^\times$ は群の準
   同型であり, その像は $\{\,\det A\mid A\in O(n)\,\} = \{\pm1\}$ となる.
   $\det:O(n)\to\R^\times$ の核を $SO(n)$ と書き, $n$ 次の
   {\bf 特殊直交群 (special orthogonal group)} と呼ぶ.
   (2点)
   \qed
 \end{enumerate}
\end{question}

より具体的には $n$ 次特殊直交群 $SO(n)$ は次のように表わされる:
\begin{equation*}
 SO(n) = \{\, A\in M_n(\R) \mid \det A = 1,\ \tp{A}A = E \,\}.
\end{equation*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  \( \displaystyle
    SO(2)
    =
    \left\{\,
    \left.
      \begin{bmatrix}
        \cos t &          - \sin t \\
        \sin t & \phantom{-}\cos t
      \end{bmatrix}
    \,\right|\,
      t \in \R
    \,\right\}
  \) %
  が成立することを示せ. 
  \qed
\end{question}

\begin{rem}
 特に, $SO(2)$ は円 $S^1$ に同相であり, 
 コンパクトかつ弧状連結である. 
 このことより, $O(2)$ は2つの $S^1$ の非連結和に同相であることもわかる. 
 \qed
\end{rem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[Euler角, 小問各5点]
  $\theta \in \R$ に対して, 行列 $A(\theta)$, $B(\theta)$ を次のように
  定義する:
  \[
    A(\theta)
    =
    \begin{bmatrix}
      \cos \theta & - \sin \theta & 0 \\
      \sin \theta &   \cos \theta & 0 \\
           0      &   0           & 1 \\
    \end{bmatrix},
    \qquad
    B(\theta)
    =
    \begin{bmatrix}
        \cos \theta & 0 & \sin \theta \\
             0      & 1 &      0      \\
      - \sin \theta & 0 & \cos \theta \\
    \end{bmatrix}.
  \]
  このとき, 以下が成立することを示せ:
  \begin{enumerate}
  \item $A(\theta), B(\theta) \in SO(3)$.
  \item 任意の $X \in SO(3)$ に対して, %
    ある $\phi, \theta, \psi \in \R$ が存在して, %
    $0 \leqq \phi < 2\pi$, $0 \leqq \theta \leqq \pi$, $0 \leqq \psi < 2\pi$, 
    および $X = A(\phi)B(\theta)A(\psi)$ が成立する. %
    (このとき, $(\phi, \theta, \psi)$ は $X$ の {\bf Euler 角}であると言う.)
  \item $(\phi,\theta,\psi)$, $(\phi',\theta',\psi')$ は $X$ の Euler 
    角であるとする. $\theta \ne 0, \pi$ ならば, %
    $(\phi,\theta,\psi) = (\phi',\theta',\psi')$ となり, Euler 角の一
    意性が成立する. %
    しかし, $\theta = 0, \pi$ のとき, Euler 角の一意性は成立しない.
    \qed
  \end{enumerate}
\end{question}

\begin{proof}[ヒント]
$A(\theta)$, $B(\theta)$ は
それぞれ $z$ 軸および $y$ 軸のまわりの回転を表わす行列である. 
そのことに注意しながら図を描きながら考えよ.
(自力で解けない場合は例えば \cite{YS} の p.45 を見よ.)
\qed
\end{proof}

\begin{rem}
$SO(3)$ は実3次元射影空間 $\P^3(\R)$ に同相である. こ
の手のことについては, \cite{Yokota} p.131 に詳しい解説がある. 
特に $SO(3)$ はコンパクトかつ弧状連結である.
\qed
\end{rem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[30点]
  $SO(n)$ が弧状連結であることを証明せよ. \qed
\end{question}

\begin{proof}[ヒント]
\cite{satake} の p.178 では直交行列の標準形に関する
結果を用いて証明している. 他にも Euler 角の考え方を使って $n$ に関する
帰納法によって証明することもできる. その方針は以下の通り. %
$e_n = (0,0,\dots,0,1)^t$ (第 $n$ 成分のみが $1$ で他は $0$)
と置く. 与えられた $X\in SO(n)$ に対して,
回転行列の合成 $A$ によってベクトル $X e_n$ を $e_n$ に移
すことができる. このとき, $AX \in SO(n)$ かつ行列 $AX$ は %
%\(\displaystyle \begin{bmatrix}X'&0\\0&1\end{bmatrix} \) %
\( \begin{bmatrix}X'&0\\0&1\end{bmatrix} \) %
($X' \in SO(n-1)$) の形になる. これより $SO(n)$ の弧状連結性は %
$SO(n-1)$ の弧状連結性に帰着できることがわかる.
\qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{ユニタリ群, 特殊ユニタリ群}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

複素縦ベクトルの空間 $\C^n$ に通常の内積とノルムを次のように入れておく:
\begin{alignat*}{2}
 &
 (x,y) := x^*y = \sum_{i=1}^n \bar{x_i} y_i 
 & &
 \quad (x=(x_1,\dots,x_n)^t, y=(y_1,\dots,y_n)^t\in\C^n),
 \\ &
 |x| := \sqrt{(x,x)} 
 & &
 \quad (x=(x_1,\dots,x_n)^t\in\C^n).
\end{alignat*}
ノルム $|\,\cdot\,|$ は内積 $(\;,\;)$ を用いて定義された.
次の問題の結果より, 逆にノルムを用いて内積を表示できることがわかる.

\begin{question}[5点]
 $\C^n$ の通常の内積とノルムのあいだには次の関係式が成立している:
 \begin{equation*}
  |x+y|^2 - |x-y|^2 - i |x+iy|^2 + i |x-iy|^2 = 4(x,y).
 \end{equation*}
 ここで $i$ は虚数単位である.
 \qed
\end{question}

\begin{proof}[ヒント]
 $c\in\C$, $x,y,z\in\C^n$ に対して %
 $(x,y+z)=(x,y)+(x,z)$, 
 $(x+y,z)=(x,z)+(y,z)$, 
 $(x,cy)=c(x,y)$, 
 $(cx,y)=\cc{c}(x,y)$ が成立することを用いよ.
 $(y,x)=\cc{(x,y)}$ を使う必要はない.
 \qed
\end{proof}

\begin{question}[ユニタリ群, 特殊ユニタリ群]
 集合 $U(n)$ を次のように定める:
 \begin{equation*}
  U(n) := \{\, A\in M_n(\C) \mid A^*A=E \,\}.
 \end{equation*}
 ここで $A^*$ は $A$ の随伴行列(転置の複素共役)であり, $E$ は単位行列である.
 $U(n)$ の元を{\bf ユニタリ行列 (unitary matrix)} と呼ぶ.
 以下を示せ:
 \begin{enumerate}
  \item $U(n)$ は行列の積に関して自然に群をなす.
   $U(n)$ を $n$ 次の{\bf ユニタリ群 (unitary group)} と呼ぶ.
   (4点)
  \item $U(n)=\{\, A\in M_n(\C) \mid (Ax,Ay)=(x,y) \ (x,y\in\C^n) \,\}$.
   (2点)
  \item $U(n)=\{\, A\in M_n(\C) \mid |Ax|=|x| \ (x\in\C^n) \,\}$.
   (2点)
  \item 行列式を取る写像を $\det$ と書くと, $\det:U(n)\to\C^\times$ は群の準
   同型であり, 任意の $A\in U(n)$ に
   対して $|\det A| = 1$ (絶対値が $1$) となる.
   $\det:U(n)\to\C^\times$ の核を $SU(n)$ と書き, $n$ 次の
   {\bf 特殊ユニタリ群 (special unitary group)} と呼ぶ.
   (2点)
   \qed
 \end{enumerate}
\end{question}

より具体的には $n$ 次特殊ユニタリ群 $SU(n)$ は次のように表わされる:
\begin{equation*}
 SU(n) = \{\, A\in M_n(\C) \mid \det A = 1,\ A^*A = E \,\}.
\end{equation*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
 \(
    SU(2) = 
    \left\{\,
      \left.
      \begin{bmatrix}
        \phantom{-} z &    w    \\
           -  \bar{w} & \bar{z} \\
      \end{bmatrix}
      \,\right|\,
        z,w\in\C,\ |z|^2+|w|^2 = 1
    \,\right\}
 \)
 が成立することを示せ. \qed
\end{question}

\begin{rem}
 この問題の結果より %
 $SU(2)$ は3次元球面 $S^3$ と同相であることがわかる.
 (一般に $n-1$ 次元球面は $S^{n-1} = \{ x \in \R^n \mid |x| = 1 \,\}$ と
 定義される. $S^2$ は2点であり, $S^1$ は円であり, $S^2$ は(普通の2次元)
 球面である.)
 \qed
\end{rem}

\begin{question}[30点]
  $U(n)$ と $SU(n)$ は連結かつコンパクトである. \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{環と体の定義}

\begin{definition}[環, 可換環]
 集合 $A$ とその元 $0,1\in A$ と
 演算 $-:A\to A$, $+,\,\cdot:A\times A\to A$ の組 $(A,\,\cdot\,,1,+,0,-)$ が
 {\bf 環 (ring)} であるとは以下が成立していることである:
 \begin{enumerate}
  \item $(A,\,\cdot\,,1)$ はモノイド (単位元付き半群) である.
  すなわち任意の $a,b,c\in A$ について
  \begin{enumerate}
   \item $(ab)c=a(bc)$,
   \item $1a=a1=a$.
  \end{enumerate}
  \item $(A,+,0,-)$ は可換群である. 
  すなわち任意の $a,b,c\in A$ について
  \begin{enumerate}
   \item $(a+b)+c = a+(b+c)$,
   \item $a+0 = 0+a = a$,
   \item $a + (-a) = (-a) + a = 0$,
   \item $a+b = b+a$.
  \end{enumerate}
  \item 加法と乗法のあいだに分配法則が成立している. 
  すなわち $a,b,c\in A$ について
  \begin{enumerate}
   \item $a(b+c)=ab+ac$,
   \item $(a+b)c=ac+bc$.
  \end{enumerate}
 \end{enumerate}
 環 $A$ がさらに次を満たしているとき %
 $A$ は{\bf 可換環 (commutative ring)} であるという:
 \begin{itemize}
  \item[4.] 乗法は可換である. すなわち $a,b\in A$ に対して $ab=ba$. 
 \end{itemize}
 環 $A$ の加法部分群 $B$ が $A$ の積 $\cdot$ について閉じており, %
 $A$ の単位元 $1$ を含むとき, $B$ は自然に環をなす.
 このとき $B$ は $A$ の{\bf 部分環 (subring)} であると言う.
 \qed
\end{definition}

\begin{example}
 $\Z$, $\Q$, $\R$, $\C$, $\C[x]$ は可換環であり, 
 左の環はそれより右の環の部分環である.
 (たとえば $\Z$ は $\C[x]$ の部分環である.)
 \qed
\end{example}

\begin{definition}[自明な環]
 零元 $0$ だけで構成された集合は $1=0$ とみなすことによって自然に環をなす. 
 その環を $0$ と書き, 
 {\bf 自明な環 (trivial ring)}もしくは{\bf 零環 (zero ring)} と呼ぶ. 
 記号 $0$ が自明な環と零元の二通りの意味で使われることに注意せよ. 
 \qed
\end{definition}

環 $A$ で $1=0$ が成立しているならば
任意の $a\in A$ に対して $a=1a=0a=0$ より $A$ は自明な環である.
したがって環 $A$ が自明であるための必要十分条件は $1=0$ が成立することである.
通常は非自明な環のみを考える.

\begin{definition}[斜体, 体]
 可換とは限らない自明でない環 $A$ がさらに次を満たしているとき %
 $A$ は{\bf 斜体 (skew field)} であるという:
 \begin{itemize}
  \item 任意の $0$ でない $A$ の元 $a$ が %
   $A$ の中に乗法に関する逆元 $a^{-1}$ を持つ.
 \end{itemize}
 可換な斜体を単に{\bf 体 (field)}と呼んだり, 
 可換性を強調するために{\bf 可換体 (commutative field)} と呼んだりする.
 \qed
\end{definition}

\begin{example}
 $\Q$, $\R$, $\C$ は(可換)体であるが, 
 (有理)整数環 $\Z$ や(1変数)複素多項式環 $\C[x]$ は体ではない.
 \qed
\end{example}

\begin{definition}[単数, 単元]
 環 $A$ の元 $a$ が $A$ の{\bf 単数 (単元, unit)} であるとは %
 $A$ の中に乗法に関する逆元 $a^{-1}$ を持つことである.
 環 $A$ の単数全体の集合を $U(A)$ もしくは $A^\times$ と書く.
 $U(A)=A^\times$ は乗法に関して群をなすので, 
 それを $A$ の{\bf 単数群 (単元群, unit group)} と呼ぶ.
 \qed
\end{definition}

環 $A$ が斜体であるための必要十分条件は $U(A)=A\setminus\{0\}$ が成立す
ることである.

\begin{definition}[零因子, 整域]
 環 $A$ の元 $a$ が{\bf 左零因子 (left zero-divisor)} であるとは
 ある $b\in A$ で $b\ne 0$ かつ $ab=0$ を満たすものが存在することである.
 {\bf 右零因子 (right zero-divisor)} も同様に定義される.
 可換環では左零因子と右零因子の区別を付ける必要はないので単に零因子と呼ぶ.
 $0$ 以外の左右零因子を持たない自明でない環
 を{\bf 整域 (domain, integral domain)} と呼ぶ.  
 すなわち2つの $0$ でない元の積が決して $0$ にならないような
 自明でない環を整域と呼ぶ.
 \qed
\end{definition}

可換環だけを主に扱う場合には可換環, 可換整域, 可換体を単に環, 整域, 体と
呼ぶことが多い. 可換環の理論は非可換な場合も含む環の一般論とは違う動機
(特に{代数幾何 (algebraic geometry)} の基礎付け)に基づいて展開されているので, 
非可換環の理論は可換環の理論の単純な一般化だとは考えない方が良い.

\begin{example}
 $\Z$ は整域でかつ $U(\Z)=\Z^{\times}=\{\pm 1\}$ である.
 \qed
\end{example}

\begin{example}
 $n$ は $2$ 以上の自然数であるとする.
 $A$ は $n$ 次の実対角行列全体集合であるとする.
 このとき $A$ は可換環であるが整域ではない.
 \qed
\end{example}

\begin{example}[行列環]
 $K$ は任意の(可換)体であるとし, $n$ は正の整数であるとする.
 $K$ の元を成分に持つ $n$ 次正方行列全体の集合 $M_n(K)$ は自然に非可換環をなす.
 $M_n(K)$ の単数群 $U(M_n(K))=M_n(K)^\times$ は %
 $K$ 上の{\bf 一般線形群 (real general linear group)} と呼ばれ, 
 $GL_n(K)$ と書かれる:
 \begin{equation*}
  U(M_n(K))=M_n(K)^\times=
  GL_n(K) = \{\,A\in M_n(K)\mid \text{$A$ は逆行列を持つ}\,\}.
 \end{equation*}
 $n$ が $2$ 上ならば $M_n(K)$ は整域ではない. 
 実際 $(i,j)$ 成分だけが $1$ で他の成分が $0$ であるような
 行列を $E_{ij}$ ({\bf 行列単位 (matrix unit)} と呼ばれる)と
 書くと $j\ne k$ のとき $E_{ij}E_{kl}=0$.
 \qed
\end{example}

\begin{definition}[環準同型]
 $A$, $B$ は環であるとする. 
 このとき写像 $f:A\to B$ が{\bf 環準同型 (ring homomorphism)} であるとは
 任意の $a,a'\in A$ に対して
 \begin{equation*}
  f(a+a')=f(a)+f(a'), \quad f(aa')=f(a)f(a'), \quad f(1)=1
 \end{equation*}
 が成立していることである. 環準同型は
 \begin{equation*}
  f(0) = 0, \quad f(-a)=-f(a).
 \end{equation*}
 も満たしている.
 環準同型は逆写像を持てばその逆写像も環準同型になる.
 2つの環のあいだに全単射環準同型が存在するとき, 
 それら2つの環は環として互いに{\bf 同型 (isomorphic)}であるという.
 \qed
\end{definition}

\begin{example}
 写像 $f:\R\to M_2(\R)$ 
 を $f(a)=\begin{bmatrix} a & 0 \\ 0 & 0 \\\end{bmatrix}$ ($a\in\R$) と定める.
 このとき $f$ は加法群の準同型でかつ $f(ab)=f(a)f(b)$ を満たしているが, 
 $f(1)$ は単位行列に等しくない. 
 上の環準同型の定義はこのような写像を排除していることに注意せよ.
 環準同型は $1$ を $1$ に移さなければいけない.
 \qed
\end{example}

\begin{definition}[代数]
 $K$ は任意の(可換)体であるとする.
 (可換とは限らない)環 $A$ が $K$ を部分環として含み, 
 任意の $k\in K$ と任意の $a\in A$ に対して $ka=ak$ が成立するとき, 
 $A$ は {\bf $K$ 代数 ($K$-algebra)} %
 もしくは {\bf $K$ 上の代数 (algebra over $K$)} と呼ばれる.
 代数は{\bf 多元環}と呼ばれることもある.
 乗法が結合律を満たし, 単位元を持つことを強調して, 
 上の意味での代数を{\bf $1$ を持つ結合的代数 (associative algebra with $1$)}
 と呼ぶこともある.
 (Lie 代数のように結合律を満たさない代数の例もある.)
 \qed
\end{definition}

\begin{example}
 多項式環 $\C[x]$ や行列環 $M_n(\C)$ は $\C$ 代数である. \qed
\end{example}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{環と体の例}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{有理整数環}

$\Z$ は可換な整域である.

$\Z$ の最も基本的な性質は商と余りを求める割算を実行できることである.
すなわち任意の $f,g\in Z$ に対して, $g\ne 0$ ならば
ある $q,r\in\Z$ で次の条件を満たすものが一意に存在する:
\begin{equation*}
 f = gq + r, \quad 0\leqq r < |f|.
\end{equation*}
このとき $q$ を %
{\bf $f$ を $g$ で割った商 (quotient of $f$ divided by $g$)} と呼び, 
$r$ を %
{\bf $f$ を $g$ で割った余り (remainder of $f$ divided by $g$)} 
と呼ぶのであった.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{definition}[最大公約数]
 $A$ は可換環であるとする.
 \begin{enumerate}
 \item $g\in A$ が $f\in A$ の{\bf 約数 (divisor)} であるとは %
  ある $q\in A$ で $f=gq$ を満たすものが存在することである.
  このとき $f$ は $g$ で割り切れるもしくは
  {\bf $g$ は $f$ を割る ($g$ divides $f$)} と言い, 
  $g\mid f$ と書く.
 \item $g\in A$ が $f_1,\ldots,f_n\in A$ の
  {\bf 公約数 (common divisor)} であるとは, %
  $f_1,\ldots,f_n$ が $g$ で割り切れることである.
 \item $g\in A$ が $f_1,\ldots,f_n\in A$ の
  {\bf 最大公約数 (greatest common divisor, g.c.d.)} であるとは, %
  $g$ が $f_1,\ldots,f_n$ の公約数でかつ, 
  $g$ が $f_1,\ldots,f_n$ の任意の公約元で割り切れることである.
 \qed
 \end{enumerate}
\end{definition}

\begin{rem}
 $A$ は可換環であるとする.
 \begin{enumerate}
 \item 任意の $f\in A$ に対して $1\mid f$ かつ $f\mid 0$ であることに注意せよ.
  すなわち $1$ はすべての元を割り, $0$ はすべての元で割り切れる.
 \item $A$ の元を数と呼びたくない場合は公約数を{\bf 公約元}と呼ぶことがある.
  $A$ の元が多項式ならば公約数を{\bf 公約多項式}と呼ぶこともある.
 \qed
 \end{enumerate}
\end{rem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[最大公約数の単数倍を除いた一意性]
 $A$ は(可換)整域ならば $f_1,\ldots,f_n\in A$ の最大公約数が存在するなら
 ば単数倍を除いて一意的である.
 \qed
\end{question}

\begin{proof}[ヒント]
 $f_1=\cdots=f_n=0$ ならば $f_1,\ldots,f_n$ の最大公約数は $0$ しかない.
 $f_1,\ldots,f_n$ の中に $0$ でないものが存在すると仮定する.
 このとき $0$ は $f_1,\ldots,f_n$ の公約数ではない.
 $g,h\in A$ は $f_1,\ldots,f_n$ の最大公約数であるとする.
 $g\ne 0$, $h\ne 0$ である.
 ある $a,b\in A$ が存在して $g=ah$, $h=bg$ となる.
 よって $g=ah=abg$ であり, $A$ が整域であることから $ab=1$ となる.
 ($g=abg$ より $(ab-1)g=0$ であるから, %
 $g\ne 0$ と $A$ が整域であることより $ab-1=0$ であることがわかる.)
 したがって $a,b\in A^\times$ である.
 これで $g,h$ は互いに相手の単数倍であることがわかった.
 \qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

$\Z$ で割算が実行できることを用いて, 
$f_1,\ldots,f_n\in\Z$ の最大公約数が存在することを示せる.
そのためには $f,g\in\Z$ の最大公約数が存在することを示せば十分である.
しかも単に存在することを示せるだけではなく, 
最大公約数を計算するアルゴリズム(有限で終わる手続き)も得られる.
詳しい説明に関しては以下の問題とそのヒントを見よ.

\begin{question}[Euclid の互除法]
\label{q:Euclidean-algorithm-1-Z}
  $f,g\in\Z$, $g\ne 0$ に対して, 
  $f_k$ ($k=0,1,2,\dots$) を以下の手続きによって定めることができる:
  \begin{itemize}
  \item $f_0=f$, $f_1=g$ と定める.
  \item もしも $f_k\ne 0$ ならば $q_k, f_{k+1}\in \Z$ を次の条件に
    よって定める:
    \begin{equation*}
      f_{k-1} = q_k f_k + f_{k+1}, \qquad 0\leqq f_{k+1} < |f_k|.
    \end{equation*}
  \item もしも $f_{k+1}=0$ すなわち $f_{k-1}=q_kf_k$ ならば手続きを終了する.
  \end{itemize}
  $|f_k|$ は単調に減少するのでこの手続きは必ず有限ステップで終了する.
  $f_{k-1}=q_kf_k$ のとき $f_k$ は $f$, $g$ の最大公約数になっている.
  この主張を証明し, 計算の例をひとつ挙げよ.
  \qed
\end{question}

\begin{proof}[ヒント]
上の手続きの結果以下のような計算の列が得られる:
\begin{alignat*}{2}
  & f_0 = f, & & \\
  & f_1 = g \ne 0, & & \\
  & f_0 = q_1f_1 + f_2, & \qquad & 0\leqq f_2 < |f_1|, \\
  & f_1 = q_2f_2 + f_3, & \qquad & 0\leqq f_3 < |f_2|, \\
  & \qquad \cdots\cdots & \qquad & \qquad\cdots\cdots \\
  & f_{k-2} = q_{k-1}f_{k-1} + f_k, & \qquad & 0\leqq f_k < |f_{k-1}|, \\
  & f_{k-1} = q_kf_k. & & 
\end{alignat*}
これを下から逆順に眺め直すと $f_k$ は $f_{k-1},f_{k-2},\dots,f_1,f_0$ 
の公約数になっていることがわかる.  
もしも $h\in \Z$ が $f_0$, $f_1$ の公約数ならば
各ステップの等式を $f_j = f_{j-2} - q_{k-1}f_{k-1}$ と書き直して
上から順に見て行けば $h$ は $f_0,f_1,\dots,f_{k-1},f_k$ すべての約数
になっていることもわかる.
たとえば $90$ と $35$ の最大公約数をこの方法で計算してみよ.
\qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[5点]
\label{q:Euclidean-algorithm-2-Z}
 任意の $f,g\in\Z$ に対して
 ある $a,b\in\Z$ で $af + bg$ が $f,g$ の最大公約数になるものが存在する.
 \qed
\end{question}

\begin{proof}[ヒント]
 $f=g=0$ ならば $0$ が最大公約数であるから自明である.
 $f,g$ の片方が $0$ でない場合について考える.
 $g\ne 0$ の場合だけを考えれば十分である.
 Euclid の互除法を使う.  Euclid の互除法のステップを上から順番に
 見て行き, $d=f_k=af_0+bf_1=af+bg$ という式が得られることを示す.
 \qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[5点]
\label{q:Euclidean-algorithm-3-Z}
 任意の $f_1,\ldots,f_n\in\Z$ に対してある $a_1,\ldots,a_n\in\Z$ で %
 $a_1f_1 + \cdots + a_nf_n$ が $f_1,\ldots,f_n$ の最大公約数になるものが存在する.
 \qed
\end{question}

\begin{proof}[ヒント]
$n$ に関する帰納法.  $n=1$ の場合は明らか. 
$f_1,\dots,f_{n-1}$ の最大公約数 $g$ と $f_n$ の最大公約数 $h$ 
は $f_1,\dots,f_{n-1},f_n$ の最大公約数である. 
実際, $h$ は $f_1,\dots,f_{n-1},f_n$ の公約数であり, 
$f_1,\dots,f_{n-1},f_n$ の任意の公約数で $h$ は割り切れる.  帰納法の仮定
より $g$ は $g=b_1f_1+\cdots+b_{n-1}f_{n-1}$ ($b_i\in\Z$) と表わさ
れる. 上の問題より $h$ は $h=c_1g+c_2f_n$ 
($c_i\in\Z$) と表わされる.  よって, $a_i=c_1b_i$ ($i=1,\dots,n-1$), 
$a_n=c_2$ と置けば $h = a_1f_1+\cdots+a_nf_n$ が成立する.
\qed
\end{proof}

\bigskip
{\Large\bf 以上の2つの問題の結果は非常によく使われる.}
\bigskip

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

最も簡単な応用は以下の通り.

$n\in\Z$, $n\ne 0$ であるとする.
$a,b\in\Z$ を $n$ で割った余りが等しいとき $a\equiv b\pmod{n}$ と書き, 
{\bf $a$ と $b$ は $n$ を法として合同である 
($a$ is congruent to $b$ modulo $n$)} と言う.
$a\equiv b\pmod{n}$ と $a-b$ が $n$ で割り切れることは同値である.

\begin{question}[5点]
 $n\in\Z$, $n\ne 0$ であるとする.
 $a\in \Z$ と $n$ の最大公約数が $1$ ならば
 ある $b\in\Z$ が存在して $ab\equiv 1\pmod{n}$ となる.
 すなわち $a$ と $n$ の最大公約数が $1$ ならば %
 $a$ は $n$ を法として可逆である.
 \qed
\end{question}

\begin{proof}[ヒント]
 ある $b,c\in\Z$ が存在して $ba+cn=1$ となる.
 このとき $ab = 1 - cn$. \qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{体上の一変数多項式環}

$K$ は任意の体であるとする(たとえば $K=\Q,\R,\C$).

$K$ 上の一変数多項式環 $K[x]$ は可換な整域である.

\begin{rem}
 文字 (不定元) $x$ の
 多項式 $f(x) = a_n x^n + a_{n-1} x^{n-1} + \cdots + a_1 x + a_0$ の
 中の $x$ は数もしくは $K$ の元ではない.
 {\bf 文字と数を混同しないように注意しなければいけない.}
 \qed
\end{rem}

多項式 $f\in K[x]$ が $a_0,a_1,\ldots,a_n\in K$ によって
\begin{equation*}
 f(x) = a_n x^n + a_{n-1} x^{n-1} + \cdots + a_1 x + a_0, \qquad a_n\ne 0
\end{equation*}
と表わされているとき, $f$ の{\bf 次数 (degree)} は $n$ であると言い, 
$\deg f = n$ と置く. $f=0$ のとき $\deg f = -\infty$ と約束しておく.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[次数の基本性質]
 $f,g\in K[x]$ に対して
 \begin{equation*}
  \deg(f+g)\leqq \max\{\deg f,\deg g\}, \qquad
  \deg(fg) = \deg f + \deg g.
  \qed
 \end{equation*}
\end{question}

\begin{proof}[ヒント]
 $f,g$ の最高次の係数が $f+g$, $fg$ のどこの現われるかを調べよ. 
 \qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[多項式環の単元, 5点]
 $K[x]$ の単元全体は $0$ でない $K$ の元全体に等しい.
 すなわち $U(K[x])=K[x]^\times=K^\times$ である.
 \qed
\end{question}

\begin{proof}[ヒント]
 上の問題の結果を使う.
 $f,g\in K[x]$, $1=fg$ とすると $0=\deg(fg)=\deg f+\deg g$ である.
 よって $\deg f=0$, $deg g=0$ でなければいけない.
 すなわち $f,g\in K^\times$ である.
 \qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

体上の一変数多項式環 $K[x]$ の最も基本的な性質は
商と余りを求める割算を実行できることである.
すなわち任意の $f,g\in K[x]$ に対して, $g\ne 0$ ならば
ある $q,r\in K[x]$ で次の条件を満たすものが一意に存在する:
\begin{equation*}
 f = gq + r, \quad \deg r < \deg g.
\end{equation*}
このとき $q$ を %
{\bf $f$ を $g$ で割った商 (quotient of $f$ divided by $g$)} と呼び, 
$r$ を %
{\bf $f$ を $g$ で割った余り (remainder of $f$ divided by $g$)} 
と呼ぶ.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

$K[x]$ で割算が実行できることを用いて, 
$f_1,\ldots,f_n\in K[x]$ の最大公約多項式が存在することを示せる.
そのためには $f,g\in K[x]$ の最大公約多項式が存在することを示せば十分である.
しかも単に存在することを示せるだけではなく, 
最大公約多項式を計算するアルゴリズム(有限で終わる手続き)も得られる.
詳しい説明に関しては以下の問題とそのヒントを見よ.

\begin{question}[Euclid の互除法]
\label{q:Euclidean-algorithm-1-K[x]}
  $f,g\in K[x]$, $g\ne 0$ に対して, 
  $f_k$ ($k=0,1,2,\dots$) を以下の手続きによって定めることができる:
  \begin{itemize}
  \item $f_0=f$, $f_1=g$ と定める.
  \item もしも $f_k\ne 0$ ならば $q_k, f_{k+1}\in K[x]$ を次の条件に
    よって定める:
    \begin{equation*}
      f_{k-1} = q_k f_k + f_{k+1}, \qquad \deg f_{k+1} < \deg f_k.
    \end{equation*}
  \item もしも $f_{k+1}=0$ すなわち $f_{k-1}=q_kf_k$ ならば手続きを終了する.
  \end{itemize}
  $\deg f_k$ は単調に減少するのでこの手続きは必ず有限ステップで終了する.
  $f_{k-1}=q_kf_k$ のとき $f_k$ は $f$, $g$ の最大公約多項式になっている.
  この主張を証明せよ.
  \qed
\end{question}

\begin{proof}[ヒント]
上の手続きの結果以下のような計算の列が得られる:
\begin{alignat*}{2}
  & f_0 = f, & & \\
  & f_1 = g \ne 0, & & \\
  & f_0 = q_1f_1 + f_2, & \qquad & \deg f_2 < \deg f_1, \\
  & f_1 = q_2f_2 + f_3, & \qquad & \deg f_3 < \deg f_2, \\
  & \qquad \cdots\cdots & \qquad & \qquad\cdots\cdots \\
  & f_{k-2} = q_{k-1}f_{k-1} + f_k, & \qquad & \deg f_k < \deg f_{k-1}, \\
  & f_{k-1} = q_kf_k. & & 
\end{alignat*}
これを下から逆順に眺め直すと $f_k$ は $f_{k-1},f_{k-2},\dots,f_1,f_0$ 
の公約多項式になっていることがわかる.  
もしも $h\in K[x]$ が $f_0$, $f_1$ の公約多項式ならば
各ステップの等式を $f_j = f_{j-2} - q_{k-1}f_{k-1}$ と書き直して
上から順に見て行けば $h$ は $f_0,f_1,\dots,f_{k-1},f_k$ すべての約多項式
になっていることもわかる.
\qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[5点]
\label{q:Euclidean-algorithm-2-K[x]}
 任意の $f,g\in K[x]$ に対して
 ある $a,b\in K[x]$ で $af + bg$ が $f,g$ の最大公約多項式になるものが存在する.
 \qed
\end{question}

\begin{proof}[ヒント]
 $f=g=0$ ならば $0$ が最大公約多項式であるから自明である.
 $f,g$ の片方が $0$ でない場合について考える.
 $g\ne 0$ の場合だけを考えれば十分である.
 Euclid の互除法を使う.  Euclid の互除法のステップを上から順番に
 見て行き, $d=f_k=af_0+bf_1=af+bg$ という式が得られることを示す.
 \qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[5点]
\label{q:Euclidean-algorithm-3-K[x]}
 任意の $f_1,\ldots,f_n\in K[x]$ に対してある $a_1,\ldots,a_n\in K[x]$ で %
 $a_1f_1 + \cdots + a_nf_n$ が $f_1,\ldots,f_n$ の最大公約多項式になるものが存在する.
 \qed
\end{question}

\begin{proof}[ヒント]
$n$ に関する帰納法.  $n=1$ の場合は明らか. 
$f_1,\dots,f_{n-1}$ の最大公約多項式 $g$ と $f_n$ の最大公約多項式 $h$ 
は $f_1,\dots,f_{n-1},f_n$ の最大公約多項式である. 
実際, $h$ は $f_1,\dots,f_{n-1},f_n$ の公約多項式であり, 
$f_1,\dots,f_{n-1},f_n$ の任意の公約多項式で $h$ は割り切れる.  帰納法の仮定
より $g$ は $g=b_1f_1+\cdots+b_{n-1}f_{n-1}$ ($b_i\in K[x]$) と表わさ
れる. 上の問題より $h$ は $h=c_1g+c_2f_n$ 
($c_i\in K[x]$) と表わされる.  よって, $a_i=c_1b_i$ ($i=1,\dots,n-1$), 
$a_n=c_2$ と置けば $h = a_1f_1+\cdots+a_nf_n$ が成立する.
\qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\bigskip
{\Large\bf 以上の2つの問題の結果は非常によく使われる.}
\bigskip

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

最も簡単な応用は以下の通り.

$f\in K[x]$, $f\ne 0$ であるとする.
$a,b\in K[x]$ を $f$ で割った余りが等しいとき $a\equiv b\pmod{f}$ と書き, 
{\bf $a$ と $b$ は $f$ を法として合同である 
($a$ is congruent to $b$ modulo $f$)} と言う.
$a\equiv b\pmod{n}$ と $a-b$ が $f$ で割り切れることは同値である.

\begin{question}[5点]
 $f\in K[x]$, $f\ne 0$ であるとする.
 $a\in K[x]$ と $f$ の最大公約多項式が $1$ ならば
 ある $b\in K[x]$ が存在して $ab\equiv 1\pmod{f}$ となる.
 すなわち $a$ と $f$ の最大公約多項式が $1$ ならば %
 $a$ は $f$ を法として可逆である.
 \qed
\end{question}

\begin{proof}[ヒント]
 ある $b,c\in K[x]$ が存在して $ba+cf=1$ となる.
 このとき $ab = 1 - cf$. \qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\bigskip
{\Large\bf 以上のように $\Z$ に関する議論と $K[x]$ に関する議論を平行して
進めることができる.}

\begin{guide}
 代数の講義の方で「有限生成 Abel 群の基本定理」について習うことになっている. 
 この演習と対応する講義では「行列の Jordan 標準形の理論」について習うことになる.
 実は「有限生成 Abel 群の基本定理」は「有限生成 $\Z$ 加群の理論」で
 あり, 「Jordan 標準形の理論」は「有限生成 $K[x]$ 加群の理論」から
 容易に導くことができる.
 以上で説明した Euclid の互除法とその簡単な応用は
 「有限生成 $\Z$ 加群の理論」や「有限生成 $K[x]$ 加群の理論」を
 構築するための基本的な道具になる.
 {\bf このように抽象代数学(より一般に数学全般)を習うと, 
 一見して異なる世界を同じアイデアで扱うことが可能になる.}
 \qed
\end{guide}

多項式に関する Euclid の互助法の計算問題を幾つか出しておく.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[3点]
\label{q:Euclidean-algorithm-example}
  $K=\R$ の
  とき $f(x)=x^4+x^3+2x^2+x+1$,
  $g(x)=x^3-1$ の最大公約元を 
  Euclid の互除法と素因子分解の両方の方法で求めて
  それらが定数倍を除いて一致していることを確かめよ.
  \qed
\end{question}

\commentout{
\begin{proof}[略解]
略解: $f(x)=(x^2+1)(x^2+x+1)$, 
$g(x)=(x-1)(x^2+x+1)$ であるから,
$f$, $g$ の最大元は $h(x)=x^2+x+1$ である.
一方, $f_0=f$, $f_1=g$, $f_2(x)=2x^2+2x+2$ であり, 
$f_1(x)=(\frac{1}{2}x-\frac{1}{2})f_2(x)$ である
から, $f_2$ は $f_0$, $f_1$ の最大公約元である.
$f_2=2h$ である.
\qed
\end{proof}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[3点]
\label{q:E-a-1}
  $f,g\in\Q[x]$ を $f(x)=x^4 - 2x^2 + 1$, $g(x)=x^3 - 1$ と定める.
  素因子分解と Euclid の互除法の2つの方法
  で $f$ と $g$ の最大公約多項式を求め, $0$ でない有理数倍を除いて一致して
  いることを確かめよ.
  \qed
\end{question}

\commentout{
\begin{proof}[略解]
$f(x)=(x-1)^2(x+1)^2$, $g(x)=(x-1)(x^2+x+1)$ である
から, $f$ と $g$ の最大公約多項式は $x-1$ である.  
Euclid の互除法で計算すると $f_2(x)=-2x^2+x+1$,
$f_3(x)=\frac{3}{4}x-\frac{3}{4}$, $f_4(x)=0$ となり, 
最大公約多項式は $f_3(x)=\frac{3}{4}(x-1)$ であることがわかる.
\qed
\end{proof}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:E-a-2}
  $f,g\in\Q[x]$ を $f(x) = (x+2)^2(x^2+x-1)(x^2+1)$,
  $g(x) = (x-2)(x^2-2)(x^2+1)$ と定める.
  このとき $f$ と $g$ の最大公約多項式が $x^2+1$ である.
  Euclid の互除法で $f$ と $g$ の
  最大公約多項式を計算すると, 出て来る数字がどんどん大きくなってしまい, 
  手計算がかなり大変になることを確かめよ.
  コンピューターを用いて計算しても構わない. 
  その場合はコンピューターをどのように使ったかについても説明すること.
  \qed
\end{question}

\begin{proof}[ヒント]
 計算結果は次のようになる. 虫食いを埋めよ:
\begin{align*}
  &
  f_0(x) = f(x) = x^6+5x^5+\text{\fbox{\tiny ア}}x^4+5x^3+3x^2-4,
  \\ &
  f_1(x) = g(x) = x^5-\text{\fbox{\tiny イ}}x^4-x^3+2x^2-2x+4,
  \\ &
  f_2(x) = 23x^4+10x^3-\text{\fbox{\tiny ウ}}x^2+10x-32,
  \qquad
  q_1(x) = x+7,
  \\ &
  f_3(x)
  =\frac{\text{\fbox{\tiny \ オ\ }}}{\text{\fbox{\tiny \ エ\ }}}x^3
  +\frac{\text{\fbox{\tiny \ カ\ }}}{\text{\fbox{\tiny \ エ\ }}}x^2
  +\frac{\text{\fbox{\tiny \ オ\ }}}{\text{\fbox{\tiny \ エ\ }}}x  
  +\frac{\text{\fbox{\tiny \ カ\ }}}{\text{\fbox{\tiny \ エ\ }}},
  \qquad
  q_2(x) = \frac{1}{23}x - \frac{56}{\text{\fbox{\tiny \ エ\ }}},
  \\ &
  f_4(x) = - \frac{42320}{\text{\fbox{\tiny 　キ　}}}x^2 
           - \frac{42320}{\text{\fbox{\tiny 　キ　}}},
  \qquad
  q_3(x) = \frac{12167}{238}x - \frac{670772}{\text{\fbox{\tiny 　　キ　 　}}},
  \\ &
  f_5(x) = 0,
  \qquad
  q_4(x) = - \frac{1685159}{11193640}x 
           - \frac{1147041}{\text{\fbox{\tiny 　　ク　　}}}.
\qed
\end{align*}
\end{proof}

\commentout{
\begin{proof}[略解]
$f_0=f$, $f_1=g$ と置き, $f_{k-1}$ を $f_k$ で割った余りを $f_{k+1}$ 
とし, 商を $q_k$ とする計算の結果は次のようになる:
\begin{align*}
  &
  f_0(x) = f(x) = x^6+5x^5+8x^4+5x^3+3x^2-4,
  \\ &
  f_1(x) = g(x) = x^5-2x^4-x^3+2x^2-2x+4,
  \\ &
  f_2(x) = 23x^4+10x^3-9x^2+10x-32,
  \qquad
  q_1(x) = x+7,
  \\ &
  f_3(x)
  =\frac{238}{529}x^3+\frac{324}{529}x^2
  +\frac{238}{529}x  +\frac{324}{529},
  \qquad
  q_2(x) = \frac{1}{23}x - \frac{56}{529},
  \\ &
  f_4(x) = - \frac{42320}{14161}x^2 - \frac{42320}{14161},
  \qquad
  q_3(x) = \frac{12167}{238}x - \frac{670772}{14161},
  \\ &
  f_5(x) = 0,
  \qquad
  q_4(x) = - \frac{1685159}{11193640}x - \frac{1147041}{5596820}.
\end{align*}
$f_4$ が $f$, $g$ の最大公約多項式である. \qed
\end{proof}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{有限体}

\begin{question}[二元体, 5点]
  集合 $\bF_2=\{0,1\}$ に次のように加法と乗法を定める
  と $\bF_2$ は体になる:
  \begin{align*}
    &
    0+0=0, \quad 0+1=1, \quad 1+0=1, \quad 1+1=0; 
    \\ &
    0\cdot0=0, \quad 0\cdot1=0, \quad 1\cdot0=0, \quad 1\cdot1=1.
    \qed
  \end{align*}
\end{question}

\begin{question}[$p$ 元体, 10点]
 $p$ は任意の素数であるとする.
 集合 $\bF_p=\{0,1,\ldots,p-1\}$ に次のように加法と乗法を定める
 と $\bF_p$ は体になる:
 \begin{align*}
  &
  a + b = \text{(整数としての和 $a+b$ を $p$ で割った余り)}, 
  \\ &
  a\cdot b = \text{(整数としての積 $ab$ を $p$ で割った余り)}.
  \qed
 \end{align*}
\end{question}

\begin{guide}[有限体]
  一般に素数 $p$ が与えられたとき, 集合 $\bF_p=\{0,1,\ldots,p-1\}$ に
  通常の整数の和と積の $p$ で割った余りを考えることに
  よって $\bF_p$ の加法と乗法を定めると $\bF_p$ は体をなす.
  有限個の元しか持たない体を{\bf 有限体 (finite field)} と呼ぶ.
  有限体の元の個数 (有限体の位数と呼ばれる) は
  素数の巾 $q=p^e$ ($p$ は素数, $e$ は正の整数) になる.
  位数 $q$ の有限体は $\cF_q$ と表わされる.
  \qed
\end{guide}

\begin{guide}[ガロア]
  なお, 有限体は{\bf Galois 体 (Galois filed)} と呼ばれ $GF(q)$ と
  表わされることもある. \'Evariste Galois (エヴァリスト・ガロア,
  1811.10.25--1832.5.31) は19世紀の初頭に登場した天才数学者の一人である.
  決闘で悲劇的な結末をむかえたことで有名である%
  \footnote{おすすめの伝記はインフェルト \cite{Infeld} である.}.
  群 (group) を導入して対称性 (symmetry) の概念を数学的に明確にし, 
  方程式をその対称性を調べることに統制する
  という考え方を導入したのは Galois である.
  19世紀は天才数学者が次々に登場した世紀であり, その歴史は非常に面白い.
  \qed
\end{guide}

\begin{guide}[有限体上の幾何]
  慣れ親しんで来た実数体や複素数体の世界と有限体の世界はまるで違っているよう
  に見えるかもしれない.  しかし, 実際にはそうではないことが知られている.
  実数体をもとにして定義された図形には連続性の直観が適用でき, 
  トポロジーの理論が展開される. 
  有限体上の代数多様体 (これもある種の図形) に対しても
  トポロジーの理論を展開することができることがすでに知られている%
  \footnote{Grothendieck の etale topology の理論.}.
  このような驚くべき数学の発展が20世紀のあいだになされた%
  \footnote{有限体上の幾何は純粋数学的に重要なだけではなく,
    我々の実生活に関わる応用面でも重要である.
    有限体はコンピューターと相性が良い.}.
  \qed
\end{guide}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{Hamilton の四元数}

この節の内容はおまけである.

斜体の最も有名な例は次の問題の Hamilton の四元数体だと思う.
Hamilton の四元数体は複素数体をさらに拡張したものである.
Hamilton は最初複素数に虚数単位 $i$ とは別の「数」をひとつだけ
付け加えることによって「良い環」を構成しようとしたらしい.
しかしある日 Hamilton はひとつだけではなく $j$ と $k$ のふたつを
付け加えると「非常に良い環」ができることに気付いた。
それが Hamilton の四元数体である.

\begin{question}[Hamilton の四元数体, 小問各5点]
 \label{q:quarternion-1}
 Hamiton の四元数体 $\bH$ を定義しよう.
 複素数体 $\C$ を拡張して %
 $\bH$ を $\R$ 上のベクトル空間として次のように定める:
 \begin{equation*}
  \bH = \{\, a1 + bi + cj + dk \mid a,b,c,d\in\R \,\}.
 \end{equation*}
 $1$, $i$, $j$, $k$ は $\bH$ の $\R$ 上の基底になっているとする.
 $a1$ を以下では単に $a$ と書くことにする.
 さらに複素数体の虚数単位の計算規則を拡張し, 
 次のように $i,j,k$ のあいだの積を定める:
 \begin{equation*}
  i^2=j^2=k^2=-1, \quad ij=-ji=k, \quad jk=-kj=i, \quad ki=-ik=j.
 \end{equation*}
 以下を示せ:
 \begin{enumerate}
  \item $\bH$ には自然に環構造が入る.
  \item 任意の $0$ でない $\bH$ の元は乗法に関する逆元を持つ.
 \end{enumerate}
 よって $\bH$ は斜体をなす.
 $\bH$ を {\bf Hamilton の四元数体 (Hamiltonian quaternion field)} と呼
 び, $\bH$ の元を{\bf 四元数 (quaternion)} と呼ぶ.
 さらに次を示せ:
 \begin{enumerate}
  \setcounter{enumi}{2}
  \item $p,q,r\in\R$, $p^2+q^2+r^2=1$ に対して $I=pi+qj+rk$ と
   置く. このとき $I^2=-1$ である. 
  よって $\C_I=\{\,a+bI\mid a,b\in\R\,\}\subset\bH$ は
  複素数体と同型な体をなす.
 \end{enumerate}
 このように Hamilton の四元数体の中には連続的に無限個の複素数体 $\C_I$ が
 含まれているとみなせる.
 \qed
\end{question}

\begin{proof}[ヒント]
 1. 問題は結合律の証明. 直接証明することは少し面倒だが易しい.
 このヒントでは四元数を行列で表現することによる証明法を紹介しよう.
 $\R$ 上の線形写像 $A:\bH\to M_4(\R)$ を $\alpha=a+bi+cj+dk\in\bH$ に対して
 \begin{equation*}
  A(\alpha) = 
  \left[
  \begin{array}{rrrr}
   a & -b & -c & -d \\
   b &  a & -d &  c \\
   c &  d &  a & -b \\
   d & -c &  b &  a \\
  \end{array}
  \right].
 \end{equation*}
 と定める.  たとえば $A(1)$ は単位行列になり, 
 \begin{small}
 \begin{equation*}
  A(i)=
  \left[
  \begin{array}{rrrr}
   0 & -1 &  0 &  0 \\
   1 &  0 &  0 &  0 \\
   0 &  0 &  0 & -1 \\
   0 &  0 &  1 &  0 \\
  \end{array}
  \right],
  \quad
  A(j) = 
  \left[
  \begin{array}{rrrr}
   0 &  0 & -1 &  0 \\
   0 &  0 &  0 &  1 \\
   1 &  0 &  0 &  0 \\
   0 & -1 &  0 &  0 \\
  \end{array}
  \right],
  \quad
  A(k) = 
  \left[
  \begin{array}{rrrr}
   0 &  0 &  0 & -1 \\
   0 &  0 & -1 &  0 \\
   0 &  1 &  0 &  0 \\
   1 &  0 &  0 &  0 \\
  \end{array}
  \right].
 \end{equation*}
 \end{small}%
 このとき $\alpha,\beta\in\bH$ に対して $A(\alpha\beta)=A(\alpha)A(\beta)$ が
 成立する. ($\alpha,\beta=i,j,k$ のすべての組み合わせについて確認せよ.)
 このことと行列の積が結合律を満たすことと $A:\bH\to M_4(\R)$
 が単射であることより, $\bH$ の乗法も結合律を満たしていることがわかる.

 2と3は次の公式を使えば簡単である. 
 $\alpha = a + bi + cj + dk\in\bH$ に対して
 \begin{equation*}
  \cc\alpha = a - bi - cj - dk, \quad
  |\alpha| = \sqrt{a^2+b^2+c^2+d^2}
 \end{equation*}
 と置くと $\alpha\cc\alpha=\cc\alpha\alpha=|\alpha|^2$.
 \qed
\end{proof}

\begin{example}
 $R=\{\,a+bi+cj+dk\in\bH\mid a,b,c,d\in\Z\,\}$ は
 自然に $\bH$ の部分環をなす.
 $R$ は非可換な整域である.
 \qed
\end{example}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{体上のベクトル空間の理論}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{環上の加群と体上のベクトル空間の定義}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{definition}[環上の加群と体上のベクトル空間]
  $R$ は環であるとする.
  集合 $M$ が {\bf $R$ 上の加群 (module over $R$)} 
  もしくは{\bf $R$ 加群 ($R$-module)} であるとは
  加法 $+:M\times M\to M$, 零元 $0\in M$ 
  と加法に関する逆元を取る操作 $-:M\to M$ 
  と $R$ の元の $M$ の元への作用 $\cdot:R\times M\to M$ が定義されていて, 
  以下の $R$ 加群の公理が成立していることである:
  \begin{enumerate}
  \item $M$ は加法に関して可換群をなす. 
    すなわち任意の $u,v,w\in M$ に対して,
    \begin{enumerate}
    \item $(u + v) + w = u + (v + w)$;
    \item $0 + u = u + 0 = u$;
    \item $(-u) + u = u + (-u) = 0$;
    \item $u + v = v + u$.
    \end{enumerate}
  \item スカラー倍 $\cdot:R\times M\to M$ は結合的かつ{\bf 双加法的 
      (bi-additive)} であり, $1\in R$ の作用は恒等写像になる.
    すなわち任意の $a,b\in R$, $u,v\in M$ に対して,
    \begin{enumerate}
    \item $(ab)u = a(bu)$;
    \item $a(u + v) = au + av$;
    \item $(a + b)u = au + bu$;
    \item $1u = u$.
    \end{enumerate}
  \end{enumerate}
  特に $R$ が体 $K$ に等しいならば $R$ 加群を
  {\bf $K$ 上のベクトル空間 (vector space over $K$)} もしくは
  {\bf $K$ 上の線形空間 (linear space over $K$)} もしくは
  {\bf $K$ ベクトル空間 ($K$-vector space)} もしくは
  {\bf $K$ 線形空間 ($K$-linear space)} と呼ぶ.
  \qed
\end{definition}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[5点]
  $K$ は体であるとし, 可換環 $R$ は体 $K$ 上の一変数多項式環 $K[\lambda]$ で
  あるとし, $M=K^n$ (縦ベクトルの空間) と置き, 
  正方行列 $A\in M_n(K)$ を任意に固定する.
  $f(\lambda)\in K[\lambda]$ の $\lambda$ に $A$ を代入すること
  によって行列 $f(A)\in M_n(K)$ が自然に定義される.
  そのことを利用して写像 $\cdot:R\times M\to M$ を 
  \begin{equation*}
    f(\lambda)\cdot v := f(A)v
    \qquad
    (f(\lambda)\in R=K[\lambda],\ v\in M=K^n)
  \end{equation*}
  と定める. このとき $M$ は自然に $R=K[\lambda]$ 上の加群をなす. \qed
\end{question}

\begin{proof}[ヒント]
  $M=K^n$ は $K$ 上のベクトル空間なので始めから, $+$, $0$, $-$ が定められて
  いる. スカラー倍 $R\times M\to M$ は問題のように定められている.
  よってそれらが $R$ 加群の公理を満たしているかどうかを確かめればよい.
  ($M=K^n$ はベクトル空間なので加法に関して可換群をなすことは改めてチェック
  しなくてよいだろう.)
  \qed
\end{proof}

\begin{guide}
  上の問題で定義した $K[\lambda]$ 上の加群 $M$ は
  正方行列 $A\in M_n(K)$ の Jordan 標準形の理論を扱うときに重要になる.
  正方行列 $A$ の標準形の理論と $A$ に対応する $K[\lambda]$ 加群 $M$ の
  構造に関する理論は本質的に等しくなる.
  代数学の基本は環と加群の理論である.
  \qed
\end{guide}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[連続函数全体のなすベクトル空間, 5点]
  \label{q:C0-1}
  閉区間 $[a,b]$ 上の実数値連続函数全体のなす集合を $C([a,b],\R)$ と
  書くことにする. $C([a,b],\R)$ は自然に $\R$ 上のベクトル空間をなす.
  \qed
\end{question}

\begin{proof}[ヒント]
  まず, $C([a,b],\R)$ に $+$, $0$, $-$ と
  スカラー倍 $\cdot:\R\times C([a,b],\R)\to C([a,b],\R)$ を定義せよ.
  それらが well-defined であることを証明し,
  さらにそれらがベクトル空間の公理を満たしていることを示せ.
  たとえば $[a,b]$ 上の実数値連続函数 $f$ と $g$ の和もまた
  連続函数になることなどを証明しなければいけない.
  \qed
\end{proof}

\begin{guide}
  $K^n$ のようなベクトル空間を扱うのではなく, 
  より抽象的に体上のベクトル空間を扱う利点の一つは, 
  上の問題のようにある種の函数全体の空間 (函数空間) をも
  ベクトル空間として扱えるようになることである.
  すでに十分習熟しつつあると思われる $K^n$ およびその部分空間で
  やしなった直観を函数空間にも拡大するように努力せよ.
  \qed
\end{guide}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[連続函数全体のなす可換環, 5点]
  \label{q:C0-2}
  閉区間 $[a,b]$ 上の実数値連続函数全体のなす集合を $C([a,b],\R)$ と
  書くことにする. $C([a,b],\R)$ は自然に可換環をなす.
  \qed
\end{question}

\begin{proof}[ヒント]
  $f,g\in C([a,b],\R)$ に対して $[a,b]$ 上の
  函数 $fg$ を $(fg)(x)=f(x)g(x)$ ($x\in[a,b]$) と定める
  と, $fg$ が $[a,b]$ 上の連続函数に
  なること(すなわち $fg\in C([a,b],\R)$ となること)などを証明
  する必要がある.
  \qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

$n$ 回微分可能でかつ $n$ 階の導函数が連続になる函数を 
{\bf $C^n$ 級函数 (class-$C^\infty$ function)} 
もしくは 
{\bf $C^n$ 函数 ($C^\infty$-function)} と呼ぶ.  
任意有限回微分可能な函数を 
{\bf $C^\infty$ 級函数 (class-$C^\infty$ function)}
もしくは 
{\bf $C^\infty$ 函数 ($C^\infty$-function)} と呼ぶ.

\begin{question}[Leibnitz rule, 5点]
  \label{q:Leibnitz-rule}
  $f$, $g$ が開区間 $(a,b)$ 上の実数値 $C^\infty$ 函数であるとき, %
  $h(x)=f(x)g(x)$ ($x\in(a,b)$) と置くと, $h$ も開区間 $(a,b)$ 上の
  実数値 $C^\infty$ 函数であり, その $n$ 階の導函数 $h^{(n)}$ に
  関して次の公式が成立している:
  \begin{equation*}
    h^{(n)}(x) = \sum_{k=0}^n \binom{n}{k} f^{(k)}(x) g^{(n-k)}(x)
    \qquad (x\in(a,b)).
  \end{equation*}
  この公式を積の微分に関する {\bf Leibnitz rule (ライプニッツ則)}
  と呼ぶ. \qed
\end{question}

\begin{proof}[ヒント]
  $n$ に関する帰納法.
  $n$ から $n+1$ に進むときに $(fg)' = f'g + fg'$ および
  二項係数 $\binom{n}{k}$ が Pascal の三角形と呼ばれる漸化式を
  満たしていることを使え.
  \qed
\end{proof}

\begin{question}[$C^\infty$ 函数全体のなす可換環, 5点]
  \label{q:Cinfty}
  開区間 $(a,b)$ 上の実数値 $C^\infty$ 函数全体のなす集合
  を $C^\infty((a,b),\R)$ と書くと以下が成立している:
  \begin{enumerate}
  \item $C^\infty((a,b),\R)$ は自然に $\R$ 上のベクトル空間をなす.
  \item $C^\infty((a,b),\R)$ は自然に可換環をなす.
    \qed
  \end{enumerate}
\end{question}

\begin{proof}[ヒント]
  記号の簡単のため $A=C^\infty((a,b),\R)$ と置く.
  
  1. $+:A\times A\to A$, $0_A\in A$, $-:A\to A$, $\cdot:\R\times A\to A$ を
  次のように定める: $f,g\in A$, $\alpha\in\R$, $x\in (a,b)$ に対して,
  \begin{equation*}
    (f+g)(x)=f(x)+g(x), \quad
    0_A(x) = 0, \quad
    (-f)(x) = -f(x), \quad
    (\alpha\cdot f)(x) = \alpha f(x).
  \end{equation*}
  この定義のもとで $A$ が $\R$ 上のベクトル空間の公理を満たしていることを示
  せ.

  2. さらに, $\cdot:A\times A\to A$, $1_A\in A$ を次のように定める:
  $f,g\in A$, $a\in (a,b)$ に対して,
  \begin{equation*}
    (f\cdot g)(x) = f(x)g(x), \quad
    1_A(x) = 1.
  \end{equation*}
  問題 \qref{q:Leibnitz-rule} より, $f\cdot g$ もまた $C^\infty$ 函数なので,
  写像 $\cdot:A\times A\to A$ は well-defined である(うまく定義されている).
  よって以上の定義のもとで $A$ が可換環をなすことを示せばよい.
  \qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{加群の準同型とベクトル空間の線形写像の定義}
\label{sec:def-hom}

\begin{definition}[加群の準同型とベクトル空間の線形写像]
  $R$ は可換環であり, $M$, $N$ は $R$ 上の加群であるとし, $f:M\to N$ は任意
  の写像であるとする.  
  このとき $f$ が {\bf $R$ 加群の準同型}
  もしくは{\bf 準同型写像 (homomorphism of $R$-modules)} であるとは
  以下の条件が成立していることである:
  \begin{enumerate}
  \item $f(u+v) = f(u) + f(v)$ \quad ($u,v\in M$);
  \item $f(\alpha u) = \alpha f(u)$ \quad ($\alpha\in R$, $u\in M$).
  \end{enumerate}
  $R$ 加群の準同型写像は {\bf $R$ 準同型 ($R$-homomorphism)} と
  呼ばれることも多い.

  環 $R$ が体 $K$ に等しいとき, $R$ 加群 ($=$ $K$ 加群) は $K$ 上の
  ベクトル空間と呼ばれるのであった. そのとき $R$ 加群の準同型
  は $K$ 上の{\bf 線形写像 (linear mapping)} と呼ばれる.
  \qed
\end{definition}

\begin{question}[準同型の合成, 5点]
  $L$, $M$, $N$ は可換環 $R$ 上の加群であり,
  $f:L\to M$, $g:M\to N$ は $R$ 準同型であるとする.
  そのとき合成 $g\circ f:L\to N$ も $R$ 準同型である.
  \qed
\end{question}

\begin{question}[$\Hom_R$, 5点]
  \label{q:Hom-set}
  $R$ は可換環であるとし, $M$, $N$ は $R$ 加群であるとし,
  \begin{equation*}
    \Hom_R(M,N) = \{\, f:M\to N \mid \text{$f$ は $R$ 準同型} \,\}
  \end{equation*}
  とおく.  $\Hom_R(M,N)$ に加法とスカラー倍の演算を次のように定めることがで
  きることを示せ:   $f,g\in\Hom_R(M,N)$, $u\in M$, $\alpha\in R$ に対して,
  \begin{equation*}
    (f+g)(u) := f(u)+g(u), \qquad (\alpha\cdot f)(u):= \alpha f(u).
  \end{equation*}
  これによって $\Hom_R(M,N)$ は自然に $R$ 加群とみなせる. \qed
\end{question}

\begin{rem}
  上の問題で特に $R$ が体 $K$ に等しいとき, $M$, $N$ は $K$ 上のベクトル空間
  であり,
  \begin{equation*}
    \Hom_R(M,N) = 
    \Hom_K(M,N) = \{\, f:M\to N \mid \text{$f$ は $K$ 上の線形写像} \,\}
  \end{equation*}
  である.  $\Hom_K(M,N)$ は自然に $K$ 上のベクトル空間をなす.  
  \qed
\end{rem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[行列の定める線形写像, 5点]
  $K$ は任意の体であるとし, $K$ の元を成分に持つ $n$ 次元縦ベ
  クトル全体の空間を $K^n$ と表わし, $m\times n$ 行列全体の空間
  を $M_{m,n}(K)$ と書くことにする. このとき, 任意の $m\times n$ 
  行列 $A\in M_{m,n}(K)$ に対して, 写像 $f_A : K^n\to K^m$ を
  \begin{equation*}
    f_A(u) := Au \in K^m \qquad (u\in K^n)
  \end{equation*}
  と定めると, $f_A$ は $K$ 上の線形写像である. \qed
\end{question}

\begin{proof}[ヒント]
  この問題の結果はほとんど自明 (trivial) である. 
  我々は $f_A$ のことを単に $A$ と書いてきたのであった. \qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[積分作用素, 15点]
  問題 \qref{q:C0-1} の結果より, 閉区間 $[a,b]$ 上の実数値連続函数全体
  の集合 $C([a,b],\R)$ は自然に $\R$ 上のベクトル空間とみなされる%
  \footnote{「連続な」という形容詞は英語では ``continuous'' である.
    記号 $C([a,b],\R)$ の $C$ は「連続」という意味である.}.
  $K(x,y)$ は $[a,b]\times[a,b]$ 上の任意の実数値連続函数であるとする.
  このとき, $\R$ 上の線形写像 $T:C([a,b],\R)\to C([a,b],\R)$ を
  \begin{equation*}
    (Tf)(x) := \int_a^b K(x,y)f(y)\,dy
    \qquad (f\in C([a,b],\R),\ x\in [a,b])
  \end{equation*}
  と定めることができることを示せ($Tf$ もまた $[a,b]$ 上の連続函数になること
  も示せ).
  この $T$ は{\bf 積分作用素 (integral operator)} と呼ばれ, $K(x,y)$ は
  その{\bf 核函数 (kernel function)} と呼ばれる%
  \footnote{線形写像 $f:U\to V$ の核 $\Ker f = \{\,x\in U\mid f(x)=0\,\}$ 
    とは無関係であることに注意せよ.}.
  \qed
\end{question}

\begin{proof}[ヒント]
  閉区間 $[a,b]$ 上の積分について以下が成立することを自由に用いてよい%
  \footnote{以下の条件は積分の定義の仕方 (Riemann, Lebesgue) によらずに
    成立している.  以下の条件は積分が $x$ 軸と函数のグラフで囲まれた部分の面
    積 ($x$ 軸より下の部分の面積は $-1$ 倍する) であるという直観より, 
    当然成立すべき事柄ばかりである.}:
  \begin{enumerate}
  \item (連続函数の積分可能性) \quad 
    任意の $f\in C([a,b],\R)$ は $[a,b]$ 上で積分可能である.
  \item (積分の線形性) \quad
    任意の $f,g\in C([a,b],\R)$ と $\alpha\in\R$ に対して,
    \begin{equation*}
      \int_a^b (f(x)+g(x))\,dx = \int_a^b f(x)\,dx + \int_a^b g(x)\,dx,
      \qquad
      \int_a^b \alpha f(x)\,dx = \alpha \int_a^b f(x)\,dx.
    \end{equation*}
  \item (積分の単調性) \quad
    任意の $f,g\in C([a,b],\R)$ に対して, 
    \begin{equation*}
      f(x)\leqq g(x) \ (x\in[a,b]) 
      \implies
      \int_a^b f(x)\,dx \leqq \int_a^b g(x)\,dx.
    \end{equation*}
  \item (積分の絶対値の評価) \quad
    $f\in C([a,b],\R)$ に対して, 
    その絶対値 $|f|$ の $[a,b]$ での最大値を $M$ と書くと%
    \footnote{一般に $\R^n$ の有界閉集合上の実数値連続函数は最大値と最小値を
      持つ.}, 
    \begin{equation*}
      \left|\int_a^b f(x)\,dx\right| 
      \leqq \int_a^b|f(x)|\,dx
      \leqq \int_a^b M\,dx = M(b-a).
    \end{equation*}
  \end{enumerate}
  さらに, $K(x,y)$ の $[a,b]\times [a,b]$ 上での一様連続性を用いてよい%
  \footnote{一般に $\R^n$ の有界閉集合上の実数値連続函数は一様連続である.}.

  $f\in C([a,b],\R)$ を任意に取り, $|f|$ の $[a,b]$ での最大値を $M$ と
  書くと, 任意の $x_0,x\in [a,b]$ に対して,
  \begin{align*}
    |(Tf)(x) - (Tf)(x_0)| 
    &
    = \left|\int_a^b (K(x,y) - K(x_0,y))f(y)\,dy \right|
    \\  &
    \leqq \int_a^b |K(x,y)-K(x_0,y)||f(y)|\,dy
    \\ &
    \leqq M \int_a^b |K(x,y)-K(x_0,y)|\, dy.
  \end{align*}
  連続函数 $K(x,y)$ の $[a,b]\times[a,b]$ 上での一様連続性より, 
  任意の $\eps>0$ に対して, ある $\delta > 0$ が存在
  して,  $|x-x_0|\leqq\delta$ ならば $|K(x,y)-K(x_0,y)|\leqq\eps/(M(b-a))$ 
  ($y\in [a,b]$ は任意でよい) となる.
  よって $|x-x_0|\leqq\delta$ ならば
  \begin{equation*}
    |(Tf)(x) - (Tf)(x_0)| \leqq M \int_a^b \frac{\eps}{M(b-a)}\,dy = \eps.
  \end{equation*}
  これで $Tf$ が $[a,b]$ 上の連続函数であることが示された.
  \qed
\end{proof}

\begin{rem}[積分作用素と行列の定める線形写像の類似]
  積分作用素 $T$ の定義は行列の定める線形写像の定義と似ている.  
  実際, $A=[a_{ij}]\in M_{m,n}(\R)$, $v=[v_i]\in \R^n$ に
  対して, $Av\in\R^m$ の第 $i$ 成分を $(Av)_i$ と書くと,
  \begin{equation*}
    (Av)_i = \sum_{j=1}^n a_{ij}v_j.
  \end{equation*}
  一方, 積分作用素 $T$ は次のように定義されたのであった:
  \begin{equation*}
    (Tf)(x) = \int_a^b K(x,y)f(y)\,dy.
  \end{equation*}
  以上の2つの式を比べれば, 以下のような類似関係があることがわかる:
  \begin{alignat*}{2}
    &
    \text{積分作用素 $T$}    \;\leftrightarrow\;\text{行列 $A$},
    & \qquad &
    \text{函数 $f$}          \;\leftrightarrow\;\text{縦ベクトル $v$},
    \\ &
    \text{核函数 $K(x,y)$}   \;\leftrightarrow\;\text{行列の成分 $a_{ij}$},
    & \qquad &
    \text{積分 $\int_a^b dy$}\;\leftrightarrow\;\text{有限和 $\sum_{j=1}^n$}.
    \qed
  \end{alignat*}
\end{rem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[微分作用素, 10点]
  問題 \qref{q:Cinfty} の結果より, 開区間 $(a,b)$ 上の実数値 $C^\infty$ 函数
  全体のなす集合 $C^\infty((a,b),\R)$ は自然に $\R$ 上のベクトル空間で
  かつ可換環とみなされる.  
  記号の簡単のため $A=C^\infty((a,b),\R)$ と置く.
  以下が成立することを示せ:
  \begin{enumerate}
  \item $f\in A$ に対して, 写像 $\hat{f}:A\to A$ を
    \begin{equation*}
      \hat{f}(g) := f\cdot g \qquad (g\in A)
    \end{equation*}
    と定めると, $\hat{f}$ は $\R$ 上の線形写像である.
  \item 写像 $\d:A\to A$ を
    \begin{equation*}
      \d(f) := f' \qquad (f\in A,\ \text{$f'$ は $f$ の導函数})
    \end{equation*}
    と定めると, $\d$ は $\R$ 上の線形写像である.
  \item $a_0,a_1,\ldots,a_n\in A$ に対して写像 $P:A\to A$ を
    \begin{equation*}
      P(f) := a_n f^{(n)} + a_{n-1}f^{(n-1)} + \cdots + a_1 f' + a_0 f
      \quad (f\in A)
    \end{equation*}
    と定める.  ここで $f^{(k)}$ は $f$ の $k$ 階の導函数である.
    このとき $P$ は $\R$ 上の線形写像である.
  \item 任意の $f\in A$ に対して $[\d,\hat{f}]=\widehat{f'}$. 
    ($[A,B]=AB-BA$ である.)
  \end{enumerate}
  $P$ は{\bf 線形常微分作用素 (linear ordinary differential operator)} 
  と呼ばれ,
  \begin{equation*}
    P = a_n\d^n + a_{n-1}\d^{n-1} + \cdots + a_1\d + a_0
  \end{equation*}
  と書かれる. \qed
\end{question}

\begin{proof}[ヒント]
  4は次のようにして証明される. 任意の $g\in A$ を取ると,
  \begin{equation*}
    \d(\hat{f}(g)) = \d(fg) = (fg)'
    = f'g + fg' = \widehat{f'}(g) + \hat{f}(\d(g))
  \end{equation*}
  なので $\d(\hat{f}(g)) - \hat{f}(\d(g)) = \widehat{f'}(g)$.
  これで $[\d,\hat{f}]=\d\widehat{f}-\widehat{f}\d=\widehat{f'}$ が証明され
  た. \qed
\end{proof}

\begin{guide}
  \label{guide:merit-of-generalization}
  積分作用素と微分作用素は線形写像を作るための材料として行列と同じくらい基本
  的である.  数ベクトルと行列の理論をベクトル空間と線形写像の理論に一般化し
  ておくことのメリットの一つはある種の函数全体のなす空間のあいだの微分作用素
  や積分作用素も扱えるようになることである.
  \qed
\end{guide}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[多項式係数の微分作用素, 10点]
  \label{q:polyn-diff-op}
  複素係数の一変数多項式環 $\C[x]$ は自然に $\C$ 上のベクトル空間をなす.
  以下が成立することを示せ:
  \begin{enumerate}
  \item $f\in \C[x]$ に対して, 写像 $\hat{f}:\C[x]\to\C[x]$ を
    \begin{equation*}
      \hat{f}(g) := f\cdot g \qquad (g\in \C[x])
    \end{equation*}
    と定めると, $\hat{f}$ は $\C$ 上の線形写像である.
  \item 写像 $\d:\C[x]\to\C[x]$ を
    \begin{equation*}
      \d(f) := f' \qquad (f\in\C[x],\ \text{$f'$ は $f$ の導函数})
    \end{equation*}
    と定めると, $\d$ は $\C$ 上の線形写像である.
  \item $a_0,a_1,\ldots,a_n\in\C[x]$ に対して写像 $P:\C[x]\to\C[x]$ を
    \begin{equation*}
      P(f) := a_n f^{(n)} + a_{n-1}f^{(n-1)} + \cdots + a_1 f' + a_0 f
      \quad (f\in A)
    \end{equation*}
    と定める.  ここで $f^{(k)}$ は $f$ の $k$ 階の導函数である.
    このとき $P$ は $\C$ 上の線形写像である.
  \item $[\d,\widehat{x^i}]=i\widehat{x^{i-1}}$. 
    特に $[\d,\hat{x}]=1$. 
    ($[A,B]=AB-BA$ である.)
  \end{enumerate}
  $P$ は{\bf 多項式係数の線形常微分作用素 
    (linear ordinary differential operator with polynomial coefficients)} 
  と呼ばれ,
  \begin{equation*}
    P = a_n\d^n + a_{n-1}\d^{n-1} + \cdots + a_1\d + a_0
  \end{equation*}
  と書かれる. \qed
\end{question}

%\begin{rem}
%  上の問題 \qref{q:polyn-diff-op} の結果は
%  問題 \qref{q:sl2-1}, \qref{q:sl2-2} で応用される.
%  \qed
%\end{rem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{一般のベクトル空間における部分空間, 一次独立性, 基底}

体 $K$ 上の変数 $x$ に関する1変数多項式環を $K[x]$ と書くことにする.
$K[x]$ は自然に $K$ 上の線形空間とみなされる.

\begin{question}[5点]
  $V := \{\, f\in\C[x] \mid f(-a)=\overline{f(a)}\ (a\in\R) \,\}$ %
  ($\overline{\phantom{A}}$ は複素共役) と置く.
  $\C[x]$ は自然に $\C$ 上および $\R$ 上のベクトル空間とみなされる.
  $V$ は $\C[x]$ の $\C$ 上の部分空間ではないが, %
  $\R$ 上の部分空間になることを示せ.
  \qed
\end{question}

\begin{question}[5点]
  $\F_2=\{0,1\}$ は二元体であるとし, %
  $V:=\{\, f\in\F_2[x] \mid f(-x)^2=f(x)^2\,\}$ と置く.
  このとき $V=\F_2[x]$ であることを示せ.
  \qed
\end{question}

\begin{question}[5点]
  $\R$ 上の複素数値 $C^\infty$ 函数全体の集合 $C^\infty(\R)$ は
  自然に $\C$ 上のベクトル空間とみなされる.
  任意に $a,b\in C^\infty(\R)$ を取り, $C^\infty(\R)$ の部分集合 $V$ を
  \begin{equation*}
    V := \{\, v\in C^\infty(\R)
    \mid v''+ av'+ bv = 0 \,\}
  \end{equation*}
  と定める. ここで $v''+ av'+ bv = 0$ は %
  $v''(x)+ a(x)v'(x)+ b(x)v(x) = 0$ ($x\in\R$) が成立するという意味である.
  このとき $V$ は $C^\infty(\R)$ の $\C$ 上の部分空間である.
  \qed
\end{question}

\begin{question}[二階の線形常微分方程式の解空間, 5点]
  \label{q:ODE-a,b}
  $\R$ 上の複素数値 $C^\infty$ 函数全体の集合 $C^\infty(\R)$ は
  自然に $\C$ 上のベクトル空間とみなされる.
  任意に $a,b\in C^\infty(\R)$ を取り, $V\subset C^\infty(\R)$ を
  \begin{equation*}
    V := \{\, v\in C^\infty(\R) \mid v''+ av'+ bv = 0 \,\}
  \end{equation*}
  と定める. ここで「$v''+ av'+ bv = 0$」は %
  「任意の $x\in \R$ に対して $v''(x)+ a(x)v'(x)+ b(x)v(x) = 0$ が成立する」と
  いう意味である. このとき $V$ は $C^\infty(\R)$ の部分空間である.
  \qed
\end{question}

%\begin{question}[Riccati型微分方程式, 5点]
%  \label{q:Riccati1}
%  任意に $a,b\in C^\infty(\R)$ を取り, $Q \subset C^\infty(\R)$ を
%  \begin{equation*}
%    Q := \{\, q\in C^\infty(\R) \mid q' = q^2 - aq + b \,\}
%  \end{equation*}
%  と定める. このとき $Q$ は $C^\infty(\R)$ の部分空間ではない.
%  \qed
%\end{question}
%
%\begin{question}[10点]
%  \label{q:Riccati2}
%  問題 \qref{q:ODE-a,b} の $V$ と
%  問題 \qref{q:Riccati1} の $Q$ の関係について考える.
%  $q\in Q$ を任意に取り, $C^\infty(\R)$ の部分集合 $W$ を
%  \begin{equation*}
%    W := \{\, w\in C^\infty(\R) \mid w' + qw = 0 \,\}
%  \end{equation*}
%  と定める. このとき $W$ は $V$ の $\C$ 上の部分空間である.
%  \qed
%\end{question}
%
%\begin{proof}[ヒント]
%  $\d=d/dx$ と置き, $\d^2+a\d+b$ を $\d+q$ で右から割り算してみよ.
%  ここで割り算とは小学校のときに習ったような商と余りを求める割り算のことである.
%  商は $\d+a-q$ となり, 余りは $b-q'-(a-q)q$ になる.
%  \qed
%\end{proof}

\begin{question}[10点]
  $K$ は任意の体であるとし, $a_{ij}\in K$ ($i>j\ge 0$) を任意に取る.
  $f_i\in K[x]$  ($i=0,1,2,\ldots$) を次のように定義する:
  \begin{equation*}
    f_i(x) = a_{i0} + a_{i1}x + \cdots + a_{i,i-1}x^{i-1} + x^i,
  \end{equation*}
  ($f_0(x)=1$ であることに注意.)
  このとき $f_0,f_1,f_2,\ldots$ が $K[x]$ の基底になることを示せ.
  \qed
\end{question}

\begin{proof}[ヒント]
  $f_0,f_1,f_2,\ldots$ の一次独立性および
  任意の $f\in K[x]$ が $f_0,f_1,f_2,\ldots$ の $K$ 係数有限一次結合で
  表わされることを示せばよい. 
  (もしくは任意の $f\in K[x]$ が $f_0,f_1,f_2,\ldots$ の $K$ 係数
  有限一次結合で一意に表わされることを示せばよい.)
  \qed
\end{proof}

\begin{question}[10点]
  \label{q:lin-indep-x^k}
  $A$ は $\R$ の任意の無限部分集合であるとする.
  $A$ 上の実数値函数全体の集合は自然に実ベクトル空間をなす
  (このことは認めて使ってよい).
  $0$ 以上の整数 $i$ に対して $A$ 上の実数値函数 $f_i$ を
  \begin{equation*}
    f_i(x) = x^i \qquad (x\in A)
  \end{equation*}
  と定める. このとき $f_0,f_1,f_2,\ldots$ が一次独立であることを示せ.
  \qed
\end{question}

\begin{proof}[ヒント]
  $A$ は無限集合なので任意の $n=1,2,3,\ldots$ に対して
  互いに異なる元 $a_1,\ldots,a_n\in A$ を取れる.
  このとき Vandermonde 行列式の公式より, $n\times n$ 行列
  \begin{equation*}
    A_n = 
    \begin{bmatrix}
      a_1^0     & a_2^0     & \cdots & a_n^0     \\
      a_1^1     & a_2^1     & \cdots & a_n^0     \\
      \vdots    & \vdots    & \ddots & \vdots    \\
      a_1^{n-1} & a_2^{n-1} & \cdots & a_n^{n-1} \\
    \end{bmatrix}
  \end{equation*}
  は可逆になる. このことを使って $f_0,f_1,\ldots,f_{n-1}$ が一次独立
  であることを示せ. \qed
\end{proof}

\begin{question}[15点]
  $p$ は素数であるとし, $\F_p=\{0,1,\ldots,p-1\}$ は $p$ 元体であるとする.
  $\F_p$ 上の $\F_p$ 値函数全体の集合は $\F_p$ 上のベクトル空間をなす.
  $\F_p$ 上の $\F_p$ 値函数 $f_0,f_1,f_2,\ldots$ を次のように定める:
  \begin{equation*}
    f_i(x) = x^i \qquad (x\in\F_p).
  \end{equation*}
  このとき $f_0,f_1,\ldots,f_{p-1}$ は一次独立であるが, %
  $f_1,f_2,\ldots,f_p$ は一次従属であることを示せ.
  \qed
\end{question}

\begin{proof}[ヒント]
  $f_0,f_1,\ldots,f_{p-1}$ の一次独立性の証明は
  問題 \qref{q:lin-indep-x^k} と同じ.
  実は任意の $a\in\F_p$ に対して $a^p=a$ となる
  (この結果の証明は代数学の教科書を参照せよ).
  感じがつかめなければ $p=2,3,5$ の場合にどうなっているかをチェックしてみよ.
  \qed
\end{proof}

\begin{rem}
  上の問題の結果を見て変数 $x$ に関する $\F_p$ 上の多項式環 $\F_p[x]$ に
  おいても $x^p=x$ であると誤解してはいけない. 
  $\F_p$ 係数の多項式とそれを $\F_p$ 上の函数とみなしたものは
  厳密に区別されなければいけない.
  $K$ が無限体であれば $K[x]$ の元と $K$ 上の多項式函数を同一視できる
  のでそのような区別は必要ない.
  \qed
\end{rem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Zornの補題と基底の存在}

「任意のベクトル空間に基底が存在する」もしくはより強い「任意のベクトル
空間の一次独立な部分集合を基底に拡張できる」という定理は{\bf Zornの補題
(ツォルンの補題)}を用いて証明される.

しかし, Zornの補題についてまだ十分に習っていないようなので, 
この節では選択公理からZornの補題を導く方法について詳しく説明する.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{選択公理}

{\bf 選択公理 (axiom of choice)} とは次の命題のことである:
\begin{itemize}
\item[(AC)] 任意の $x\in X$ に対してある $y\in Y$ で条件 $P(x,y)$ を
  満たすものが存在するならば, 
  ある写像 $f:X\to Y$ が存在して
  任意の $x\in X$ に対して条件 $P(x,f(x))$ が成立する.
\end{itemize}
このような写像 $f$ は{\bf 選択函数 (choice function)} と呼ばれる.
選択公理を論理式で書くと次のようになる:
\begin{equation*}
  \forall x\in X\, \exists y\in Y\, P(x,y)
  \implies
  \exists f:X\to Y\, \forall x\in X\, P(x,f(x)).
\end{equation*}
形式的に選択公理は $\forall$ と $\exists$ の順序を引っくり返す形をしている.

選択公理の直観的な説明. もしも任意の $x\in X$ に対して条件 $P(x,y)$ を
満たす $y\in Y$ が存在するならば各 $x\in X$ ごとにそのような $y\in Y$ を
一つずつ選んで $f(x)=y$ と定めることによって選択函数 $f:X\to Y$ を作る
ことができる. そのとき $f$ の作り方より任意の $x\in X$ に対して
条件 $P(x,f(x))$ が成立している.

非常に疑い深い人の考え方. もしも $X$ が無限集合ならば全ての $x\in X$ に対して
条件 $P(x,y)$ を満たす $y\in Y$ を一つずつ選び出すことができないかもしれない.

このように疑う自由はあるが, 選択公理は自然であり(実際選択公理を意識せずに
使ってしまう人が大部分だろう), 非常に便利なので数学の公理として
仮定されることになる.

選択公理は上に述べた形とは異なる形で述べられることも多い. たとえば
\begin{itemize}
\item[(AC')] $\{Y_x\}_{x\in X}$ が空でない集合の集合族ならば
  ある写像 $f:X\to \bigcup_{x\in X}Y_x$ が存在して任意の $x\in X$ に
  対して $f(x)\in Y_x$ が成立する.
\end{itemize}
直観的な説明. 各 $x\in X$ ごとに空でない集合 $Y_x$ から一つずつ元を選び,
その元を $f(x)$ と定めることによって写像 $f:X\to \bigcup_{x\in X}Y_x$ を
作ることができる. このとき $f$ の作り方より
任意の $x\in X$ に対して $f(x)\in Y_x$ が成立している.

\begin{question}[5点]
  (AC)と(AC')が同値であることを証明せよ. \qed
\end{question}

\begin{proof}[ヒント]
  (AC)$\implies$(AC').\enspace (AC)を仮定し, 
  $\{Y_x\}_{x\in X}$ は空でない集合で構成された集合族であると仮定する.
  $Y=\bigcup_{x\in X} Y_x$ と置き, 
  $x\in X$, $y\in Y$ に対して条件 $P(x,y)$ が成立するとは
  $y\in Y_x$ が成立することであると定める.

  (AC')$\implies$(AC).\enspace (AC')を仮定し, 
  任意の $x\in X$ に対してある $y\in Y$ で条件 $P(x,y)$ を
  満たすものが存在すると仮定する.
  $x\in X$ に対して $Y_x=\{\,y\in Y\mid P(x,y)\,\}$ と置く.
  \qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{順序集合に関する言葉の準備}

\begin{definition}[順序集合]
  集合と二項関係の組 $(X,\leqq)$ が{\bf 順序集合 (ordered set)} であるとは
  以下の条件が成立していることである:
  \begin{itemize}
  \item 任意の $x\in X$ に対して $x\leqq x$.
  \item 任意の $x,y,z\in X$ に対して $x\leqq y$ かつ $y\leqq z$ 
    ならば $x\leqq z$.
  \item 任意の $x,y\in X$ に対して $x\leqq y$ かつ $y\leqq x$ 
    ならば $x = y$.
  \end{itemize}
  このとき $\leqq$ は{\bf 順序 (order)} と呼ばれる. さらに
  \begin{itemize}
  \item 任意の $x,y\in X$ に対して $x\leqq y$ または $y\leqq x$
    \enspace ($x$ と $y$ は比較可能)
  \end{itemize}
  が成立しているとき $(X,\leqq)$ は{\bf 全順序集合 (totally ordered set)} 
  と呼ばれ, $\leqq$ は{\bf 全順序 (total order)} であると言う.
  $x\leqq y$ を $y\geqq x$ と書くこともある.
  また $x\leqq y$ かつ $x\ne y$ のとき $x<y$ と書くことにする.
  \qed
\end{definition}

\begin{example}[順序集合の例]
  順序集合には以下のような例がある:
  \begin{enumerate}
  \item 実数全体の集合 $\R$ は通常の大小関係に関する全順序集合である.
  \item 正の整数全体の集合を $\Z_{>0}=\{\,n\in\Z\mid n>0\,\}$ と書く.
    整数 $a$ が整数 $b$ の約数であるとき $a\mid b$ と書く.
    このとき $(\Z_{>0},\,\mid\,)$ は順序集合であるが, 全順序集合ではない.
  \item 集合の集合は包含関係に関する順序集合とみなされる.
  \item 任意の順序集合の部分集合は自然に順序集合とみなされる.
    \qed
  \end{enumerate}
\end{example}

\begin{definition}[上界, 最小元, 上限, 極大元]
  $(X,\leqq)$ は順序集合であるとし, $A\subset X$ であるとする.
  \begin{itemize}
  \item  $x\in X$ が $A$ の{\bf 上界 (upper bound)} であるとは, 
    任意の $a\in A$ に対して $a\leqq x$ が成立することである.
    $A$ の上界は存在するとは限らないし, 存在しても唯一とは限らない.
  \item $a_0\in A$ が $A$ の{\bf 最小元 (minimum)} であるとは,
    任意の $a\in A$ に対して $a_0\leqq a$ が成立することである.
    $A$ の最小元は存在すれば唯一であり, そのとき $\min A$ と表わされる.
  \item $s\in X$ が $A$ の{\bf 上限 (supremum)} であるとは
    $s$ が $A$ の{\bf 最小上界 (minimum upper bound)} 
    すなわち $A$ の上界全体の集合の最小元であることである.
    $A$ の上限は存在すれば唯一であり, そのとき $\sup A$ と表わされる.
  \item $m\in A$ が $X$ の{\bf 極大元 (maximal element)} であるとは
    任意の $x\in A$ に対して $x\geqq m$ ならば $x=m$ となることである.
    (すなわち $x\in A$ で $x>m$ を満たすものが存在しないことである.)
    $A$ の極大元は存在するとは限らないし, 存在しても唯一とは限らない.
  \end{itemize}
  順序関係を逆転させることによって, 
  {\bf 下界 (lower bound)}, {\bf 最大元 (maximum)}, $\max A$, 
  {\bf 下限 (infimum)}, $\inf A$, {\bf 極小元 (mimimal element)} 
  が同様に定義される.
  \qed
\end{definition}

\begin{definition}[帰納的順序集合]
  順序集合 $(X,\leqq)$ が{\bf 帰納的 (inductive)} であるとは %
  $X$ の任意の全順序部分集合が上界を持つことである.
  \qed
\end{definition}

\begin{example}[帰納的順序集合およびそうでない順序集合の例]
  \quad
  \begin{itemize}
  \item 最大元を持つ順序集合は帰納的順序集合である.
  \item 有限順序集合は帰納的順序集合である.
  \item 帰納的順序集合 $(X,\leqq)$ と $x_0\in X$ に対して, % 
    $X_{\geqq x_0} = \{\,x\in X \mid x \geqq x_0 \,\}$ も帰納的順序集合になる.
  \item $(\Z_{>0},\,\mid\,)$ は順序集合だが, 帰納的ではない.
  \item $(\R, \leqq)$ は全順序集合だが, 帰納的ではない.
  \item $K$ は任意の体であるとし, $V$ は $K$ 上の任意のベクトル空間
    であるとする. $V$ の一次独立な部分集合全体の集合 $\cL$ は包含関係
    に関して帰納的順序集合である.
    \qed
  \end{itemize}
\end{example}

\begin{question}[5点]
  順序集合 $(\Z_{>0},\,\mid\,)$, $(\R, \leqq)$ が帰納的でないことを示せ.
  \qed
\end{question}

\begin{question}[5点]
  \label{q:indord-subset}
  帰納的順序集合 $(X,\leqq)$ と $x_0\in X$ に対して, % 
  $X_{\geqq x_0} = \{\,x\in X \mid x \geqq x_0 \,\}$ も帰納的順序集合になる
  ことを示せ. 
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{Zornの補題}

{\bf Zornの補題 (Zorn's lemma)} とは次の命題のことである:
\begin{itemize}
\item[(ZL)] 空でない任意の帰納的順序集合 $(X,\leqq)$ と
  その任意の元 $x_0\in X$ に対して $X$ の極大元 $m$ で $m\geqq x_0$ を
  満たすもの ($x_0$ 以上の極大元 $m$) が存在する.
\end{itemize}
次のように見かけ上弱い形で Zorn の補題が述べられることもある:
\begin{itemize}
\item[(ZL')] 空でない任意の帰納的順序集合 $(X,\leqq)$ は極大元を持つ.
\end{itemize}
これらは同値である.

\begin{question}[5点]
  (ZL)と(ZL')の同値性を証明せよ. \qed
\end{question}

\begin{proof}[ヒント]
  問題 \qref{q:indord-subset} の結果を使えば簡単である. \qed
\end{proof}

さて目標は選択公理 (AC) から Zorn の補題 (ZL) を導くことである. 

まず証明の概略を説明しよう.

\begin{proof}[証明の概略]
  選択公理を仮定する.
  $(X,\leqq)$ は帰納的順序集合であり, $x_0\in X$ であると仮定する.
  $X$ には $x_0$ 以上の極大元が存在しないと仮定して矛盾を導けばよい.
  
  $x_0$ を含む $X$ の全順序部分集合全体の集合を $\cC$ と書くことにする. 
  (全順序部分集合は chain と呼ばれることがあるのでその頭文字を取って $\cC$ 
  と書くことにした.)
  
  $X$ が帰納的であるという仮定より, 任意の $C\in \cC$ に対して $C$ の
  上界 $y\in X$ が存在する. このとき特に $y\geqq x_0$ である.
  
  $X$ には $x_0$ 以上の極大元が存在しないという仮定より, %
  $y$ は $X$ の極大元ではない. よってある $z\in X$ で $z>y$ を
  満たすものが存在する.
  
  選択公理を仮定したので, 各 $C\in\cC$ に対して上のような $z\in X$ を
  対応させる選択函数 $f:\cC\to X$ が存在して, 任意の $C\in\cC$, $x\in C$ に
  対して $f(C)>x$ が成立する (特に $f(C)\not\in C$ である).
  
  $C_0=\{x_0\}\in\cC$, 
  $C_1=C_0\cup\{f(C_0)\}\in\cC$, 
  $C_2=C_1\cup\{f(C_1)\}\in\cC$, $\ldots$ が成立する.
  この構成を{\bf ``限りなく最大限続けることによって''} $C_{\max}\in \cC$ 
  を構成する. 
  もしも $f(C_{\max})\not\in C_{\max}$ ならば
  さらに $C_{\max+1} = C_{\max}\cup\{f(C_{\max})\}$ によって次のステップ
  に進むことができるので, {\bf ``限りなく最大限続けることによって''}
  の「最大限」という言葉に矛盾してしまう.
  よって $f(C_{\max})\in C_{\max}$ でなければいけない.
  {\bf (この段落だけは曖昧過ぎるので数学的に不完全である.)}
  
  しかし $C_{\max}\in\cC$ より $f(C_{\max})\not\in C_{\max}$ で
  なければいけない.
  
  これで矛盾が導かれた.
  \qed  
\end{proof}

以上の証明の概略は一つの段落を除けば完全である. 
残された問題は「$C_0,C_1,C_2,\ldots$ の構成を
{\bf ``限りなく最大限続けることによって''} $C_{\max}$ を構成する」
の部分をどのように数学的に正当化するかである.

\begin{rem}
  目標である $C_{\max}$ の構成のためには, 
  自然数 $n$ に対する $C_n$ を構成するだけでは不十分である.
  なぜならば自然数 $n$ に対して $f(C_n)\not\in C_n$ だからである.
  よってこの証明を完結させるためには数学的帰納法だけでは不十分である.
  すべての自然数 $n$ に対して $C_n$ が構成された後
  は $C_\omega = \bigcup_{n=0}^\infty C_n$ によって
  次のステップに進むことになる. 
  しかし, 以下ではこういう方針を取らずに集合の演算を
  巧妙に使って $C_{\max}$ を構成することにする.
  \qed
\end{rem}

\begin{proof}[上の証明の概略の曖昧な部分の数学的正当化]
  \quad

  \medskip\noindent
  {\bf Step 1.} $\cT_{\min}\subset\cC$ の構成
  \medskip

  $\cT\subset\cC$ が塔 (tower) であるとは
  次の3つの条件を満たすことであると定める:
  \begin{itemize}
  \item[(a)] $\{x_0\}\in \cT$.
  \item[(b)] $T\in\cT$ ならば $T\cup\{f(T)\}\in\cT$.
  \item[(c)] $\cS$ が $\cT$ の包含関係に関する全順序部分集合になっている
    ならば $\bigcup_{S\in\cS}S\in\cT$.
  \end{itemize}
  たとえば $\cC$ 自身は塔である(容易なので自分で証明してみよ).

  塔全体の共通部分を %
  $\cT_{\min} = \bigcap_{\text{$\cT$ は塔}}\cT$ と書くことにする.
  (少なくとも一つ塔が存在するので $\cT_{\min}$ は well-defined である.)

  \medskip\noindent
  (解説: この $\cT_{\min}$ は上の証明の概略中
  で{\bf ``限りなく最大限続けることによって''}
  構成された $C_0,C_1,C_2,\ldots$ 全体の集合である.
  証明の概略中では構成の仕方は非常に曖昧だったが
  上の構成法は論理的に明確である.
  $C_{\max}$ は $\cT_{\min}$ の包含関係に関する最大元として構成される.
  アイデアが必要な本質的なステップはこの Step 1 だけであり, 
  $\cT_{\min}$ の明確な構成の仕方さえわかっていれば残りの部分は
  機械的な作業 (routine) に過ぎない.
  機械的に論理的な作業をこなす能力が身に付けば
  直観的で曖昧な議論をどのように
  論理的に明確にするかに意識を集中できるようになる.
  直観的な議論を自由に進めながら, 曖昧な細部を徐々に論理的に
  明確にして行くのは非常に楽しい.)

  \medskip\noindent
  {\bf Step 2.} $\cT_{\min}$ が最小の塔になることの証明 (容易)
  \medskip

  (a) すべての塔は $\{x_0\}$ を
  含むので $\{x_0\}\in\cT_{\min}$ である.

  (b) $T\in\cT_{\min}$ ならば任意の塔 $\cT$ に対して $T\in\cT$ で
  あるから $T\cup\{f(T)\}\in\cT$ である. よって $T\in\cT_{\min}$ である.

  (c) $\cS$ が $\cT_{\min}$ の全順序部分集合ならば %
  $\cS$ は任意の塔 $\cT$ の全順序部分集合でもあるので %
  $\bigcup_{S\in\cS}S\in\cT$ である.
  よって $\bigcup_{S\in\cS}S\in\cT_{\min}$ である.

  これで $\cT_{\min}$ が塔であることがわかった.
  $\cT_{\min}$ は任意の塔に含まれるので最小の塔である.

  \medskip\noindent
  {\bf Step 3.} $\cT_{\min}$ が包含関係に関する全順序集合であることの証明
  (少し面倒)
  \medskip

  $\cT_{\min}$ の部分集合 $\cT_0$ を次のように定める:
  \begin{equation*}
    \cT_0 = 
    \{\, S\in\cT_{\min} 
    \mid \text{任意の $T\in\cT_{\min}$ に
      対して $S\subset T$ または $T\subset S$} \,\}.
  \end{equation*}
  ($\cT_0$ は $\cT_{\min}$ の任意の元と比較可能な $\cT_{\min}$ の
  元全体のなす集合である.)
  
  $\cT_0$ は包含関係に関して全順序集合になる.
  実際任意に $S,T\in\cT_0$ 取ると $T\in\cT_{\min}$ 
  なので $S\subset T$ または $T\subset S$ が成立する.

  よって $\cT_0=\cT_{\min}$ を証明すればよい.
  $\cT_{\min}$ が最小の塔であることより, 
  そのためには $\cT_0$ も塔であることを示せば十分である.

  (a) 任意の $T\in\cT_{\min}\subset\cC$ に対して $\{x_0\}\subset T$ 
  であるから $\{x_0\}\in\cT_0$ である.

  (b) $\cT_0$ が(b)を満たすことの証明は長くなるので次のステップで証明する.

  (c) $\cS$ は $\cT_0$ の包含関係に関する全順序部分集合であると仮定する.
  $\cS$ は $\cT_{\min}$ の包含関係に関する全順序部分集合でも
  あるので $\bigcup_{S\in\cS}S\in\cT_{\min}$ である.
  任意に $T\in\cT_{\min}$ を取る.
  任意の $S\in\cS$ に対して $S\subset T$ または $T\subset S$ である.
  もしも $T\subset S$ を満たす $S\in\cS$ が存在する
  ならば $T\subset\bigcup_{S\in\cS}S$ となる.
  もしもそのような $S$ が存在しなければ 
  任意の $S\in\cS$ に対して $S\subset T$ となる
  ので $\bigcup_{S\in\cS}S\subset T$ となる.
  したがって $\bigcup_{S\in\cS}S\subset T$ 
  または $T\subset\bigcup_{S\in\cS}S$ が成立する.
  よって $\bigcup_{S\in\cS}S\in\cT_0$ である.

  \medskip\noindent
  {\bf Step 4.} $\cT_0$ が(b)を満たすことの証明 (再度同じ方法を使う)
  \medskip

  $C\in\cT_0$ を任意に取る. 
  $C\in\cT_{\min}$ でもあるので $C\cup\{f(C)\}\in\cT_{\min}$ である.
  $\cT_{\min}$ の部分集合 $\cT_C$ を次のように定める:
  \begin{equation*}
    \cT_C = 
    \{\, T\in\cT_{\min} \mid 
    \text{$T\subset C$ または $C\cup\{f(C)\}\subset T$} \,\}.
  \end{equation*}
  $\cT_0$ が(b)を満たすことを示すためには $\cT_C=\cT_{\min}$ であること
  を示せば十分である.
  $\cT_{\min}$ が最小の塔であることから, そのためには $\cT_C$ が塔で
  あることを示せば十分である.

  (a) $\{x_0\}\subset C$ なので $\{x_0\}\in\cT_C$ である.

  (b) $T\in\cT_C$ を任意に取る. 
  このとき $T\subset C$ または $C\cup\{f(C)\}\subset T$ である.
  $C\cup\{f(C)\}\subset T$ のとき $C\cup\{f(C)\}\subset T\cup\{f(T)\}$ で
  あるから $T\cup\{f(T)\}\in\cT_C$ である.
  そこで $T\subset C$ と仮定する.
  $C\in\cT_0$ より $T\cup\{f(T)\}\subset C$ 
  または $C\subset T\cup\{f(T)\}$ である. 
  $T\cup\{f(T)\}\subset C$ のとき $T\in\cT_C$ である.
  そこで $C\subset T\cup\{f(T)\}$ と仮定する.
  $T\subset C$ より $C=T$ または $C=T\cup\{f(T)\}$ である.
  $C=T$ のとき $C\cup\{f(C)\}=T\cup\{f(T)\}$ 
  (特に $C\cup\{f(C)\}\subset T\cup\{f(T)\}$)
  なので $T\cup\{f(T)\}\in\cT_C$ である.
  $C=T\cup\{f(T)\}$ のとき特に $T\cup\{f(T)\}\subset C$ 
  なので $T\cup\{f(T)\}\in\cT_C$ である.
  これで $T\in\cT_C$ ならば常に $T\cup\{f(T)\}\in\cT_C$ となることがわかった.

  (c) $\cS$ は $\cT_C$ の包含関係に関する全順序部分集合であるとする.
  $\cS$ は $\cT_{\min}$ の包含関係に関する全部分集合でもある
  ので $\bigcup_{S\in\cS}S\in\cT_{\min}$ である.
  任意に $S\in\cS$ を取る. $S\subset C$ または $C\cup\{f(C)\}\subset S$ である.
  もしもある $S\in\cS$ で $C\cup\{f(C)\}\subset S$ を満たすものが存在する
  ならば $C\cup\{f(C)\}\subset \bigcup_{S\in\cS}S$ である.
  もしもそのような $S$ が存在しなければ任意の $S\in\cS$ に対して $S\subset C$
  となるので $\bigcup_{S\in\cS}S\subset C$ となる.
  したがって $\bigcup_{S\in\cS}S\in\cT_C$ である.

  \medskip\noindent
  {\bf Step 5.}  $\cT_{\min}$ の包含関係に関する最大元 $C_{\max}$ の構成 (容易)
  \medskip

  $C_{\max}=\bigcup_{C\in\cT_{\min}}C$ と置く. 
  任意の $C\in\cT_{\min}$ に対して $C\subset C_{\max}$ である.
  $\cT_{\min}$ は塔でかつ包含関係に関する全順序集合
  なので $\cT_{\min}$ に関する条件(c)より $C_{\max}\in\cT_{\min}$ である.
  これで $C_{\max}$ は $\cT_{\min}$ の包含関係に関する
  最大元であることが示された.

  \medskip\noindent
  {\bf Step 6.} $f(C_{\max})\in C_{\max}$ の証明 (容易)
  \medskip

  $C_{\max}$ に関する
  条件(b)より $C_{\max}\cup\{f(C_{\max})\}\in\cT_{\min}$ である.
  しかし $C_{\max}$ は包含関係に関する $\cT_{\min}$ の最大元
  なので $C_{\max}\cup\{f(C_{\max})\}=C_{\max}$ でなければいけない. 
  よって $f(C_{\max})\in C_{\max}$ である.

  \medskip\noindent
  {\bf Step 7.} Zornの補題の証明の完了 (容易)
  \medskip
  
  $f(C_{\max})\in C_{\max}$ であることが証明されてしまったが, 
  $C_{\max}\in\cC$ なので $f$ の定義より $f(C_{\max})\not\in C_{\max}$ である.
  これは矛盾である. 
  したがって帰納的順序集合 $X$ とその元 $x_0$ に対して $x_0$ 以上の $X$ の
  極大元が存在しなければいけない.
  \qed
\end{proof}

\begin{question}[10点]
  Zornの補題から選択公理を導け. \qed
\end{question}

\begin{proof}[ヒント]
  $\cF=\{\,(A,f)\mid \text{$A\subset X$, $f:A\to Y$, 任意の 
    $x\in A$ に対して $P(x,f(x))$ が成立する}\,\}$ と置く.
  $(A,f),(B,g)\in\cF$ に対して $(A,f)\leqq (B,g)$ である
  とは $A\subset B$ かつ $g$ が $f$ の拡張になっていることであると定める.
  このとき $\cF$ は帰納的順序集合である.  
  \qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{任意のベクトル空間の基底の存在}

\begin{question}[10点, 任意のベクトル空間の基底の存在定理]
  \label{q:existence-basis-1}
  $K$ は任意の体であるとし, $V$ は $K$ 上の任意のベクトル空間
  であるとする. $V$ の一次独立な部分集合全体の集合 $\cL$ は包含関係
  に関する帰納的順序集合であることを示せ.
  次節で解説するZornの補題を用いて, 
  $V$ の一次独立な任意の部分集合を基底に拡張できることを証明せよ.
  \qed
\end{question}

\begin{proof}[ヒント]
  $\cA\subset \cL$ は包含関係に関して $\cL$ の全順序部分集合であるとする.
  $B=\bigcup_{A\in\cA} A$ と置く.
  そのとき任意の $A\in\cA$ に対して $A\subset B$ である.
  $B$ も一次独立な $V$ の部分集合になること (すなわち $B\in\cL$) を示せ. 
  \qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{Zornの補題の他の応用}

\begin{question}[10点]
  Zornの補題を用いて次を示せ. $K$ は任意の体であり, $U$, $V$ は $K$ 上の
  任意のベクトル空間であるとし, $W$ は $V$ の任意の部分空間であるとする.
  このとき任意の線形写像 $f:W\to U$ に対してある線形写像 $g:V\to U$ 
  で $g$ の $W$ 上への制限が $f$ に等しいものが存在する.
  \qed
\end{question}

\begin{proof}[ヒント]
  $V$ の部分空間 $A$ と線形写像 $g:A\to U$ の組 $(A,g)$ 全体の集合
  に「写像の拡張になっているか否か」で順序関係を入れてZornの補題を適用せよ.
  \qed
\end{proof}

\begin{question}[10点]
  Zornの補題を用いて次を示せ. 
  $K$ は任意の体であり, $V$ は $K$ 上の任意のベクトル空間である
  とし, $W$ は $V$ の任意の部分空間であるとする.
  このとき $V$ のある部分空間 $W'$ で $V=W\oplus W'$ 
  (すなわち $V=W+W'$ かつ $W\cap W'=\{0\}$) を満たすものが存在する.
  \qed
\end{question}

\begin{proof}[ヒント]
  $V$ の部分空間 $W'$ で $W\cap W'=\{0\}$ を満たすもの全体の集合
  に包含関係で順序を入れ, Zornの補題を適用せよ.
  \qed
\end{proof}

\begin{rem}
  以上の結果は「ベクトル空間 $V$ の任意の一次独立な部分集合を $V$ の
  基底に拡張できる」というZornの補題を使って証明できる結果を使えば
  容易に証明できる.
  \qed
\end{rem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{直和と補空間}

有限次元とは限らないベクトル空間の基底の存在を用いて補空間の存在を証明しよう.

\begin{question}[直和, 5点]
  $K$ 上のベクトル空間 $V$ とその部分空間 $V_1,\ldots,V_N$ に関して以下の
  2条件は互いに同値である:
  \begin{enumerate}
  \item[(a)] 任意の $v\in V$ は $v=v_1+\cdots+v_N$, $v_i\in V_i$ と一意に表
    わされる.
  \item[(b)] 任意の $v\in V$ は $v=v_1+\cdots+v_N$, $v_i\in V_i$ と表わされ,
    任意の $v_i\in V_i$ ($i=1,\ldots,N$) に対して $v_1+\cdots+v_N=0$ な
    らば $v_i=0$ ($i=1,\ldots,N$) である.
  \end{enumerate}
  この同値な条件のどちらかが成立するとき, $V=V_1\oplus\cdots\oplus V_N$ と
  書き, $V$ は $V_1,\ldots,V_N$ の{\bf 直和 (direct sum)} であると言う.
  さらに各 $V_i$ が有限次元でかつ $V=V_1\oplus\cdots\oplus V_N$ ならば
  \begin{equation*}
    \dim V = \dim V_1 + \cdots + \dim V_N
  \end{equation*}
  が成立する. \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[補空間の存在, 10点]
  \label{q:complement}
  体 $K$ 上のベクトル空間 $U$ とその部分空間 $V$ に対して, $V$ の基底を $U$ 
  の基底に拡張できることを用いて, $U$ の部分空間 $W$ で $U=V\oplus W$ を満た
  すものが存在することを示せ. 
  そのような $W$ を $U$ における $V$ の
  {\bf (線形)補空間 (linear complement)} と呼ぶ.
  \qed
\end{question}

\begin{proof}[ヒント]
  $V$ の基底 $\{v_i\}_{i\in I}$ を $U$ の
  基底 $\{v_i\}_{i\in I}\cup\{w_j\}_{j\in J}$ に拡張して,
  $W$ を $\{w_j\}_{j\in J}$ で張られる $U$ の部分空間とする
  と $U=V\oplus W$ である.
  \qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{線形写像の行列表示}
\label{sec:matrix-rep}

$K$ は体であるとし, $U$, $V$ は $K$ 上の有限次元ベクトル空間であると
し, $f:U\to V$ は $K$ 上の任意の線形写像であるとする. 
線形写像 $f$ 自身は極めて抽象的な数学的対象であるが, $U$ と $V$ に
基底を定めることによって, $f$ を具体的に行列で表現することができる. 

$u_1,\ldots,u_n$ は $U$ の基底であり, $v_1,\ldots,v_m$ は $V$ の基底であると
する. このとき, 任意の $u\in U$, $v\in V$ は次のように一意に表わされる:
\begin{align*}
  &
  u 
  = \sum_{j=1}^n \alpha_j u_j 
  = \sum_{j=1}^n u_j \alpha_j
  =
  [u_1,\ldots,u_n]
  \begin{bmatrix}
    \alpha_1 \\
    \vdots \\
    \alpha_n \\
  \end{bmatrix}
  \qquad (\alpha_j\in K),
  \\ &
  v
  = \sum_{i=1}^m \beta_i v_i 
  = \sum_{i=1}^m v_i \beta_i 
  =
  [v_1,\ldots,v_m]
  \begin{bmatrix}
    \beta_1 \\
    \vdots \\
    \beta_m \\
  \end{bmatrix}
  \qquad (\beta_i\in K).
\end{align*}
これによって $u\in U$ と $\alpha=\tp{[\alpha_1,\ldots,\alpha_n]}\in K^n$ が
一対一に対応し, $v\in V$ と $\beta=\tp{[\beta_1,\ldots,\beta_m]}\in K^m$ が
一対一に対応する.
この対応を用いて, 線形写像 $f:U\to V$ と
行列 $A=[a_{ij}]\in M_{m,n}(K)$ の一対一対応を構成可能であることを
説明しよう.

まず, 各 $f(u_j)\in V$ は
\begin{equation*}
  f(u_j)
  = \sum_{i=1}^m a_{ij} v_i 
  = \sum_{i=1}^m v_i a_{ij}
  =
  [v_1,\ldots,v_m]
  \begin{bmatrix}
    a_{1j} \\
    \vdots \\
    a_{mj} \\
  \end{bmatrix}
  \qquad (a_{ij}\in K)
\end{equation*}
と一意に表わされるので,
\begin{equation*}
  [f(u_1),\ldots,f(u_n)] 
  =
  [v_1,\ldots,v_m]
  \begin{bmatrix}
    a_{11} & \cdots & a_{1n} \\
    \vdots &        & \vdots \\
    a_{m1} & \cdots & a_{mn} \\
  \end{bmatrix}.
\end{equation*}
よって
\begin{align*}
  f(u)
  &
  = \sum_{j=1}^n \alpha_j f(u_j)
  = \sum_{j=1}^n f(u_j) \alpha_j
  \\ &
  =
  [f(u_1),\ldots,f(u_n)]
  \begin{bmatrix}
    \alpha_1 \\
    \vdots \\
    \alpha_n \\
  \end{bmatrix}
  =
  [v_1,\ldots,v_m]
  \begin{bmatrix}
    a_{11} & \cdots & a_{1n} \\
    \vdots &        & \vdots \\
    a_{m1} & \cdots & a_{mn} \\
  \end{bmatrix}
  \begin{bmatrix}
    \alpha_1 \\
    \vdots \\
    \alpha_n \\
  \end{bmatrix}.
\end{align*}
以上の記号のもとで線形写像 $f$ は
\begin{equation*}
  [u_1,\ldots,u_n]
  \begin{bmatrix}
    \alpha_1 \\
    \vdots \\
    \alpha_n \\
  \end{bmatrix}
  \in U
  \ \text{を}\ %
  [v_1,\ldots,v_m]
  \begin{bmatrix}
    a_{11} & \cdots & a_{1n} \\
    \vdots &        & \vdots \\
    a_{m1} & \cdots & a_{mn} \\
  \end{bmatrix}
  \begin{bmatrix}
    \alpha_1 \\
    \vdots \\
    \alpha_n \\
  \end{bmatrix}
  \in V
  \ \text{に}
\end{equation*}
対応させる写像に等しい.
以上のようにして線形写像 $f$ に対応する行列 $A=[a_{ij}]$ が得られる.
逆に行列 $A=[a_{ij}]$ が与えられれば上の対応によって
線形写像 $f:U\to V$ が得られることもわかる.
行列 $A=[a_{ij}]$ を線形写像 $f$ の基底 $u_j$, $v_i$ に
関する{\bf 行列表示}と呼ぶことにする.

\begin{summary}[線形写像の行列表示]
  $U$ の基底 $u_1,\ldots,u_n$ と $V$ の基底 $v_1,\ldots,v_m$ に関する
  線形写像 $f:U\to V$ の行列表示 $A=[a_{ij}]\in M_{m,n}(K)$ は次の条件に
  よって一意に決定される%
  \footnote{定義域の基底を横に並べたものに $f$ を左から作用
    させて, 右側にポコッと出て来る行列 $A=[a_{ij}]$ を計算すれば
    線形写像 $f$ の行列表示が得られる.}:
  \begin{equation*}
    [f(u_1),\ldots,f(u_n)]
    = [v_1,\ldots,v_m]
    \begin{bmatrix}
    a_{11} & \cdots & a_{1n} \\
    \vdots &        & \vdots \\
    a_{m1} & \cdots & a_{mn} \\
    \end{bmatrix}.
  \end{equation*}
  この条件は次と同値である:
  \begin{equation*}
    f(u_j)
    = \sum_{i=1}^m a_{ij} v_i
    = \sum_{i=1}^m v_i a_{ij}
    \qquad (j=1,\ldots,n).
  \qed
  \end{equation*}
\end{summary}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[5点]
  $U=\R^3$, $V=\R^2$ とし, 行列 
  \begin{equation*}
    A = 
    \begin{bmatrix}
      1 & 2 & 3 \\
      2 & 3 & 4 \\
    \end{bmatrix}
  \end{equation*}
  の積の定める $U$ から $V$ への線形写像を $f$ と書くことにする
  (すなわち $f(u)=Au$ ($u\in U=\R^3$)).
  $u_1,u_2,u_3\in U$ と $v_1,v_2\in V$ を次のように定める:
  \begin{equation*}
    u_1 =
    \begin{bmatrix}
      1 \\ 0 \\ 0 \\
    \end{bmatrix},
    \quad
    u_2 =
    \begin{bmatrix}
      0 \\ 1 \\ 0 \\
    \end{bmatrix},
    \quad
    u_3 =
    \begin{bmatrix}
      1 \\ -2 \\ 1 \\
    \end{bmatrix},
    \qquad
    v_1 =
    \begin{bmatrix}
      1 \\ 2 \\
    \end{bmatrix},
    \quad
    v_2 =
    \begin{bmatrix}
      2 \\ 3 \\
    \end{bmatrix}.
  \end{equation*}
  このとき, $u_1,u_2,u_3$ は $U$ の基底であり, $v_1,v_2$ は $V$ の基底で
  あり, それらに関する $f$ の行列表示を $B$ とすると, $B$ は
  \begin{equation*}
    B =
    \begin{bmatrix}
      1 & 0 & 0 \\
      0 & 1 & 0 \\
    \end{bmatrix}
  \end{equation*}
  と簡単な形になることを示せ. \qed
\end{question}

\begin{proof}[ヒント]
  $[f(u_1),f(u_2),f(u_3)]=[v_1,v_2]B$ を示せ.
  $[f(u_1),f(u_2),f(u_3)]=[Au_1,Au_2,Au_3]=A[u_1,u_2,u_3]$ 
  なので $A[u_1,u_2,u_3]=[v_1,v_2]B$ が成立することを
  直接的な計算で示せばよい.
  というわけでこの問題は非常に簡単な問題である.
  \qed
\end{proof}

%\begin{rem}[行列の基本変形との関係]
%  上のような問題の作り方は問題 \qref{q:PAQ} を理解すればわかる. \qed
%\end{rem}

\begin{rem}[標準的な基底以外のより適切な基底を見付けることの重要性]
  上の問題のように行列 $A$ 自身は複雑な形をしていても,
  標準的な基底とは別の基底に関して行列表示し直すと
  簡単な形になることがよくある.
  与えられた線形写像の本質を見極めるためには
  適切な基底を見付けて行列表示してみることが役に立つ.

  実は行列の基本変形や(後で習うことになっている)行列の対角化
  や Jordan 標準形の理論はどれも「行列もしくは線形写像の本質を見極める
  ために役に立つ基底の見付け方に関する理論」とみなせる.
  \qed
\end{rem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[5点]
  \label{q:A->A}
  $K$ は体であるとし, $m\times n$ 行列 $A\in M_{m,n}(K)$ を任意に取る.
  $K^l$ の標準的基底を $e^{(l)}_1,\ldots,e^{(l)}_l$ と書くことにする.
  すなわち $e^{(l)}_i\in K^l$ は第 $i$ 成分のみが $1$ で
  他の成分は $0$ であるとする.
  基底 $e^{(n)}_j$, $e^{(m)}_i$ に関する $A$ の定める
  線形写像 $A:K^n\to K^m$ の行列表示は $A$ 自身に等しい.
  \qed
\end{question}

\begin{proof}[ヒント]
  $[Ae^{(n)}_1,\ldots,Ae^{(n)}_n]=[e^{(m)}_1,\ldots,e^{(m)}_m]A$ を示せばよい
  がほとんど自明である. \qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[10点]
変数 $x$ に関する複素係数1変数多項式環 $\C[x]$ の
部分空間 $V$ 
\begin{equation*}
  V=\{\,f\in\C[x]\mid \text{$f$ の次数は $3$ 以下}\,\}
\end{equation*}
と定め, 線形写像 $T:V\to V$ を
\begin{equation*}
  Tf(x) = f(x+1)\qquad (f\in V)
\end{equation*}
と定める. このとき以下を計算せよ:
\begin{enumerate}
\item $V$ の基底 $(v_0,v_1,v_2,v_3)=(1,x,x^2,x^3)$ 
  に関する $T$ の行列表現.
\item $V$ の別の基底
  \begin{equation*}
    (u_0,u_1,u_2,u_3) = 
    \left( 1, x, \frac{x(x-1)}{2}, \frac{x(x-1)(x-2)}{6} \right) 
  \end{equation*}
  に関する $T$ の行列表現.
  \qed
\end{enumerate}
\end{question}

\begin{proof}[ヒント]
1. 基底 $(v_0,v_1,v_2,v_3)$ に関する $T$ の行列表現とは
\begin{equation*}
  [Tv_0, Tv_1, Tv_2, Tv_3] = [v_0,v_1,v_2,v_3]A 
\end{equation*}
を満たす行列 $A$ のことである. 
2についても同様であるが, 
二項係数に関する Pascal の三角形(の一般化)との関係に
気付けば簡単に計算できる.
\qed
\end{proof}

\commentout{
\begin{proof}[略解]
 小問1, 2の解答はそれぞれ次の行列になる:
 \begin{equation*}
  \begin{bmatrix}
   1 & 1 & 1 & 1 \\
   0 & 1 & 2 & 3 \\
   0 & 0 & 1 & 3 \\
   0 & 0 & 0 & 1 \\
  \end{bmatrix},
  \quad
  \begin{bmatrix}
   1 & 1 & 0 & 0 \\
   0 & 1 & 1 & 0 \\
   0 & 0 & 1 & 1 \\
   0 & 0 & 0 & 1 \\
  \end{bmatrix}.
 \end{equation*}
 $k=0,1,2,\ldots$ に対して $x$ の多項式 $\binom{x}{k}\in\Q[x]$ を
 \begin{equation*}
  \binom{x}{k} = \frac{x(x-1)(x-2)\cdots(x-k+1)}{k!}
 \end{equation*}
 と定めると
 \begin{equation*}
  \binom{x}{0}=1, \quad
  \binom{x}{1}=x, \quad
  \binom{x}{2}=\frac{x(x-1)}{2}, \quad
  \binom{x}{3}=\frac{x(x-1)(x-2)}{6}
 \end{equation*}
 であり, 次の Pascal の三角形の公式が成立している:
 \begin{equation*}
  \binom{x+1}{k}=\binom{x}{k-1}+\binom{x}{k}.
 \qed
 \end{equation*}
\end{proof}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[基底の変換, 5点]
  \label{q:P^{-1}AQ}
  $K$ は体であるとし, $U$, $V$ は $K$ 上の有限次元ベクトル空間で
  あり, $u_1,\ldots,u_n$ は $U$ の基底であり, $v_1,\ldots,v_m$ は $V$ の基底
  であるとする.  $f:U\to V$ は線形写像であり, $A\in M_{m,n}(K)$ は
  基底 $u_j$, $v_i$ に関する $f$ の行列表示であるとする.
  $u'_1,\ldots,u'_n$ と $v'_1,\ldots,v'_m$ はそれぞれ $U$, $V$ の
  別の基底であるとする.  以下を示せ.
  \begin{enumerate}
  \item ある可逆な行列 $Q\in GL_n(K)$, $P\in GL_m(K)$ で%
    \footnote{$GL_n(K)$ は $K$ の元を成分に持つ可逆な $n\times n$ 行列全体の
      集合である.  $GL_n(K)$ は群をなし, 一般線形群と呼ばれる.}
    \begin{equation*}
      [u'_1,\ldots,u'_n]=[u_1,\ldots,u_n]Q,
      \qquad
      [v'_1,\ldots,v'_m] = [v_1,\ldots,v_m]P
    \end{equation*}
    をみたすものが一意に存在する.
  \item 基底 $u'_j$, $v'_i$ に関する $f$ の行列表示は $P^{-1}AQ$ になる.
    \qed
  \end{enumerate}
\end{question}

\begin{proof}[ヒント]
  2. $[f(u'_1),\ldots,f(u'_n)]=[v'_1,\ldots,v'_m]P^{-1}AQ$ を 1 を用いて示せ
  ばよい. \qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[5点]
  $K$ は体であるとし, 
  $u_1,\ldots,u_n\in K^n$ は $K^n$ の基底であり, 
  $v_1,\ldots,v_m\in K^m$ は $K^m$ の基底であるとし,
  $Q=[u_1,\ldots,u_n]\in M_n(K)$, $P=[v_1,\ldots,v_m]\in M_m(K)$ とおく.
  このとき, $m\times n$ 行列 $A\in M_{m,n}(K)$ の定める
  線形写像 $A:K^n\to K^m$ の
  基底 $u_j$, $v_i$ に関する行列表示は $P^{-1}AQ$ になる.
  \qed
\end{question}

\begin{proof}[ヒント]
  問題 \qref{q:A->A}, \qref{q:P^{-1}AQ} からただちに得られる.
  もしくは $[Au_1,\ldots,Au_n]=AQ=PP^{-1}AQ=[v_1,\ldots,v_m]P^{-1}AQ$. 
  \qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[5点]
  \label{q:9,-2,-2,6}
  $V=\R^2$ とし, 行列
  \begin{equation*}
    A = \frac{1}{5}
    \begin{bmatrix}
      9 & -2 \\
      -2 & 6 \\
    \end{bmatrix}
  \end{equation*}
  が定める $V$ からそれ自身への線形写像を $f$ と書くことにする.
  $v_1,v_2\in V$ を
  \begin{equation*}
    v_1 = % \frac{1}{\sqrt{5}} 
    \begin{bmatrix} 1 \\ 2 \\ \end{bmatrix},
    \quad
    v_2 = % \frac{1}{\sqrt{5}} 
    \begin{bmatrix} -2 \\ 1 \\ \end{bmatrix}
  \end{equation*}
  と定めると, $v_1,v_2$ は $V$ の基底である
  ($v_1$, $v_2$ を平面上の図示せよ).
  基底 $v_i$ に関する $f$ の行列表示を求めよ.
  \qed
\end{question}

\begin{proof}[ヒント]
  $[f(v_1),f(v_2)]=[v_1,v_2]B$ を満たす行列 $B\in M_2(\R)$ が答である.
  \qed
\end{proof}

\commentout{
\begin{proof}[略解]
  $Av_1=v_1$, $Av_2=2v_2$ なので $B=\diag(1,2)$. \qed
\end{proof}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[10点]
  \label{q:9,-2,-2,6-ODE}
  問題 \qref{q:9,-2,-2,6} の結果を用いて,
  次の常微分方程式の初期値問題を解け:
  \begin{equation*}
    \od{t}u = Au, \qquad u(0) = u_0.
  \end{equation*}
  ここで $u$ は $t\in\R$ の $V=\R^2$ に値を持つ函数で
  あり, $u_0 = e_2 = \tp{[0,1]}$.
  \qed
\end{question}

\begin{proof}[ヒント]
  まず今まで渡したプリントの「行列の指数函数」に関する説明を読め.
  $P = [v_1,v_2]$ と置くと $A=PBP^{-1}$ であるから,
  \begin{equation*}
    e^{tA} = Pe^{tB}P^{-1}.
  \end{equation*}
  実は $B$ は対角行列になるので $e^{tB}$ は容易に計算される.
  その結果を用いて $u(t) = e^{tA}u_0$ を整理したものが答になる.
  \qed
\end{proof}

\commentout{
\begin{proof}[略解]
  $e^{tB}=\diag(e^t,e^{2t})$ であり, 
  $P=
  \begin{bmatrix}
    1 & -2 \\
    2 & 1 \\
  \end{bmatrix}$, $P^{-1}=\dfrac{1}{5}
  \begin{bmatrix}
    1 & 2 \\
    -2 & 1 \\
  \end{bmatrix} = \dfrac{1}{5}\tp{P}$ なので
  \begin{equation*}
    e^{tA} 
    = Pe^{tA}P^{-1}
    = \frac{1}{5}
  \begin{bmatrix}
    1 & -2 \\
    2 & 1 \\
  \end{bmatrix}
  \begin{bmatrix}
    e^t & 0 \\
    0 & e^{2t} \\
  \end{bmatrix}
  \begin{bmatrix}
    1 & 2 \\
    -2 & 1 \\
  \end{bmatrix}
  =
  \frac{1}{5}
  \begin{bmatrix}
    e^t + 4e^{2t}  & 2e^t - 2e^{2t} \\
    2e^t - 2e^{2t} & 4e^t + e^{2t} \\
  \end{bmatrix}.
  \end{equation*}
  よって $u(t) = e^{tA}u_0 = e^{tA}e_2 = \dfrac{1}{5}
  \begin{bmatrix}
    2e^t - 2e^{2t} \\
    4e^t + e^{2t} \\
  \end{bmatrix}$. \qed
\end{proof}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[一次変換の対角化, 10点]
  $V$ は体 $K$ 上のベクトル空間であり, $f$ は $V$ の一次変換 (すなわち $V$ 
  からそれ自身への線形写像) であるとする. もしも $V$ の
  基底 $v_1,\ldots,v_n$ が $f(v_i)=\alpha_i v_i$ ($\alpha_i\in K$) を
  満たしているならば, 基底 $v_i$ に関する $f$ の行列表示
  は対角行列 $D=\diag(\alpha_1,\ldots,\alpha_n)$ になる.
  \qed
\end{question}

\begin{proof}[ヒント]
  $[f(v_1),\ldots,f(v_n)]=[v_1,\ldots,v_n]D$ を示せばよいので簡単である.
  \qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[巡回行列とその行列式, 20点]
  $n\times n$ 行列 $\Lambda$ を次のように定める:
  \begin{equation*}
    \Lambda = 
    \begin{bmatrix}
      0 & 1 &   & & \bigzerou \\
        & 0 & 1 & & \\
        &   & 0 & \ddots & \\
        &   &   & \ddots & 1 \\
      1 &   &   &        & 0 \\
    \end{bmatrix}
    =
    E_{12} + E_{23} + \cdots + E_{n-1,n} + E_{n,1}
    \in M_n(\C).
  \end{equation*}
  ここで $E_{ij}$ は行列単位 (第 $(i,j)$ 成分だけが $1$ で他の成分が
  すべて $0$ であるような行列) である.
  $\zeta = e^{2\pi i/n}$ ($1$ の原始 $n$ 乗根) とおき,
  \begin{equation*}
    v_k =
    \begin{bmatrix}
      1 \\ \zeta^k \\ \zeta^{2k} \\ \vdots \\ \zeta^{(n-1)k} \\
    \end{bmatrix}
    \in \C^n
    \qquad (k\in\Z)
  \end{equation*}
  とおく.  このとき以下が成立する:
  \begin{enumerate}
  \item $\Lambda^k\ne E$ ($k=1,\ldots,n-1$), $\Lambda^n=E$.
  \item $\Lambda v_k = \zeta^k v_k$ ($k\in\Z$).
  \item $v_0,v_1,\ldots,v_{n-1}$ は $\C^n$ の基底である.
  \item 基底 $v_0,v_1,\ldots,v_{n-1}$ に関する $\Lambda$ の
    定める $\C^n$ の一次変換の行列表示は
    対角行列 $D=\diag(1,\zeta,\zeta^2,\ldots,\zeta^{n-1})$ になる.
  \item $P=[v_0,v_1,\ldots,v_{n-1}]\in M_n(\C)$ と
    おくと, $P$ は可逆であり, $\Lambda = PDP^{-1}$.
  \item $X=x_0 E+x_1\Lambda+x_2\Lambda^2+\cdots+x_{n-1}\Lambda^{n-1}$ とおく
    と, 
    \begin{equation*}
      \det X = 
      \prod_{k=0}^{n-1}
      (x_0+x_1\zeta^k+x_2\zeta^{2k}+\cdots+x_{n-1}\zeta^{(n-1)k}).
      \qed
    \end{equation*}
  \end{enumerate}
\end{question}

\begin{proof}[ヒント]
%  実は上の問題は問題 \qref{q:cyclic-det} のヒント2の方針を
%  より詳しくしたものである. 
  3. $|P|\ne 0$ を Vandermonde の行列式の公式を用いて示せばよい.\\
  4. $[\Lambda v_0,\Lambda v_1,\ldots,\Lambda v_{n-1}]
  =[v_0,v_1,\ldots,v_{n-1}]D$ を示せばよい.\\
  6. $X=P(x_0 E+x_1 D+x_2 D^2+\cdots+x_{n-1}D^{n-1})P^{-1} 
  =P\diag(x_0+x_1\zeta^k+x_2\zeta^{2k}
  +\cdots+x_{n-1}\zeta^{(n-1)k})_{k=0}^{n-1}P^{-1}$.
  \qed
\end{proof}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[複素数の実行列表示, 5点]
  \label{q:hatz}
  複素数体 $\C$ は自然に実数体 $\R$ 上の $2$ 次元のベクトル空間とみなせ%
  \footnote{「複素平面」という言葉は複素数全体の集合が
    実数体上 $2$ 次元のベクトル空間をなすことを含意している.}, %
  $1$, $i$ は $\C$ の $\R$ 上の基底である. $z=x+iy\in\C$ ($x,y\in\R$) に
  対して, 写像 $\hat{z}:\C\to\C$ を
  \begin{equation*}
    \hat{z}(w) := zw \qquad (w\in\C)
  \end{equation*}
  と定めると, $\hat{z}$ は $\R$ 上の線形写像である.  基底 $1,i$ に
  関する $\hat{z}$ の行列表示を $A(z)\in M_2(\R)$ と書くと,
  \begin{equation*}
    A(z) = A(x+iy) =
    \begin{bmatrix}
      x & -y \\
      y & x \\
    \end{bmatrix}.
    \qed
  \end{equation*}
\end{question}

\begin{proof}[ヒント]
  $[z1,zi]=[1,i]A(z)$ を示せばよいだけなので非常に簡単である.
  \qed
\end{proof}

%\begin{rem}
%  上の問題 \qref{q:hatz} の $A(z)$ は問題 \qref{q:C->M2(R)} の $A(z)$ に等し
%  い.  
%  さらに $\theta\in\R$ のとき $A(e^{i\theta})$ は
%  \secref{sec:rotation-matrix}の回転行列 $R(\theta)$ に等しい.
%  このように, 今までに登場した特殊な行列の多くは
%  自然に得られる線形写像の行列表示に等しくなる.
%  \qed
%\end{rem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[5点]
  \label{q:C->M2(R)}
  複素数 $z = x + iy\in\C$ ($x,y\in\R$) に対して実2次正方行列 $A(z)=A(x+iy)$ 
  を次のように定める:
  \begin{equation*}
    A(z) = A(x+iy) :=
    \begin{bmatrix}
      x & -y \\
      y &  x \\
    \end{bmatrix}.
  \end{equation*}
  このとき $z,w\in\C$ に対して次が成立する:
  \begin{align*}
    &
    A(z+w) = A(z) + A(w), \qquad
    A(zw) = A(z)A(w), \qquad
    A(1) = E;
    \\ &
    \det A(z) = |z|^2, \qquad
    \trace A(z) = 2\Repart z, \qquad
    e^{A(z)} = A(e^z).
    \qed
  \end{align*}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[ベクトル積の定義, 15点]
  \label{q:def-vp}
  $\R^3$ の2つのベクトル $u=\tp{[u_1,u_2,u_3]}$, $v=\tp{[v_1,v_2,v_3]}$ 
  の{\bf ベクトル積 (vector product)} $u\times v$ を次のように定義する:
  \begin{equation*}
    u\times v :=
    \begin{bmatrix}
      u_2 v_3 - u_3 v_2 \\
      u_3 v_1 - u_1 v_3 \\
      u_1 v_2 - u_2 v_1 \\
    \end{bmatrix}.
  \end{equation*}
  このとき以下が成立する:
  \begin{enumerate}
  \item 第 $i$ 成分だけが $1$ で他の成分が $0$ であるような $3$ 次元縦ベクト
  ルを $e_i$ と書くと,
  \begin{align*}
    &
    e_i \times e_j = e_k, \quad  e_j \times e_i = -e_k
    \qquad \bigl((i,j,k)=(1,2,3),(2,3,1),(3,1,2)\bigr),
    \\ &
    e_i\times e_i = 0 \qquad (i=1,2,3).
  \end{align*}
  \item ベクトル $u=\tp{[u_1,u_2,u_3]}$ に対して行列 $X(u)$ を次のように定める:
    \begin{equation*}
      X(u) =
      \begin{bmatrix}
         0   &  u_1 & u_3 \\
        -u_1 &  0   & u_2 \\
        -u_3 & -u_2 & 0   \\
      \end{bmatrix}.
    \end{equation*}
    さらに行列 $A$, $B$ の{\bf 交換子 (commutator)} $[A,B]$ を
    次のように定義する:
    \begin{equation*}
      [A,B] = AB - BA.
    \end{equation*}
    このとき $u,v\in\R^3$ に対して
    \begin{equation*}
      [X(u), X(v)] = X(u\times v).
    \end{equation*}
  \item ベクトル $u=\tp{[u_1,u_2,u_3]}$ に対して行列 $Y(u)$ を次のように定める:
    \begin{equation*}
      Y(u) = -\frac{i}{2}(u_1\sigma_1 + u_2\sigma_2 + u_3\sigma_3).
    \end{equation*}
    ここで $\sigma_1$, $\sigma_2$, $\sigma_3$ は次のように定義
    される {\bf Pauli 行列}と呼ばれる行列である:
    \begin{equation*}
      \sigma_1=
      \begin{bmatrix}
        0 & 1 \\
        1 & 0 \\
      \end{bmatrix},
      \quad
      \sigma_2=
      \begin{bmatrix}
        0 & -i \\
        i & 0 \\
      \end{bmatrix},
      \quad
      \sigma_3=
      \begin{bmatrix}
        1 & 0 \\
        0 & -1 \\
      \end{bmatrix}.
    \end{equation*}
    このとき $u,v\in\R^3$ に対して
    \begin{equation*}
      [Y(u), Y(v)] = Y(u\times v).
    \end{equation*}
  \item $u,v,w\in\R^3$ に対して以下が成立している%
    \footnote{ヒント: $n$ 次正方行列 $A,B,C$ に
      対して $[[A,B],C]=[A,[B,C]]-[B,[A,C]]$ が成立している.
      これを交換子の {\bf Jacobi 律}と呼ぶ.}:
    \begin{equation*}
      v\times u = - u\times v,
      \qquad
       (u\times v)\times w = u\times(v\times w) - v\times(u\times w).
    \end{equation*}
  \item ベクトル積は行列式を用いて形式的に次のように表わされる:
    \begin{equation*}
      u\times v =
      \begin{vmatrix}
        u_1 & v_1 & e_1 \\
        u_2 & v_2 & e_2 \\
        u_3 & v_3 & e_3 \\
      \end{vmatrix}.
    \end{equation*}
    この等式は「右辺の形式的な行列式の第 $3$ 列に関する形式的な
    余因子展開が左辺に等しい」と読む. \qed
  \end{enumerate}
\end{question}

\begin{guide}
  上の問題の 2 と 3 はもちろん偶然ではない.
  実はベクトル積は3次元 Euclid 空間の(無限小)回転を表現しているのである.
  実は上の問題は3次元 Euclid 空間の回転の表現の仕方には様々な方法があること
  を示していることになっている.

  力学の教科書で回転運動の章を見るとベクトル積が登場する.
  それは回転運動を数学的に表現するためである.
  また量子物理の教科書を読むと Pauli 行列がよく登場する.
  それは我々が住んでいる物理的な3次元空間の回転対称性を表現するためである.

  実は上の問題の 3 は {\bf Hamilton の四元数体 (quaternion)}と関係している.
  四元数体とは複素数をさらに拡張した非可換体であり, 実数体に $i,j,k$ で
  \begin{equation*}
    i^2=j^2=k^2=-1, \qquad ij=-ji=k, \quad jk=-kj=i, \quad ki=-ik=j    
  \end{equation*}
  を満たすものを付け加えることによって構成される. 
  $I=-i\sigma_1,J=-i\sigma,K=-i\sigma_3$ は $i,j,k$ の満たすべき公式と
  同じ公式を満たしている.
  したがって, 複素数が実 $2$ 次正方行列で表現できたように
  (問題 \qref{q:C->M2(R)} を見よ), 四元数は複素 $2$ 次正方行列で表現できる.
  \qed
\end{guide}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[ベクトル積と平行四辺形の面積, 15点]
  \label{q:|det|=vecArea}
  上の問題の続き. 
  $\R^3$ 内で原点 $0$ と $u$ を結ぶ
  線分, $u$ と $u+v$ を結ぶ線分, $u+v$ と $v$ を結ぶ線分 $v$ と $0$ を
  結ぶ線分で囲まれた平行四辺形を考える.
  このとき $u\times v$ はその平行四辺形に垂直に
  なり, $u\times v$ の長さはその平行四辺形の面積に等しくなる.
  \qed
\end{question}

\begin{proof}[ヒント]
  $u\times v$ と $u$, $v$ の内積が $0$ になることが
  問題 \qref{q:def-vp} におけるベクトル積の定義もしくは 5 の表示から導かれる.
  平行四辺形の面積との関係については
  平行四辺形の面積が $\norm{u}\,\norm{v}\,\sin\theta$ であることを使え.
  ここで $\theta$ は $u$ と $v$ のあいだの角度である.
  \qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[Hamilton の四元数の行列表示, 10点]
  $1,i,j,k$ を基底に持つ $\R$ 上のベクトル空間
  \begin{equation*}
    \bH = \{\, a1 + bi + cj + dk \mid a,b,c,d\in\R \,\}
  \end{equation*}
  に積を次の規則で定める:
  \begin{align*}
    &
    1^2=1, \quad
    1i=i1=i, \quad 1j=j1=j, \quad 1k=k1=k, \quad 
    \\ &
    i^2=j^2=k^2=-1, \quad
    ij=-ji=k, \quad jk=-kj=i, \quad ki=-ik=j.
  \end{align*}
  このとき $\bH$ の元を {\bf Hamilton の四元数 (quaternion)} と呼ぶ.
  $a,b\in\R$ のとき四元数 $a1+bi\in\bH$ と複素数 $a+bi\in\C$ を同一視する
  ことにする.
  $q = a1 + bi + cj + dk\in\bH$ ($a,b,c,d\in\R$) と置く.
  写像 $\hat{q}:\bH\to\bH$ を
  \begin{equation*}
    \hat{q}(r) = qr \qquad (r\in\bH)
  \end{equation*}
  と定めると, $\hat{q}$ は $\R$ 上の一次変換である.  このとき以下が成立する.
  \begin{enumerate}
  \item $\R$ 上の基底 $1,i,j,k$ に関する $\hat{q}$ の
    行列表示を $A(q)$ と書くと,
    \begin{equation*}
      A(q) = 
      \left[
      \begin{array}{rrrr}
        a & -b & -c & -d \\
        b &  a & -d &  c \\
        c &  d &  a & -b \\
        d & -c &  b &  a \\
      \end{array}
      \right].
    \end{equation*}
  \item $z=a+bi$, $w=c+di$, $a,b,c,d\in\R$ とすると, $q=z1+wj=1z+j\cc{w}$ である
    から,  $\bH$ は $1,j$ を基底に持つ $\C$ 上の $2$ 次元のベクトル空間と
    みなされる.  
    ただし $\C$ の元による右からの掛け算によって $\bH$ に $\C$ 上のベクトル空間
    の構造を入れておくものとする.
    このとき $\hat{q}$ は $\C$ 上の一次変換になる(この事実も証明せよ).
    $\C$ 上の基底 $1,j$ に関する $\hat{q}$ の行列表示を $B(q)$ と書くと,
    \begin{equation*}
      B(q) = 
      \begin{bmatrix}
        z       & -w \\
        \bar{w} & \bar{z} \\
      \end{bmatrix}.
    \end{equation*}
    ここで $\bar{z},\bar{w}$ はそれぞれ $z,w$ の複素共役である. \qed
  \end{enumerate}
\end{question}

\begin{proof}[ヒント]
  1. $[q1,qi,qj,qk]=[1,i,j,k]A(q)$ を示せばよい.
  2. $[q1,qj]=[1,j]B(q)$ を示せばよい. $zj=j\bar{z}$ を用いよ.
  \qed
\end{proof}

\begin{guide}
  問題 \qref{q:def-vp} で定義された Pauli 行列 $\sigma_1,\sigma_2,\sigma_3$ 
  と四元数の複素 $2\times 2$ 行列表現 $B(q)$ のあいだには %
  $B(i)=i\sigma_3$, $B(j)=-i\sigma_2$, $B(k)=-i\sigma_1$ という関係がある.
  したがって, $\pm i$ 倍と順序の違いを除けば Pauli 行列と四元数 $i,j,k$ の
  複素 $2\times 2$ 行列表示は本質的に一致する.
  \qed
\end{guide}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[15点]
  \label{q:sl2-1}
  問題 \qref{q:polyn-diff-op} の記号をそのまま用いる.
  $v_i = x^i$ と置く.
  任意に $\lambda\in\C$ を取り,
  $\C[x]$ の一次変換 $e,f,h$ を
  \begin{equation*}
    e = \d, \quad
    h = -2x\d+\lambda, \quad
    f = -x^2\d+\lambda x
  \end{equation*}
  と定める. このとき以下が成立している:
  \begin{enumerate}
  \item   $hv_i = (\lambda - 2i)v_i$, 
    \quad $ev_i = i v_{i-1}$, 
    \quad $fv_i = (\lambda - i)v_{i+1}$.
  \item 特に \quad $hv_0=\lambda v_0$, \quad $ev_0=0$.
  \item $[h,e]=2e$, \quad $[h,f]=-2f$, \quad $[e,f]=h$.
  \end{enumerate}
  ここで $[A,B] = AB-BA$ (交換子)である. \qed
\end{question}

\begin{proof}[ヒント]
  たとえば 
  \begin{equation*}
    fv_4 
    = (-x^2\d+\lambda x)(x^4)
    = -x^2(x^4)' + \lambda x\cdot x^4
    = -4x^5+\lambda x^5 
    = (\lambda - 4)x^5
    = (\lambda - 4)v_5.
  \end{equation*}
  3の計算は
  交換子に関する一般的な公式 
  \begin{align*}
    &
    [A,A]=0, \quad [B,A]=-[A,B],
    \\ &
    [AB,C]=[A,C]B+A[B,C], \quad [A,BC]=[A,B]C+B[A,C]
  \end{align*}
  と $[\d,x^i]=ix^{i-1}$ を用いて実行せよ. たとえば
  \begin{equation*}
    [\d, -x^2\d] = -[\d,x^2]\d -x^2[\d,\d] = -2x\d -x^2 0 = -2x\d.
    \qed
  \end{equation*}
\end{proof}

\begin{guide}[$\lie{sl}_2$-triplet]
  $2\times 2$ 行列 $E,F,H$ を
  \begin{equation*}
    E = 
    \begin{bmatrix}
      0 & 1 \\
      0 & 0 \\
    \end{bmatrix},
    \quad
    F = 
    \begin{bmatrix}
      0 & 0 \\
      1 & 0 \\
    \end{bmatrix},
    \quad
    H =
    \begin{bmatrix}
      1 & 0 \\
      0 & -1 \\
    \end{bmatrix}
  \end{equation*}
  と定めると
  \begin{equation*}
    [H,E]=2e, \quad [H,F]=-2F, \quad [E,F]=H
  \end{equation*}
  が成立している.  $E,F,H$ を $\lie{sl}_2$-triplet ($\lie{sl}_2$ の三つ組)
  と呼ぶ.  上の問題 \qref{q:sl2-1} の $e,f,h$ は多項式係数の微分作用素に
  よる $\lie{sl}_2$-triplet の表現になっている.
  
  Lie 代数 $\lie{sl}_2(\C)$ の有限次元表現論は $3$ 次元空間の回転を
  司る Lie 群 $SU(2)$ の表現論と同値である.
  Lie 群および Lie 代数の表現論に関する
  入門的な解説は山内・杉浦 \cite{YS} にある.
  \qed
\end{guide}

\begin{question}[15点]
  \label{q:sl2-2}
  問題 \qref{q:sl2-1} の続き.
  $\lambda=\ell\in\Z_{\ge0}$ と仮定する. 以下を示せ:
  \begin{enumerate}
  \item $\ell$ 次以下の一変数多項式全体のなす $\C[x]$ の部分集合を $V_\ell$ 
    と書くことにする:
    \begin{equation*}
      V_\ell 
      = \{\, a_0 + a_1x + x_2x^2 + \cdots + a_\ell x^\ell
      \mid a_0,a_1,\ldots,a_\ell\in\C \,\}.
    \end{equation*}
    このとき $V_\ell$ は $\C[x]$ の部分空間であり, 
    \begin{equation*}
      v_0 = 1, \quad
      v_1 = x, \quad
      v_2 = x^2, \quad
      \ldots, \quad
      v_\ell = x^\ell
    \end{equation*}
    は $V_\ell$ の基底をなす.
  \item $e,f,h$ の $\C[x]$ への作用は $V_\ell$ を保つ.
    すなわち, 任意の $v\in V_\ell$ に対して $ev,fv,hv\in V_\ell$.
  \item $e,f,h$ の定める $V_\ell$ の一次変換の基底 $v_i$ に関する行列表示
    をそれぞれ $E_\ell,F_\ell,H_\ell$ と書くと,
    \begin{align*}
      &
      E_\ell =
      \begin{bmatrix}
        0 & 1 &   & & \bigzerou \\
          & 0 & 2 & & \\
          &   & 0 & \ddots & \\
          &   &   & \ddots & \ell \\
        \bigzerol & & &    & 0 \\
      \end{bmatrix},
      \qquad
      F_\ell =
      \begin{bmatrix}
        0    & & & & \bigzerou \\
        \ell &    0   & & & \\
             & \ell-1 & 0      & & \\
             &        & \ddots & \ddots & \\
        \bigzerol & &          &    1   & 0 \\
      \end{bmatrix},
      \\ &
      H_\ell =
      \begin{bmatrix}
        \ell & & & & \bigzerou \\
             & \ell-2 & & & \\
             &        & \ddots & & \\
             &        &        & -\ell+2 & \\
        \bigzerol  &  &        &         & -\ell \\
      \end{bmatrix}
      = \diag(\ell,\ell-2,\ell-4,\ldots,-\ell+4,-\ell+2,-\ell).
    \end{align*}
    たとえば $\ell=3$ のとき
    \begin{equation*}
      E_3 =
      \begin{bmatrix}
        0 & 1 &   &   \\
          & 0 & 2 &   \\
          &   & 0 & 3 \\
          &   &   & 0 \\
      \end{bmatrix},
      \quad
      F_\ell =
      \begin{bmatrix}
        0 & & & \\
        3 & 0 & & \\
          & 2 & 0 & \\
          &   & 1 & 0 \\
      \end{bmatrix},
      \quad
      H_3 =
      \begin{bmatrix}
        3 & & & \\
          & 1 & & \\
          &   & -1 & \\
          &   &    & -3 \\
      \end{bmatrix}.
      \qed
    \end{equation*}
  \end{enumerate}
\end{question}

\begin{rem}
  特に $\ell=1$ のとき $E_1=E$, $F_1=F$, $H_1=H$ である.  \qed
\end{rem}

\begin{guide}
  実は Lie 代数 $\lie{sl}_2(\C)$ の (したがってコンパクト Lie 群 $SU(2)$ の)
  有限次元既約表現の同型類の全体は表現 $V_\ell$ ($\ell=0,1,2,\ldots$) で
  代表される%
  \footnote{しかも $e,f,h$ が微分作用素で表わされたのも偶然ではない.
    半単純 Lie 代数 (もしくは半単純 Lie 群) の表現に関する
    幾何学的な理論 (Borel-Weil-Bott 理論) が存在し, 
    それを用いれば半単純 Lie 代数の有限次元表現の
    微分作用素による表示が自然に得られる.
    この辺の問題は Lie 代数および Lie 群の表現論 (representation theory) 
    という大きな理論の一部分を切り取ることによって作成された.}.
  この事実は $3$ 次元空間の回転を量子論的に実現する方法が
  非負の整数 $\ell$ で分類されることを意味している.

  $H_\ell$ の固有値 $\ell,\ell-2,\ldots,-\ell+2,-\ell$ は表現 $V_\ell$ の
  ウェイト (weight) と呼ばれており, その最高値の $\ell$ は表現 $V_\ell$ の
  最高ウェイト (highest weight) と呼ばれている.

  物理学では $\lie{sl}_2$ の三つ組 $E,F,H$ の
  代わりに $\sigma_z=\frac{1}{2}H$, $\sigma_+=\frac{1}{\sqrt{2}}E$, %
  $\sigma_-=\frac{1}{\sqrt{2}}F$ の三つ組を用いることが多い.
  それらは次の交換関係を満たしている:
  \begin{equation*}
    [\sigma_z, \sigma_\pm] = \pm\sigma_\pm, \qquad
    [\sigma_+, \sigma_-] = \sigma_z.
  \end{equation*}
  だから, $H$ の作用 $H_\ell$ の固有値のウェイトでは
  なく, $\sigma_z$ の作用 $\frac{1}{2}H_\ell$ の固有値を用いることが多い.
  $j=\ell/2$ の方を用を表現 $V_\ell$ のスピンと呼ぶ%
  \footnote{電子や陽子のスピンは $1/2$ である.}.

  以上のコメントに関する
  詳しい解説については山内・杉浦 \cite{YS} を参照せよ.
  \qed
\end{guide}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[15点]
  \label{q:companion-jordan}
  正の整数 $n\in\Z>0$ と複素数 $\alpha\in\C$ に
  対して, $(t-\alpha)^k\ne 0$ ($k=1,\ldots,n-1$), $(t-\alpha)^n=0$ を
  満たす文字 $t$ を用意し%
  \footnote{厳密にはそのような文字 $t$ は多項式環 $\C[\lambda]$ の
    剰余環 $\C[\lambda]/((\lambda-\alpha)^n)$ の $\lambda$ で代表
    される元として構成される($t=\lambda\MOD(\lambda-\alpha)^n$).
    剰余環 $\C[\lambda]/((\lambda-\alpha)^n)$ の構成に関しては
    問題 \qref{q:K[x]/(f)-1}, \qref{q:K[x]/(f)-2} を参照せよ.},
  $1,t,t^2,\ldots,t^{n-1}$ を基底に持つ $\C$ 上のベクトル空間 $V$ を
  次のように定める:
  \begin{equation*}
    V := 
    \{\, \beta_0+\beta_1t+\beta_2t^2+\cdots+\beta_{n-1}t^{n-1}
    \mid \beta_0,\beta_1,\beta_2,\ldots,\beta_{n-1}\in\C \,\}.
  \end{equation*}
  写像 $f:V\to V$ を $f(v)=tv$ ($v\in V$) と定めると, $f$ は $V$ の $\C$ 上
  の一次変換 ($V$ からそれ自身への線形写像) である. 
  以下が成立することを示せ:
  \begin{enumerate}
  \item 基底 $1,t,t^2,\ldots,t^{n-1}$ に関する $f$ の行列表示を $A$ と書くと,
    \begin{equation*}
      A =
      \begin{bmatrix}
        0 & & & \bigzerou  & -a_{n-1} \\
        1 & 0 &        &   & -a_{n-2} \\
          & 1 & \ddots &   & \vdots \\
          &   & \ddots & 0 & -a_1 \\
        \bigzerol & &  & 1 & -a_0 \\
      \end{bmatrix}.
    \end{equation*}
    ここで $a_0,a_1,\ldots,a_{n-2},a_{n-1}\in\C$ は $(\lambda-\alpha)^n$ の
    展開
    \begin{equation*}
      (\lambda-\alpha)^n = 
      \lambda^n + a_0\lambda^{n-1} + a_1\lambda^{n-2} + 
      \cdots + a_{n-2}\lambda + a_{n-2}
    \end{equation*}
    によって定められたものである.  二項定理より,
    \begin{equation*}
      a_{i-1} = \binom{n}{i}(-\alpha)^i
      \qquad (i=1,\ldots,n).
    \end{equation*}
    よって $a_0=-n\alpha$, $a_1=\frac{n(n-1)}{2}\alpha^2$, 
    $\ldots,$ $a_{n-2}=n(-\alpha)^{n-1}$, $a_{n-1}=(-\alpha)^n$.
  \item $V$ の $\C$ 上の基底として %
    $1,t-\alpha,(t-\alpha)^2,\ldots,(t-\alpha)^{n-1}$ も取れる.
  \item 基底 $1,t-\alpha,(t-\alpha)^2,\ldots,(t-\alpha)^{n-1}$ に
    関する $f$ の行列表示を $B$ と書くと,
    \begin{equation*}
      B =
      \begin{bmatrix}
        \alpha &        &        &        & \bigzerou \\
        1      & \alpha & & & \\
               & 1      & \alpha & & \\
               &        & \ddots & \ddots & \\
        \bigzerol &     &        & 1      & \alpha \\
      \end{bmatrix}
      \qquad (\text{$n\times n$ 行列}).
      \qed
    \end{equation*}
  \end{enumerate}
\end{question}

\begin{proof}[ヒンと]
  1. $(t-\alpha)^n=0$ を用いて, 
  $[t1,tt,tt^2,\ldots,tt^{n-1}]=[1,t,t^2,\ldots,t^{n-1}]A$ を示せばよい.

  2. $k=0,1,\ldots,n-1$ とする.
  $(t-\alpha)^k$ を展開することによって, $(t-\alpha)^k$ 
  は $1,t,\ldots,t^k$ の一次結合で書けることがわかる.
  逆に $t^k=((t-\alpha)+\alpha)^k$ を展開することによって, $t^k$ 
  は $1,t-\alpha,\ldots,(t-\alpha)^k$ の一次結合で書けることがわかる.
  このことより, $1,t-\alpha,\ldots,(t-\alpha)^{n-1}$ も $V$ の基底であるこ
  とがわかる.
  
  3. $[t1,t(t-\alpha),t(t-\alpha)^2,\ldots,t(t-\alpha)^{n-1}]
  = [1,t-\alpha,(t-\alpha)^2,\ldots,(t-\alpha)^{n-1}]B$ を示せばよい.
  そのとき $t(t-\alpha)^k=(\alpha+(t-\alpha))(t-\alpha)^k
  =\alpha(t-\alpha)^k+(t-\alpha)^{k+1}$ と $(t-\alpha)^n=0$ を用いよ.
  \qed
\end{proof}

\begin{rem}[Jordan 標準形の理論との関係]
  $\tp{A}$ は\guideref{guide:companion-matrix}のコンパニオン行列の形をしてい
  る.  $\tp{B}$ は問題 \qref{q:exp-Jordan} の Jordan ブロックの形をしている.
  実は上の問題 \qref{q:companion-jordan} は単因子論を経由する Jordan 標準形
  の存在証明の一部分になっている.

  その方針での Jordan 標準形の理論の解説に関しては堀田 \cite{10wa} が
  おすすめである.
  \qed
\end{rem}

\begin{guide}[コンパニオン行列]
  \label{guide:companion-matrix}
  次の形の $n$ 次正方行列のを {\bf コンパニオン行列 (同伴行列, 
  companion matrix)} と呼ぶ:
  \begin{equation*}
    C(a_0,\dots,a_{n-1}) =
    \begin{bmatrix}
      0         &    1     &        &      & \bigzerou \\
                &    0     & \ddots &      & \\
                &          & \ddots &  1   & \\
      \bigzerol &          &        &  0   &  1 \\
      -a_{n-1}  & -a_{n-2} & \cdots & -a_1 & -a_0 \\
    \end{bmatrix}.
  \end{equation*}
  コンパニオン行列 $C = C(a_0,\dots,a_{n-1})$ の特性多項式%
  \footnote{一般に $n$ 次正方行列 $A$ の
    {\bf 特性多項式 (characteristic polynomial)} $p_A(\lambda)$ 
    は $p_A(\lambda)=\det(\lambda E - A)$ と定義される.
    ここで $E$ は $n$ 次の単位行列である.}%
  は
  \begin{equation*}
    p_C(\lambda)
    = \det(\lambda E - C(a_0,\ldots,a_{n-1}))
    = \lambda^n + a_0\lambda^{n-1} + a_1\lambda^{n-2}
    + \cdots + a_{n-2}\lambda + a_{n-1}
  \end{equation*}
  となる. %上の問題の結果はこの公式の $n=4$ の場合になっている.
  
  コンパニオン行列の最小多項式は特性多項式に等しく,
  しかもその固有値 $\alpha$ に属する Jordan 細胞は唯一になる
  ことが知られている%
  \footnote{「最小多項式」や「Jordan 細胞」などの用語の意味は
    後で {\bf Jordan 標準形 (Jordan normal form, Jordan canonical form)} 
    の理論を習うときに教わることになるだろう.
    もちろん各自が自由に自習して構わない.
    数学の得意な人の特徴は学校の授業の先の勉強を勝手にやってしまうことである.}.
  \qed
\end{guide}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{商ベクトル空間}
\label{sec:quotient-vector-space}

$K$ は体であるとし, $V$ は $K$ 上の任意のベクトル空間であるとし, 
$W$ は $V$ の部分空間であるとする.  任意の $v\in V$ に対して
\begin{equation*}
  v + W = \{\, v+w \mid w\in W \,\}
\end{equation*}
とおき, 集合の集合 $V/W$ を次のように定める:
\begin{equation*}
  V/W = \{\, v+W \mid v \in V \,\}.
\end{equation*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[5点]
  \label{q:v+W}
  $v,v'\in V$ に対して, $v+W=v'+W$ と $v'-v\in W$ は同値である. \qed
\end{question}

\begin{proof}[ヒント]
  $v+W=v'+W$ ならば $v'\in v'+W$ に対してある $w\in W$ で $v'=v+w$ 
  をみたすものが存在する.  そのとき $v'-v=w\in W$ である.
  逆に $v'-v\in W$ ならば任意の $w\in W$ に対して %
  $v'+w=v+(v'-v)+w\in v+W$ である. よって $v'+W\subset v+W$ である.
  逆向きの包含関係も同様にして示されるので $v+W=v'+W$ である.
  \qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[5点]
  写像 $+:(V/W)\times(V/W)\to(V/W)$ と $\cdot:K\times(V/W)\to(V/W)$ を
  \begin{equation*}
    (u+W)+(v+W) = (u+v)+W, \quad
    \alpha(u+W) = (\alpha u)+W
    \qquad (u,v\in V,\ \alpha\in K)
  \end{equation*}
  と定義することができることを示せ. \qed
\end{question}

\begin{proof}[ヒント]
  これは well-definedness (うまく定義されること) を示す問題である.
  写像がうまく定義されることを示すためには
  同じものが同じものに移ることを示さなければいけない.
  そのためには $u+W=u'+W$, $v+W=v'+W$, $u,u',v,v'\in V$, $\alpha\in K$ のとき,
  \begin{equation*}
    (u+v)+W = (u'+v')+W, \qquad (\alpha u)+W = (\alpha u')+W
  \end{equation*}
  となることを示せばよい.  \qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[5点]
  上の問題で定義された演算 $+$, $\cdot$ に関して $V/W$ は $K$ 上のベクトル空
  間をなすことを示せ. 
  \qed
\end{question}

\begin{proof}[ヒント]
  写像 $-:V/W\to V/W$ を $-(u+W)=(-u)+W$ ($u\in V$) と定義することができる.
  さらに, $0_{V/W}=0+W=W$ とおき, ベクトル空間の公理を機械的にチェックすれば
  よい.
  \qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{definition}[商ベクトル空間]
  以上のようにして構成された $V/W$ を $V$ を $W$ で割ってできる $V$ の
  {\bf 商ベクトル空間 (quotient vector space)} もしくは
  {\bf 商空間 (quotient space)} と呼ぶ.
  \qed
\end{definition}

\begin{guide}[商ベクトル空間の元の記号について]
  $V/W$ の元 $v+W$ は 
  \begin{equation*}
    v+W = v\MOD W = [v] = \bar v
  \end{equation*}
  のように書かれることも多い.
  $v\MOD W$ は「ベクトル $v$ の $W$ の元による平行移動方向の成分を無視した
  もの」という意味を持ち, $[v]$ や $\bar v$ は $v$ で代表される{\bf 同値類 
  (equivalence class)} によく使われる記号である.
  \qed
\end{guide}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{guide}
  以上の商ベクトル空間の構成はそのまま一般の環 $R$ 上の加群の商加群の構成に
  一般化される. \qed
\end{guide}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{guide}[$M/N$ という記号法について]
  代数学において加群 (ベクトル空間も加群の一種であることに注意) $M$ と
  その部分加群 $N$ に対して, $M/N$ は分子の加群 $M$ の中で分母の
  部分加群 $N$ をゼロにつぶしてできる商加群を意味している.
  \qed
\end{guide}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{rem}
  商ベクトル空間は集合の集合として定義されたが,
  {\bf $V/W$ が集合の集合であることにこだわりすぎると
  商ベクトル空間の正しい理解に失敗する}.
  商ベクトル空間 $V/W$ の元は通常のベクトルだと考えた方がよい.

  それでは $V/W$ の元はどのようなベクトルだと考えればよいのだろうか.
  問題 \qref{q:v+W} によれば, $v,v'\in V$ に対応する商ベクトル空間 $V/W$ の
  元 $v+W$, $v'+W$ が互いに等しくなるための必要十分条件は $v'-v\in W$ 
  すなわち $v'\in v+W$ である.
  よって $V$ の中の $v$ を通り $W$ に平行な部分集合 $v+W$ 上のすべての
  ベクトルが商ベクトル空間 $V/W$ の一点に対応している.
  つまり, 直観的に $V/W$ は $V$ を $W$ 方向につぶして%
  \footnote{「つぶす」という言葉を用いると, 紙屑などを「グシャッ」と潰す
    様子を想像する人が結構いるようである.  
    しかし, 商ベクトル空間 $V/W$ を作るために $V$ を $W$ 方向に
    つぶす場合には「グシャッ」ではなく「スーッ」と滑らかに潰れる様子を
    想像しなければいけない.}%
  できるベクトル空間とみなせる.  
  この点に関しては問題 \qref{q:R^3/Z}, \qref{q:R^3/W} を参考にせよ.
  \qed
\end{rem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[10点]
  \label{q:R^3/Z}
  $\R^3$ の部分空間 $Z$ を $Z=\{\,(0,0,z)\mid z\in\R\,\}$ と定める.
  このとき, $\R^3/Z$ は $\R$ 上の2次元のベクトル空間になる.
  \qed
\end{question}

\begin{proof}[ヒント]
  $e_1+Z$, $e_2+Z$ が $\R^3/Z$ の基底をなすことを示せ. \qed
\end{proof}

\begin{rem}
  $\R^3/Z$ は直観的に3次元空間 $\R^3$ を $z$ 軸方向に潰してできる2次元
  空間だとみなせる. すなわち $\R^3$ の中の $z$ 軸 $Z$ に平行な直線を
  一点に潰してできる2次元空間が $\R^3/Z$ である.
  \qed
\end{rem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[10点]
  \label{q:R^3/W}
  $\R^3$ の部分空間 $W$ を $W=\{\,(x,y,0)\mid x,y\in\R\,\}$ と定める.
  このとき, $\R^3/W$ は $\R$ 上の1次元のベクトル空間になる.
  \qed
\end{question}

\begin{proof}[ヒント]
  $e_3+W$ が $\R^3/W$ の基底をなすことを示せ. \qed
\end{proof}

\begin{rem}
  $\R^3/W$ は直観的に3次元空間 $\R^3$ を $xy$ 平面方向に潰してできる1次元
  空間だとみなせる. すなわち $\R^3$ の中の $xy$ 平面 $W$ に平行な平面を
  一点に潰してできる1次元空間が $\R^3/W$ である.
  \qed
\end{rem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[自然な射影, 5点]
  写像 $p:V\to V/W$ を
  \begin{equation*}
    p(v) = v+W \qquad (v\in V)
  \end{equation*}
  と定めると, $p$ は $K$ 上の線形写像でかつ全射である.
  $p$ は $V$ から商空間 $V/W$ への{\bf 自然な射影 (canonical projection)} 
  もしくは{\bf 自然な写像 (canonical mapping)} と呼ばれる.
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[準同型定理, 20点]
  $U$, $V$ は体 $K$ 上のベクトル空間であり, $f:U\to V$ は線形写像であるとす
  る.  $f$ の{\bf 核 (kernel)} $\Ker f$ と{\bf 像 (image)} $\Image f$ を
  \begin{equation*}
    \Ker f = \{\, u\in U\mid f(u) = 0 \,\},
    \qquad
    \Image f = \{\, f(u) \mid u\in U \,\}
  \end{equation*}
  と定めると, $\Ker f$ は $U$ の部分空間であり, $\Image f$ は $V$ の部分空間
  である.  写像 $\phi:U/\Ker f\to \Image f$ を
  \begin{equation*}
    \phi(u+\Ker f) = f(u) \qquad (u\in U)
  \end{equation*}
  と定義することができ(すなわち $u,u'\in U$ に対して $u+\Ker f=u'+\Ker f$ な
  らば $f(u)=f(u')$), $\phi$ は $K$ 上のベクトル空間の同型写像になる. 
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[htbp]
  \begin{center}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\setlength{\unitlength}{0.00083333in}
%
\begingroup\makeatletter\ifx\SetFigFont\undefined
% extract first six characters in \fmtname
\def\x#1#2#3#4#5#6#7\relax{\def\x{#1#2#3#4#5#6}}%
\expandafter\x\fmtname xxxxxx\relax \def\y{splain}%
\ifx\x\y   % LaTeX or SliTeX?
\gdef\SetFigFont#1#2#3{%
  \ifnum #1<17\tiny\else \ifnum #1<20\small\else
  \ifnum #1<24\normalsize\else \ifnum #1<29\large\else
  \ifnum #1<34\Large\else \ifnum #1<41\LARGE\else
     \huge\fi\fi\fi\fi\fi\fi
  \csname #3\endcsname}%
\else
\gdef\SetFigFont#1#2#3{\begingroup
  \count@#1\relax \ifnum 25<\count@\count@25\fi
  \def\x{\endgroup\@setsize\SetFigFont{#2pt}}%
  \expandafter\x
    \csname \romannumeral\the\count@ pt\expandafter\endcsname
    \csname @\romannumeral\the\count@ pt\endcsname
  \csname #3\endcsname}%
\fi
\fi\endgroup
{%\renewcommand{\dashlinestretch}{30}
\begin{picture}(3119,2700)(0,-10)
\path(600,2250)(600,300)
\path(2400,2400)(2400,300)
\path(600,2250)(2400,1350)
\thicklines
\path(2279.252,1376.833)(2400.000,1350.000)(2306.085,1430.498)
\thinlines
\path(600,1200)(2400,300)
\thicklines
\path(2279.252,326.833)(2400.000,300.000)(2306.085,380.498)
\thinlines
\path(600,300)(2250,300)
\thicklines
\path(2130.000,270.000)(2250.000,300.000)(2130.000,330.000)
\thinlines
\path(525,1650)(675,1650)
\path(525,1725)(675,1725)
\path(2325,825)(2475,825)
\path(2325,750)(2475,750)
\put(525,2400){$U$}
\put(2300,2550){$V$}
\put(1350,0){$f$}
\put(2550,1875){$\Coker f = V/\Image f$}
\put(-1100,1650){$U/\Ker f = \Coimage f$}
\put(75,675){$\Ker f$}
\put(2550,750){$\Image f$}
\end{picture}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    \caption{準同型定理}
    \label{fig:hom}
  \end{center}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{proof}[ヒント]
  記号の簡単のため $\overline{u}=u+\Ker f$ ($u\in U$) とおく.
  
  $\phi$ の well-definedness: $u,u'\in U$, 
  $\overline{u}=\overline{u'}$ と仮定する.  
  そのとき $u-u'\in\Ker f$ である.
  よって $f(u)-f(u')=f(u-u')=0$ すなわち $f(u)=f(u')$ である.

  $\phi$ の線形性: $u,u'\in U$, $\alpha\in K$ に対して, %
  $\phi(\overline{u}+\overline{u'})
  = \phi(\overline{u+u'})
  = f(u+u') 
  = f(u) + f(u') 
  = \phi(\overline{u}) + \phi(\overline{u'})$,
  $\phi(\alpha\overline{u}) 
  = \phi(\overline{\alpha u})
  = f(\alpha u)
  = \alpha f(u)
  = \alpha\phi(\overline{u})$. 
  
  $\phi$ の単射性: $u\in U$, $\phi(\overline{u})=0$ と仮定する.
  $0 = \phi(\overline{u}) = f(u)$ より $u\in\Ker f$ である.
  よって $\overline{u}=0$.
  
  $\phi$ の全射性: $\Image\phi =
  \{\,\phi(\overline{u})\mid u\in U\,\} = \Image f$.
  \qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{guide}
  $f:U\to V$ の{\bf 余核 (cokernel)} $\Coker f$ と
  {\bf 余像 (coimage)} $\Coimage f$ が
  \begin{equation*}
    \Coker f = V/\Image f, \qquad \Coimage = U/\Ker f
  \end{equation*}
  と定義される.  準同型定理は余像と像が自然に同型になることを意味している.
  このことをよく\figureref{fig:hom}のように描く.
  \qed
\end{guide}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{guide}
  準同型定理は一般の環 $R$ 上の加群にそのまま一般化される.
  証明の仕方はベクトル空間の場合とまったく同じである.
  \qed
\end{guide}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[10点]
  \label{q:W=Imf}
  $U$ は体 $K$ 上のベクトル空間であり, $V$ はその部分空間であるとし,
  $W$ は $U$ における $V$ の補空間であるとする.
  このとき自然な射影 $p:U\onto U/V$ の $W$ への制限 $p|_W:W\to U/V$ は
  同型写像になる. よって $(W\oplus V)/V\isom W$ という自然な同型を得る.
  \qed
\end{question}

\begin{proof}[ヒント]
  $p|_W$ が単射であることと全射であることを補空間の定義に戻って地道に
  証明せよ.
  もしくは写像 $q:U/V\to W$ を $q((w+v)\MOD V) = w$ ($w\in W$, $v\in V$) 
  と定めることができ(well-definedness のチェックが必要), $q$ が $p|_W$ の
  逆写像になることを示せ. \qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[次元公式, image と kernel の次元の関係, 10点]
  $U$, $V$ は体 $K$ 上のベクトル空間であり, $U$ は有限次元である
  と仮定する. このとき任意の線形写像 $f:U\to V$ に対して %
  \begin{equation*}
   \dim\Ker f + \dim\Image f = \dim U. \qed
  \end{equation*}
\end{question}

%\begin{proof}[ヒント]
%  問題 \qref{q:nulity+rank=n} の一般化. 証明の方針はほとんど同じ
%  でよい. もしくは準同型定理と問題 \qref{q:W=Imf} の結果を使えば
%  より簡単に証明できる.
%  \qed
%\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[5点]
$K$ は任意の体であるとし, $U$, $V$, $W$ は $K$ 上の有限次元ベクトル
空間であり, $\dim V = \dim U + 4$ であると仮定する.
$f:U\to V$, $g:V\to W$ は線形写像であり, $\dim\Ker f = 1$, $\dim\Image g = 3$ 
を満たしていると仮定する.
$\dim\Ker g - \dim\Image f$ を求めよ. 
\\(ヒント: 次元公式を使え.)
\qed 
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[15点]
  \label{q:K[x]/(f)-1}
  体 $K$ 上の一変数多項式環 $K[\lambda]$ を考え, 
  任意にゼロでない多項式 $f\in K[\lambda]$ を取る.
  このとき, $K[\lambda]$ の部分集合 $(f)$ を
  \begin{equation*}
    (f) = K[\lambda]f = \{\, af \mid a\in K[\lambda]\,\}
  \end{equation*}
  と定める%
  \footnote{$(f)$ は $f$ から生成される $K[\lambda]$ の
    {\bf 単項イデアル (principal ideal)}と呼ばれる.}.  
  以下を示せ.
  \begin{enumerate}
  \item $(f)$ は $K[\lambda]$ の $K[\lambda]$ 部分加群である.
    すなわち任意の $g,h\in (f)$ と $a\in K[\lambda]$ に
    対して $g+h\in (f)$ かつ $af\in (f)$ である.
    特に $(f)$ は $K[\lambda]$ の $K$ 上のベクトル部分空間である.
  \item $R=K[\lambda]/(f)$ (商ベクトル空間) とおき,
    $a\in K[\lambda]$ に対する $a+(f)\in R$ を $a\MOD f$ と書くことにする.
    このとき, 積 $\cdot:R\times R\to R$ を
    \begin{equation*}
      (a\MOD f)\cdot(b\MOD f) = ab\MOD f
      \qquad (a,b\in K[\lambda])
    \end{equation*}
    と定めることができる
    (すなわち $a,b,c,d\in K[\lambda]$ に対して %
    $a\MOD f=c\MOD f$, $b\MOD f=d\MOD f$ ならば $ab\MOD f=cd\MOD f$ が
    成立する).
  \item これによって $R$ は可換環をなす%
    \footnote{$R=K[\lambda]/(f)$ は $K[\lambda]$ をイデアル $(f)$ で
      割ってできる{\bf 剰余環 (residue ring, residue-class ring)} と呼ばれる.}.
    \qed
  \end{enumerate}
\end{question}

\begin{proof}[ヒント]
  1. $a,b,c\in K[\lambda]$ に対して $af+bf=(a+b)f\in(f)$ で
  あり, $a(bf) = (ab)f\in(f)$. 
  2. $a\MOD f=c\MOD f$ と $a-c\in(f)$ は同値であり,
  $b\MOD f=d\MOD f$ と $b-d\in(f)$ は同値であるから,
  $ab-cd=ab-ad+ad-cd=a(b-d)+d(a-c)\in(f)$.
  3. $1_R=1\MOD f$ と置き, 可換環の公理を機械的にチェックすればよい.
  \qed
\end{proof}

\begin{guide}
  $R=K[\lambda]/(f)$ は $K[\lambda]$ の中で $f$ をゼロとみなすことによって得
  られる可換環である.  $f$ がゼロとみなされるならば任意の $a\in K[\lambda]$ 
  に対する $af$ もゼロとみなされなければいけない.
  $(f)$ はそのような $af$ 全体のなす集合である.

  本当は上の問題は可換環とイデアルと剰余環の理論としてより一般的に
  やるべき事柄である.
  \qed
\end{guide}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[10点]
  \label{q:K[x]/(f)-2}
  上の問題 \qref{q:K[x]/(f)-1} のつづき.
  $f$ の次数が $n$ ならば $\dim_K R=\dim_K(K[\lambda]/(f))=n$ であることを証
  明せよ. \qed
\end{question}

\begin{proof}[ヒント1]
  $t=\lambda\MOD f$ と置くと, $t^i=\lambda^i\MOD f$ である.
  $1,t,t^2,\ldots,t^{n-1}$ が $R$ の $K$ 上の基底になることを示せばよい.

  任意の $g\in K[\lambda]$ は $g$ を $f$ で割ることに
  よって $g=qf+r$, $q,r\in K[\lambda]$, $\deg r<n$ と一意に表わされる%
  \footnote{$\deg r$ は $r$ の次数である.
    $r=0$ のとき $\deg r = -\infty$ と考える.}
  (商が $q$ で余りが $r$).
  そのとき $g\MOD f=r\MOD f$ であり, $r$ は
  次数が $n$ 未満なので $1,\lambda,\ldots,\lambda^{n-1}$ の
  一次結合で表わされるので, $g\MOD f$ は $1,t,\ldots,t^{n-1}$ の
  一次結合で表わされる.

  もしも $g\in K[\lambda]$, $\deg g<n$ かつ $g\MOD f=0_R=(f)$ な
  らば $g=af$, $a\in K[\lambda]$ と表わされる.
  $\deg g<n$ より $a=0$ でなければいけないので $g=0$ となる.  
  これより $1,t,\ldots,t^{n-1}$ の一次独立性が出る.
  \qed
\end{proof}

\begin{proof}[ヒント2]
  次数が $n$ 未満の $\lambda$ の多項式全体のなす $n$ 次元のベクトル空間
  を $V$ と書き, 線形写像 $\phi:V\to R$ を $\phi(v)=v\MOD f$ ($v\in V$) と定義
  する.  $\phi$ が同型写像であることを示せば $R$ の次元も $n$ であることがわ
  かる.

  任意の $g\in K[\lambda]$ は $g$ を $f$ で割ることに
  よって $g=qf+r$, $q,r\in K[\lambda]$, $\deg r<n$ と一意に表わされる
  ので, $g\MOD f=r\MOD f=\phi(r)$ である.  よって $\phi$ は全射である.

  もしも $g\in V$ かつ $\phi(g) = g\MOD f=0_R=(f)$ 
  ならば $g=af$, $a\in K[\lambda]$ と表わされる.
  $\deg g<n$ より $a=0$ でなければいけないので $g=0$ となる.  
  よって $\phi$ は単射である.
  \qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{双対空間}
\label{sec:dual-space}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[双対空間の定義, 5点]
  体 $K$ 上のベクトル空間 $V$ に対して $V$ から $K$ への線形写像全体のなす集
  合 $V^*$ は自然に体 $K$ 上のベクトル空間をなすことを示せ.
  $V^*$ は $V$ の{\bf 双対ベクトル空間 (dual vector space)} もしくは
  {\bf 双対空間 (dual space)} と呼ばれる.
  $f\in V^*$ と $v\in V$ に対して $f(v)$ を $\bra f,v\ket$ と表わすことが
  ある.
  \qed
\end{question}

\begin{proof}[ヒント]
  問題 \qref{q:Hom-set} の特別な場合. $V^*=\Hom_K(V,K)$. \qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[横ベクトルの空間と縦ベクトルの空間の双対性, 5点]
  $K$ は体であるとする. $K$ の元を成分に持つ $n$ 次元縦ベクトル全体のなすベ
  クトル空間を $K^n$ と書き, $n$ 次元横ベクトル全体のなすベクトル空間を
  仮に $\tp{(K^n)}$ と書くことにする.
  写像 $\iota:\tp{(K^n)}\to(K^n)^*$ を横ベクトルと縦ベクトルの積によって
  \begin{equation*}
    \Bigl\bra
    \iota([x_1,\ldots,x_n]), 
    \begin{bmatrix}
      y_1 \\ \vdots \\ y_n \\
    \end{bmatrix}
    \Bigr\ket
    := 
    [x_1,\ldots,x_n]
    \begin{bmatrix}
      y_1 \\ \vdots \\ y_n \\
    \end{bmatrix}
    = \sum_{i=1}^n x_iy_i
    \qquad (x_i,y_i\in K)
  \end{equation*}
  と定義する. このとき $\iota$ は同型写像になることを示せ.
  $\iota$ を通して横ベクトルの空間 $\tp{(K^n)}$ と縦ベクトルの空間 $K^n$ の
  双対空間 $(K^n)^*$ は自然に同一視される.
  \qed
\end{question}

\begin{guide}[ブラとケット]
  \label{guide:bra-ket}
  量子力学には, ブラベクトル (bra vector) $\bra v^*|$ や
  ケットベクトル (ket vector) $|v\ket$ のような記号が登場し%
  \footnote{Dirac \cite{Dirac} などの量子力学の教科書を参照せよ.},
  ブラ $\bra v^*|$ とケット $|v\ket$ のあいだに
  は $\bra v^*|v\ket\in\C$ と書かれる内積が定義されている.

  実はブラベクトル全体のなすベクトル空間は
  ケットベクトル全体のなすベクトル空間の双対空間と同一視できる.
  直観的にブラベクトルは横ベクトルのようなものであり,
  ケットベクトルは縦ベクトルのようなものだと考えればよい.
  横ベクトルと縦ベクトルのあいだには上の問題のように
  自然に内積が定義される.
  \qed
\end{guide}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[基底の定める座標, 5点]
  \label{q:x_i}
  $V$ は体 $K$ 上の有限次元ベクトル空間であり, $v_1,\ldots,v_n$ は $V$ の
  基底であるとする. 任意の $v\in V$ は $v=\alpha_1v_1+\cdots+\alpha_nv_n$ 
  ($\alpha_i\in K$) と一意に表わされる.  よって $v$ に対して $\alpha_i$ を対
  応させる写像 $x_i$ が定まる.  $x_i\in V^*$ であることを示せ. 
  ($x_i$ を基底 $v_i$ の定める $V$ 上の座標と呼ぶことにする.)
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[双対基底, 10点]
  \label{q:dual-basis}
  $V$ は体 $K$ 上の有限次元ベクトル空間であるとする.
  $V$ の基底 $v_1,\ldots,v_n$ に対して,
  $v^*_1,\ldots,v^*_n\in V^*$ を
  \begin{equation*}
    \bra v^*_i, v_j \ket = \delta_{ij}
    \qquad (i,j=1,\ldots,n)
  \end{equation*}
  という条件によって一意に定めることができる.
  このとき $v^*_1,\ldots,v^*_n$ は双対空間 $V^*$ の基底になる.
  特に $\dim V^* = \dim V$ である.
  $v^*_1,\ldots,v^*_n$ を $v_1,\ldots,v_n$ の{\bf 双対基底 (dual basis)} 
  と呼ぶ.
  \qed
\end{question}

\begin{proof}[ヒント]
  任意の $f\in V^*$ に対して, $g=\sum_{j=i}^n\bra f,v_i\ket v^*_i\in V^*$ 
  と置くと, $\bra g,v_j\ket = \bra f,v_j\ket$ ($j=1,\ldots,n$) である
  から, $f=g$ であることがわかる.  
  よって $V^*$ は $v^*_1,\dots,v^*_n$ で張られる.
  $v^*:=\sum_{i=1}^n\alpha_i v^*_i=0$, $\alpha_i\in K$ 
  と仮定する. このとき $0=\bra v^*,v_j\ket=\alpha_j$ ($j=1,\ldots,n$) である.
  よって $v^*_1,\dots,v^*_n$ は一次独立である.
  \qed
\end{proof}

\begin{rem}
  問題 \qref{q:x_i} の $x_i$ と問題 \qref{q:dual-basis} の $v^*_i$ は等しい.
  \qed
\end{rem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[1の分解, 10点]
  \label{q:1=sum-vv*}
  $V$ は体 $K$ 上の有限次元ベクトル空間であるとする.
  $V$ の基底 $v_1,\ldots,v_n$ と
  その双対基底 $v^*_1,\ldots,v^*_n\in V^*$ を任意に取る.
  $V$ の一次変換 $\sum_{i=1}^n v_iv_i^*$ を次のように定める:
  \begin{equation*}
    \left(\sum_{i=1}^n v_iv_i^*\right)(v)
    = \sum_{i=1}^n v_i \bra v_i^*, v\ket
    \qquad (v\in V).
  \end{equation*}
  この $\sum_{i=1}^n v_iv_i^*$ は $V$ の恒等写像 $\id_V$ に等しい.
  $\id_V = \sum_{i=1}^n v_iv_i^*$ を {\bf $1$ の分割}と呼ぶ.
  \qed
\end{question}

\begin{proof}[ヒント]
  $v\in V$ を $v=\sum_{j=1}^n \alpha_j v_j$, $\alpha_j\in K$ と
  表わし, $\sum_{i=1}^n v_i \bra v_i^*, v\ket$ を計算してみよ.
  \qed
\end{proof}

\begin{rem}
  $V=K^n$, $v_i=e_i$ ならば $v^*_i=\tp{e_i}$ である.
  $\sum_{i=1}^n e_i\tp{e_i}$ が単位行列になることは容易に示される.
  上の問題の結果はこれの一般化である.
  \qed
\end{rem}

\begin{guide}
  量子力学では\footnote{Dirac \cite{Dirac} などを見よ.}, 
  $1$ の分割をブラとケットの記号を
  用いて $1 = \sum_i |i\ket \bra i|$ のように書くことが多い. 
  $|i\ket$ はケットベクトル全体の空間の基底であり, $\bra i|$ は
  その双対基底である.
  \qed
\end{guide}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[双対の双対, 10点]
  $V$ は体 $K$ 上の有限次元ベクトル空間であるとする.
  このとき, 写像 $\iota: V\to (V^*)^*$ を
  \begin{equation*}
    \bra \iota(v), f\ket = \iota(v)(f) := \bra f, v\ket = f(v)
    \qquad (v\in V,\ f\in V^*)
  \end{equation*}
  と定めると, $\iota$ は同型写像である.
  $\iota:V\isomto (V^*)^*$ を通して, $(V^*)^*$ は $V$ と自然に同一視される.
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[転置写像, 10点]
  $f:U\to V$ は体 $K$ 上のベクトル空間のあいだの線形写像であるとする.
  このとき線形写像 $\tp{f}:V^*\to U^*$ を
  \begin{equation*}
    \bra \tp{f}(v^*), u \ket = \bra v^*, f(u)\ket
    \qquad (v^*\in V^*,\ u\in U)
  \end{equation*}
  と定義できることを示せ.  $\tp{f}$ を $f$ の{\bf 転置写像}と呼ぶことにする.
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[行列の転置との関係, 10点]
  $K$ は体であるとし, 
  $K$ の元を成分に持つ $n$ 次元縦ベクトル全体の空間を $K^n$ と表わし, 
  写像 $\iota:K^n\to(K^n)^*$ を
  \begin{equation*}
    \bra \iota(x), y\ket = \iota(x)(y) := \tp{x}y = \sum_{i=1}^n x_iy_i
    \qquad (x=[x_i], y=[y_i] \in K^n)
  \end{equation*}
  と定めると, $\iota$ は同型写像である. 
  $\iota$ を用いて $(K^n)^*$ と $K^n$ 自身を同一視することにする.
  そのとき, 任意に $A\in M_{m,n}(K)$ を取ると, 
  $A$ の定める $K^n$ から $K^m$ への線形写像の転置写像
  が $\tp{A}$ の定める $K^m$ から $K^n$ への線形写像になることを示せ.
  \qed
\end{question}

\begin{proof}[ヒント]
  $x,y\in K^n$ を任意に取る.
  $\bra \iota(\tp{A}x), y\ket = \bra \iota(x),Ay\ket$ を示せばよい.
  \qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[商空間と部分空間の双対, 20点]
  $U$ は体 $K$ 上のベクトル空間であり, $V$ はその部分空間であるとし,
  \begin{equation*}
    V^\bot = \{\, u^*\in U^* \mid \bra u^*,v\ket = 0 \ (v\in V) \,\}
  \end{equation*}
  とおく\footnote{$V^\bot$ は $V$ の $U^*$ における
    {\bf 直交補空間 (orthogonal complement)} と呼ばれる.
    この用語法は計量ベクトル空間における直交補空間の概念を
    双対空間の場合に一般化したものである.}.
  $V$ から $U$ への包含写像を $i$ と書き%
  \footnote{$i$ は $v\in V$ を $v\in U$ に対応させる写像である.}, 
  $U$ から $U/V$ への自然な射影を $p$ と書くことにする:
  \begin{equation*}
    \begin{CD}
      V @>i>> U @>p>> U/V. \\
    \end{CD}
  \end{equation*}
  双対空間の移ると次のような転置写像の列ができる:
  \begin{equation*}
    \begin{CD}
      V^* @<\tp{i}<< U^* @<\tp{p}<< (U/V)^*.
    \end{CD}
  \end{equation*}
  以下を示せ:
  \begin{enumerate}
  \item $\tp{p}:(U/V)^*\to U^*$ は単射である.
  \item $\Ker\tp{i}=V^\bot$.
  \item $\Ker\tp{i}=\Image\tp{p}$ である.
  \item $\tp{p}$ は自然な同型 $(U/V)^*\isomto V^\bot$,
    $x^*\mapsto \tp{p}(x^*)$ を誘導する.
  \item $\tp{i}:U^*\to V^*$ は全射である.
  \item $\tp{i}$ は自然な同型 $U^*/V^\bot \isomto V^*$,
    $u^*\MOD V^\bot \mapsto \tp{i}(u^*)$ を誘導する.
    \qed
  \end{enumerate}
\end{question}

\begin{proof}[ヒント]
  1. 任意の $u\in U$, $x^*\in (U/V)^*$ に対して, %
  $\bra\tp{p}(x^*),u\ket = \bra x^*,u\MOD V\ket$ であるから, %
  $\tp{p}(x^*)=0$ ならば $x^*=0$ である.
  よって $\Ker\tp{p}=0$ である.
  これで $\tp{p}$ は単射であることが示された.

  2. 任意の $u^*\in U$, $v\in V$ に対して, %
  $\bra \tp{i}(u^*),v\ket = \bra u^*,v\ket$ であるから, %
  $\tp{i}(u^*)=0$ と $\bra u^*,v\ket=0$ ($v\in V$) は同値である.
  これで $\Ker\tp{i}=V^\bot$ が示された.

  3. 任意の $x^*\in(U/V)^*$, $v\in V$ に対して, %
  $\bra\tp{i}(\tp{p}(x^*)),v\ket 
  = \bra\tp{p}(x^*),i(v)\ket
  = \bra\tp{p}(x^*),v\ket
  = \bra x^*,p(v)\ket 
  = \bra x^*,0\ket 
  = 0$ であるから, $\Image\tp{p}\subset\Ker\tp{i}$ である.
  任意の $u^*\in\Ker\tp{i}$, $v\in V$ に対して, %
  $0 = \bra\tp{i}(u^*),v\ket
  = \bra u^*,v\ket$ であるから, $x^*\in(U/V)^*$ を %
  $\bra x^*,u\MOD V\ket = \bra u^*,u\ket$ ($u\in U$) と
  定めることができる. そのとき $\tp{p}(x^*)=u^*$ である
  から, $\Ker\tp{i}\subset\Image\tp{p}$ である.

  4. $\tp{p}:(U/V)^*\to U^*$ は単射であるから, 
  同型 $(U/V)^*\isomto\Image\tp{p}=\Ker\tp{i}=V^\bot$ を誘導する.

  5. $V$ の $U$ における補空間 $W$ が存在する
  (問題 \qref{q:complement} の結果).
  $v^*\in V^*$ に対して $u^*\in U^*$ を $\bra u^*,v+w\ket=\bra v^*,v\ket$
  ($v\in V$, $w\in W$) と定めると, $\tp{i}(u^*)=v^*$ である.
  よって $\tp{i}$ は全射である.

  6. 準同型定理を $\tp{i}$ に適用すると, 2, 5 より
  同型 $U^*/V^\bot\isomto V^*$, $u^*\MOD V^\bot \mapsto \tp{i}(u^*)$ が
  得られる.
  \qed
\end{proof}

\section{$2$ 次および $3$ 次正方行列の Jordan 標準形}

この節では, 固有値と固有ベクトルについて簡単に説明し, 
$2$ 次および $3$ 次正方行列の
ジョルダン標準形 (Jordan normal form)の計算の仕方を扱う.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{固有値と固有ベクトル}

複素 $n$ 次正方行列 $A$ と複素数 $\alpha$ に
対して, $0$ でない縦ベクトル $u$ で
\begin{equation*}
  A u = \alpha u
\end{equation*}
を満たすものが存在するとき,  $\alpha$ を $A$ の{\bf 固有値 (eigen value)}と
呼び, $u$ を $A$ の{\bf 固有ベクトル (eigen vector)}と呼ぶ.
行列 $A$ を与えてその固有値と固有ベクトルをすべて求める問題を固有値問題と呼ぶ.
固有値 $\alpha$ に対して,
\begin{equation*}
  \{\, u\in\C^n \mid Au = \alpha u \,\}
  = \{\, u\in\C^n \mid (A-\alpha E)u = 0 \,\}
  = \Ker(A - \alpha E)
\end{equation*}
を $\alpha$ に対応する{\bf 固有空間 (eigen space)}と呼ぶ.

複素 $n$ 次正方行列 $A$ と複素数 $\alpha$ に $0$ でない縦ベクトル $u$ が
ある $k=1,2,3,\ldots$ に関して
\begin{equation*}
  (A - \alpha E)^k u = 0
\end{equation*}
を満たしているとき, $u$ を $A$ の{\bf 一般固有ベクトル}と呼ぶ.
$(A - \alpha E)^k u = 0$ となる最小の $k$ を取るとき,
$k=1$ ならば $u$ は固有ベクトルになり,
$k>1$ の場合には $v = (A - \alpha E)^{k-1}u$ と置けば $v$ は固有値 $\alpha$ 
に対する固有ベクトルになる.  よって $\alpha$ は $A$ の固有値になる. 
行列 $A$ を与えてその固有値と一般固有ベクトルをすべて求める問題を
一般固有値問題と呼ぶ.  固有値 $\alpha$ に対して, 
\begin{equation*}
  W(A,\alpha) 
  = \{\, u\in\C^n \mid (A - \alpha E)^k u = 0 \ (\exists k = 1,2,3,\ldots)\,\}
\end{equation*}
を $\alpha$ に対応する{\bf 一般固有空間 (generalized eigen space)}と呼ぶ.

複素 $n$ 次正方行列 $A$ に対して, 
その{\bf トレース (trace)}, {\bf 行列式 (determinant)} を
それぞれ $\trace A$, $\det A = |A|$ と書くことにし, 
$A$ の{\bf 特性多項式 (characteristic polynomial)} $p_A(\lambda)$ を
次のように定める:
\begin{equation*}
  p_A(\lambda) = \det(\lambda E - A).
\end{equation*}
ここで, $E$ は $n$ 次単位行列である. 
このとき $\lambda$ に関する $n$ 次方程式 $p_A(\lambda)=0$ を $A$ の
{\bf 特性方程式 (characteristic equation)} と呼ぶ. 
%たとえば $2$ 次正方行列
%\begin{equation*}
%  A = 
%  \begin{bmatrix}
%    a & b \\
%    c & d \\
%  \end{bmatrix}
%\end{equation*}
%に対して,
%\begin{equation*}
%  \trace A = a + d,
%  \qquad
%  \det A = |A| = ad - bc.
%\end{equation*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[簡単過ぎるので3点]
  \label{q:char-poly-2.1}
  複素 $2$ 次正方行列 $A$ の特性多項式 $p_A(\lambda)$ について以下が成立する
  ことを直接的な計算によって証明せよ: 
  \begin{enumerate}
  \item[(1)] \( p_A(\lambda) = \lambda^2 - \trace(A)\lambda + \det(A) \).
  \item[(2)] \( p_A(A) = 0 \) \quad ($2$ 次正方行列の Cayley-Hamilton の定理).
  \qed
  \end{enumerate}
\end{question}

\noindent 
参考: この結果は受験数学の勉強でおなじみであろう.
忘れた人は復習して欲しい.  
以下の問題の結論のほとんどが一般の $n$ 次正方行列に対して適切に一般化される. 
Cayley-Hamilton の定理の証明として,
\begin{equation*}
 p_A(A) = \det(AE - A) = \det(A - A) = \det 0 = 0
\end{equation*}
は{\bf 誤り}である. 

どこがまずいかを理解するためには記号に騙されないようにしなければいけない.
$p_A(A)$ は行列である.  $AE - A$ も行列である.  
しかし $\det(AE-A)$ は数である.  
$p_A(A)=\det(AE-A)$ という計算は左辺が行列で右辺が数なのでナンセンスである.

しかし, 実は上のナンセンスな計算にかなり近い考え方で 
Cayley-Hamilton の定理を証明することができる
(佐武 \cite{satake} 137頁, 杉浦 \cite{sugiura} 65--66頁).
\secref{sec:Cayley-Hamilton} の前半でその方法を紹介する.

ついでに述べておけば, 「$\det 0$」の $0$ は行列のゼロであるが, 
その次の「$= 0$」の $0$ は数のゼロである.
この2つの「$0$」は同じ記号で書かれているが意味が違うことに注意しなければいけ
ない.  この演習ではベクトルのゼロも単に「$0$」と書く.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[5点]
  2つの縦ベクトル %
  $u=\tp{[a, c]}$, $v=\tp{[b, d]}$ に対して%
  \footnote{$\tp{[\ ]}$ は転置を意味している.}, 2次正方行列 $A$ を
  \begin{equation*}
    A := [u, v] = \begin{bmatrix} a & b \\ c & d \end{bmatrix}
  \end{equation*}
  と定める. このとき, 以下の条件は互いに同値であることを直接証明せよ:
  \begin{enumerate}
  \item[(a)] $A$ の逆行列が存在する.
  \item[(b)] $\det(A) \ne 0$.
  \item[(c)] 任意の $\xi,\eta\in\C$ に対して, %
    $\xi u + \eta v = 0$ ならば $\xi = \eta = 0$.
  \qed
  \end{enumerate}
\end{question}

\noindent 
解説: このように $u$ と $v$ が一次独立であるという条件 (c) と
条件 (a), (b) は同値なのである. もちろん, 同様の結果が $n$ 次正方行列に対し
ても成立する. 一般の場合を証明するには線形代数の一般論を展開することが自然で
あるが, $n=2$ の特殊な場合は直接計算のみで証明することも易しいので, 
一度は経験しておくべきである.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[15点]\label{q:det-nxn}
  $A$ は $n$ 次正方行列であるとする. このとき以下の条件は互いに同値である:
  \begin{enumerate}
  \item[(a)] $A$ の逆行列が存在する.
  \item[(b)] $\det A \ne 0$.
  \item[(c)] $A$ の $n$ 本の列ベクトルは一次独立である.
  \item[(d)] $A$ の $n$ 本の行ベクトルは一次独立である.
  \item[(e)] 任意のゼロでない縦ベクトル $u$ に対して $Au\ne0$.
    \qed
  \end{enumerate}
\end{question}

\noindent 
ヒント: 線形代数の任意の教科書を参照せよ. なお, 
この問題の結論はその証明を復習した後では証明抜きで自由に用いて良い.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[5点]
  $A$ は複素 $n$ 次正方行列であり, $p_A(\lambda)$ はその特性多項式であるとす
  る.  このとき, 複素数 $\alpha$ が $A$ の固有値であるための必要十分条件
  は $p_A(\alpha)=0$ が成立することである. 
  \qed
\end{question}

\noindent 
ヒント: 問題 \qref{q:det-nxn} を $A - \alpha E$ に適用せよ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[5点]
  任意の $a,b,c\in\C$ に対して, $a\ne0$ならば, 
  ある $\alpha,\beta\in\C$ で次を満たすものが存在することを厳密に証明せよ:
  \begin{equation*}
    a \lambda^2 + b \lambda + c 
    = a(\lambda - \alpha)(\lambda - \beta).
    \qed
  \end{equation*}
\end{question}

\noindent 
参考: これは $2$ 方程式に関する結果だが, 
同様のことが任意の複素係数 $n$ 次代数方程式に対して成立する(代数学の基本定理). 
これ以後この演習では代数学の基本定理を証明抜きで自由に用いて良いことにする. 
(代数学の基本定理には様々な証明の仕方がある. おそらく複素函数論の授業で証明
の仕方の一つを習うことになるだろう.)
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{2次正方行列の Jordan 標準形と指数函数の計算の仕方}
\label{sec:2x2-Jordan}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[簡単だが一度はやるべき問題なので10点]
\label{q:2x2-Jordan-B}
  行列 $B$ を次のように定める:
  \begin{equation*}
    B = 
    \begin{bmatrix}
        7 &  2 \\
       -8 & -1 \\
     \end{bmatrix}.
   \end{equation*}
   可逆な行列 $P$ と数 $\alpha$ で %
   $P^{-1}BP = 
   \begin{bmatrix}
     \alpha & 1 \\
     0 & \alpha \\
   \end{bmatrix}$ をみたすものを求めよ. 
   \qed
\end{question}

\commentout{
\begin{proof}[略解とコメント]
$B$ の固有多項式は $(\lambda-3)^2$ なので 
Cayley-Hamilton の定理より $(B-3E)^2=0$.  
よって $v=
\begin{bmatrix}
  0 \\
  1 \\
\end{bmatrix}$ と置き, $u = (B-3E)v = (\text{$B-3E$ の第 $2$ 列}) = 
\begin{bmatrix}
  2 \\
  -4 \\
\end{bmatrix}$ と置くと, $(B-3E)u=(B-3E)^2v=0$. そのとき
\begin{equation*}
  Bu = 3u, \qquad Bv = u + 3v.
\end{equation*}
すなわち $P = [u,v] = 
\begin{bmatrix}
   2 & 0 \\
  -4 & 1 \\
\end{bmatrix}$ と置くと $P^{-1}BP=
\begin{bmatrix}
  3 & 1 \\
  0 & 3 \\
\end{bmatrix}$.

\medskip\noindent {\bf コメント.} 
$2$ 次や $3$ 次の正方行列の Jordan 標準形への相似変換の計算
は Cayley-Hamilton の定理を使うと楽にできる.
\qed
\end{proof}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[10点]
  \label{q:normal-form-2.1}
  複素 $2$ 次正方行列 $A$ の特性方程式 $p_A(\lambda)=0$ の解
  を $\alpha$, $\beta$ と書くことにする. 
  $\alpha \ne \beta$ であるとき, 以下が成立する:
  \begin{enumerate}
  \item[(1)] $A \ne \alpha E$ かつ $A \ne \beta E$.
  \item[(2)] 行列 $A - \beta E$ の $0$ でない列ベクトルの1つを $u$ と書き%
    \footnote{行列 $X=\begin{bmatrix}a&b\\c&d\end{bmatrix}$ に対して, 
      ベクトル $\begin{bmatrix}a\\c\end{bmatrix}$,
      $\begin{bmatrix}b\\d\end{bmatrix}$ を $X$ の列ベクトルと呼ぶ.
      $X \ne 0$ ならば列ベクトルの少なくともいずれか片方は $0$ ではない.}, %
    行列 $A - \alpha E$ の $0$ でない列ベクトルの1つを $v$ と書くことにする. 
    このとき次が成立する:
    \begin{equation*}
      Au = \alpha u,  \qquad  Av = \beta v.
    \end{equation*}
    (ヒント: $Au=\alpha u$ と $(A-\alpha E)u=$ は同値である.
    この考え方は今後自由に使われる. 
    Cayley-Hamilton の定理より $(A-\alpha E)(A-\beta E)=0$ であるが, 
    その等式を $A-\alpha E$ が $A-\beta E$ の2本の列ベクトルに作用する式とみ
    なしてみよ.  この考え方も今後頻繁に用いられる.)
  \item[(3)] $2$ 次正方行列 $P$ を $P := [u, v]$ と定めると%
    \footnote{縦ベクトル $u=\begin{bmatrix}a\\c\end{bmatrix}$, 
      $v=\begin{bmatrix}b\\d\end{bmatrix}$ に対して, 
      $[u, v] = \begin{bmatrix}a&b\\c&d\end{bmatrix}$ であると考えよ.}, %
    $P$ は逆行列を持つ. 
  \item[(4)] 次が成立する:
    \begin{equation*}
      P^{-1} A P = \begin{bmatrix}\alpha & 0\\0 & \beta\end{bmatrix}.
    \end{equation*}
  \item[(5)] 任意の $k=1,2,3,\ldots$ に対して,
    \begin{equation*}
      A^k = P \begin{bmatrix}\alpha^k & 0\\0 & \beta^k\end{bmatrix} P^{-1}.
    \end{equation*}
  \item[(6)] 任意の $t\in\C$ に対して,
    \begin{equation*}
      e^{At} =
      P
      \begin{bmatrix}
        e^{\alpha t} & 0 \\
        0 & e^{\alpha t} \\
      \end{bmatrix}
      P^{-1}.
    \qed
    \end{equation*}
  \end{enumerate}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[15点]
  \label{q:normal-form-2.2}
  2次正方行列 $A$ の特性方程式 $p_A(\lambda)=0$ が
  重解 $\alpha$ を持ち,  $A \ne \alpha E$ であると仮定する.
  このとき, 以下が成立する:
  \begin{enumerate}
  \item[(1)] 行列 $A - \alpha E$ の $0$ でない列ベクトルの1つを $u$ と書くこと
    にする. このとき, $Au = \alpha u$ が成立する. 
    (ヒント: $(A-\alpha E)(A-\alpha E)=0$.)
  \item[(2)] ある縦ベクトル $v$ で $(A - \alpha E)v=u$ を満たすものが存在する.
    (ヒント: $u$ が $A - \alpha E$ の
    左側の列ベクトルならば $v=\tp{[1, 0]}$ とし, 
    右側の列ベクトルならば $v=\tp{[0, 1]}$ とすれば良い.)
  \item[(3)] $P := [u, v]$ と置くと $P$ は逆行列を持つ.
    (ヒント: $u$ と $v$ の一次結合に $A - \alpha E$ を作用させてみよ.)
  \item[(4)] 次が成立する:
    \begin{equation*}
      P^{-1} A P = \begin{bmatrix}\alpha & 1\\0 & \alpha\end{bmatrix}.
    \end{equation*}
  \item[(5)] 任意の $k=1,2,3,\ldots$ に対して,
    \begin{equation*}
      A^k = 
      P
      \begin{bmatrix} \alpha^k & k\alpha^{k-1} \\ 0 & \alpha^k \end{bmatrix}
      P^{-1}. 
    \end{equation*}
  \item[(6)] 任意の $t\in\C$ に対して,
    \begin{equation*}
      e^{At} =
      P
      \begin{bmatrix}
        e^{\alpha t} & t e^{\alpha t} \\
        0            &   e^{\alpha t} \\
      \end{bmatrix}
      P^{-1}.
    \qed
    \end{equation*}
  \end{enumerate}
\end{question}

以上によって, 複素 $2$ 次正方行列 $A$ に対して, 正則行列 $P$ をうまくとって,
$P^{-1}AP$ を次のどちらかの形にできることがわかった:
\begin{equation*}
  \begin{bmatrix} \alpha & 0 \\ 0 & \beta \\ \end{bmatrix},
  \qquad
  \begin{bmatrix} \alpha & 1 \\ 0 & \alpha \\ \end{bmatrix}.
\end{equation*}
この結果は任意の複素 $n$ 次正方行列 (より一般には代数閉体上の $n$ 次正方行列) 
に拡張される (Jordan標準型の理論).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{2次正方行列の Jordan 標準形の計算と応用}
\label{sec:2x2-calc-app}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[5点]
\label{q:[0,4;-1,4]]}
  行列 %
  \(
    A =
    \begin{bmatrix}
       0 & 4 \\
      -1 & 4 \\
    \end{bmatrix}
  \) の固有値と固有ベクトルをすべて求めよ. \qed
\end{question}

\commentout{
\noindent
略解: $p_A(\lambda)=(\lambda-2)^2$ かつ $A\ne 2E$. 
よって固有値は $2$ だけ. 固有ベクトルとして $A - 2E$ の列ベクトルが取れる.
\qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[小問各5点]
\label{q:k-jou}
  以下の行列の $k$ 乗を求めよ ($k=1,2,3,\ldots$):
  \begin{equation*}
    \text{(1)}\quad
    \begin{bmatrix} 1 & 2 \\ 2 & 4 \end{bmatrix},
    \qquad
    \text{(2)}\quad
    \begin{bmatrix} 1 & 3 \\ 1 & -1 \end{bmatrix},
    \qquad
    \text{(3)}\quad
    \begin{bmatrix} 1 & - 1 \\ 1 & 3 \end{bmatrix},
    \qquad
    \text{(4)}\quad
    \begin{bmatrix} 5 & 1 \\ -1 & 3 \end{bmatrix}.
    \qed
  \end{equation*}
\end{question}

\noindent 
ヒント: 問題 \qref{q:char-poly-2.1}, \qref{q:normal-form-2.1}, 
\qref{q:normal-form-2.2} の結果を使うことを考えよ.
\qed

\commentout{
\medskip
\noindent
略解:
\begin{enumerate}
\item[(1)] 
  \( %
    \begin{bmatrix} 1 & 2 \\ 2 & 4 \end{bmatrix}^2
    = 5 \begin{bmatrix} 1 & 2 \\ 2 & 4 \end{bmatrix}
  \) %
  より, %
  \( %
    \begin{bmatrix} 1 & 2 \\ 2 & 4 \end{bmatrix}^k
    = 5^{k-1} \begin{bmatrix} 1 & 2 \\ 2 & 4 \end{bmatrix}
  \). %
\item[(2)] 
  \( %
    \begin{bmatrix} 1 & 3 \\ 1 & -1 \end{bmatrix}^2 = 4E
  \) %
  を用いて $k$ の偶奇で場合分けするか, 問題 \qref{q:normal-form-2.1} の
  結果を用いて,
  {\small
  \begin{equation*}
      \begin{bmatrix} 1 & 3 \\ 1 & -1 \end{bmatrix}^k
    = \begin{bmatrix} 3 & -1 \\ 1 & 1 \end{bmatrix}
      \begin{bmatrix} 2^k & 0 \\ 0 & (-2)^k \end{bmatrix}
      \frac{1}{4}
      \begin{bmatrix} 1 & 1 \\ -1 & 3 \end{bmatrix}
    = \frac{1}{4}
      \begin{bmatrix}
        3\cdot 2^k + (-2)^k & 3\cdot 2^k - 3\cdot(-2)^k \\
               2^k - (-2)^k &        2^k + 3\cdot(-2)^k
      \end{bmatrix}.
  \end{equation*}
  }
\item[(3)] 問題 \qref{q:normal-form-2.2} の結果を用いて,
  \begin{equation*}
      \begin{bmatrix} 1 & -1 \\ 1 & 3 \end{bmatrix}^k
    = \begin{bmatrix} -1 & 1 \\ 1 & 0 \end{bmatrix}
      \begin{bmatrix} 2^k & k\cdot 2^{k-1} \\ 0 & 2^k \end{bmatrix}
      \begin{bmatrix} 0 & 1 \\ 1 & 1 \end{bmatrix}
    = \begin{bmatrix}
        2^k - k\cdot 2^{k-1} & -k\cdot 2^{k-1} \\
        k\cdot 2^{k-1}       & 2^k + k\cdot 2^{k-1}
      \end{bmatrix}.
  \end{equation*}
\item[(4)] 問題 \qref{q:normal-form-2.2} の結果を用いて,
  \begin{equation*}
      \begin{bmatrix} 5 & 1 \\ -1 & 3 \end{bmatrix}^k
    = \begin{bmatrix} 1 & 0 \\ -1 & 1 \end{bmatrix}
      \begin{bmatrix} 4^k & k\cdot 4^{k-1} \\ 0 & 4^k \end{bmatrix}
      \begin{bmatrix} 1 & 0 \\ 1 & 1 \end{bmatrix}
    = \begin{bmatrix}
        4^k + k\cdot 4^{k-1} & k\cdot 4^{k-1} \\
        - k\cdot 4^{k-1}     & 4^k - k\cdot 4^{k-1}
      \end{bmatrix}.
  \end{equation*}
\end{enumerate}
以上の式が実際に正しいことを $k=1,2,3$ の場合に確かめてみよ.
\qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[20点]
\label{q:shokichimondaiwotoke}
  次の微分方程式の初期値問題を解け:
  \begin{alignat*}{3}
    \ddot x & = - 2 x +   y, &
    x(0) & = - 1, &
    \dot x(0) & = 1, 
    \\
    \ddot y & =     x - 2 y, &
    \qquad y(0) & = 1, &
    \qquad \dot y(0) & = 1.
  \end{alignat*}
  ここで, $\dot x$, $\ddot x$, etc は $t$ による導函数 $dx/dt$,
  $d^2x/dt^2$, etc を表わしているものとする.  \qed
\end{question}

\noindent
ヒント: 縦ベクトル値函数 $u$ を % 
$u=\tp{[x, y]}$ と定め, 行列 $A$ を %
$A=\begin{bmatrix}-2&1\\1&-2\end{bmatrix}$ と定め, 縦ベクトル $u_0$, $u_1$ 
を $u_0=\tp{[-1, 1]}$, $u_1=\tp{[1, 1]}$ と定めると, 
問題の方程式は次のように書き直される:
\begin{equation*}
  \ddot u = Au, \qquad u(0)=u_0, \qquad \dot u(0)=u_1.
\end{equation*}
このとき, 可逆行列 $P$ を用いて, $u=Pv$ と置くと, この方程式は次のように変
形される:
\begin{equation*}
  \ddot v = P^{-1}APv, \qquad v(0)=P^{-1}u_0, \qquad \dot v(0)=P^{-1}u_1.
\end{equation*}
問題 \qref{q:normal-form-2.1} の方法を使うと, 適当な $P$ を見付けて %
$P^{-1}AP$ を実対角行列にできることがわかる. (実は, $P$ として直交行列がと
れることもわかる.) その対角成分は負であるので, 問題は次の形の微分方程式を解
くことに帰着されることがわかる:
\begin{equation*}
  \ddot z = - \alpha^2 z, \qquad z(0)=a, \qquad \dot z(0)= \alpha b
  \qquad (\alpha > 0).
\end{equation*}
この方程式の解は
\( %
  z = a \cos \alpha t + b \sin \alpha t
\) %
である.
\qed

\commentout{
\medskip
\noindent
略解: 
\( \displaystyle %
  P = \frac{1}{\sqrt{2}}
  \begin{bmatrix}
    1 & -1 \\
    1 & 1 
  \end{bmatrix}
\) %
と置くと, $P$ は直交行列(すなわち $P^{-1}=\tp{P}$)でかつ,
\( %
  P^{-1}AP =
  \begin{bmatrix}
    -1 &  0 \\
     0 & -3 
  \end{bmatrix}
\). %
よって,
\( %
  \begin{bmatrix} x \\ y \end{bmatrix} 
  = P \begin{bmatrix} X \\ Y \end{bmatrix} 
\) %
と置くと, 問題の方程式は次の方程式に変換される:
\begin{align*}
  & \ddot X = - X, \qquad X(0) = 0, \qquad \dot X(0) = \sqrt{2},
  \\
  & \ddot Y = - Y, \qquad Y(0) = \sqrt{2}, \qquad \dot Y(0) = 0.
\end{align*}
これを解くと,
\begin{equation*}
  X = \sqrt{2} \sin t, \qquad Y = \sqrt{2} \cos \sqrt{3} t.
\end{equation*}
よって, $x$, $y$ は
\begin{equation*}
  x = \sin t - \cos\sqrt{3}t, 
  \qquad
  y = \sin t + \cos\sqrt{3}t.
\end{equation*}
となる. 
\qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{$3$ 次以上の正方行列の特性多項式}
\label{sec:char-polyn}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[5点]
  $A$ は $n$ 次正方行列であり, $\alpha$ はその固有値であり, 
  $u$ は対応する固有ベクトルであるとする. 
  このとき, 文字 $\lambda$ の任意の多項式 $f(\lambda)$ に
  対して $f(A)u=f(\alpha)u$ が成立する. 
  \qed
\end{question}

\noindent 
ヒント: たとえば $f(\lambda)=\lambda^k$ のとき $f(A)u = A^k u = \alpha^k u$.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[8点]
  \label{q:char-poly-3.1}
  複素 $3$ 次正方行列 $A=[a_{ij}]$ の特性多項式 $p_A(\lambda)$ に対して以下
  が成立することを直接的な計算によって証明せよ: 
  \begin{enumerate}
  \item[(1)] 
    $p_A(\lambda) = \lambda^3 - \trace(A)\lambda^2 + b\lambda - \det(A)$.
    ここで,
    \begin{align*}
      &
      \trace(A) = a_{11} + a_{22} + a_{33}, 
      \\ &
      b = 
      \begin{vmatrix}
        a_{11} & a_{12} \\
        a_{21} & a_{22} \\
      \end{vmatrix}
      +
      \begin{vmatrix}
        a_{11} & a_{13} \\
        a_{31} & a_{33} \\
      \end{vmatrix}
      +
      \begin{vmatrix}
        a_{22} & a_{23} \\
        a_{32} & a_{33} \\
      \end{vmatrix},
      \\ &
      \det(A) =
        a_{11}a_{22}a_{33}
      + a_{12}a_{23}a_{31}
      + a_{13}a_{21}a_{32}
      - a_{11}a_{23}a_{32}
      - a_{13}a_{22}a_{31}
      - a_{12}a_{21}a_{33}.
    \end{align*}
  \item[(2)] \( p_A(A) = 0 \) \quad ($3$ 次正方行列の Cayley-Hamilton の定理).
  \qed
  \end{enumerate}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[20点]
  複素 $n$ 次正方行列 $A=[a_{ij}]$ の特性多項式を
  \begin{equation*}
    p_A(\lambda) 
    = \lambda^n - s_1 \lambda^{n-1} + s_2 \lambda^{t-2} + \cdots + (-1)^n s_n
  \end{equation*}
  と書くとき,
  \begin{equation*}
    s_k = \sum_{1\le i_1<\cdots<i_k\le n}
    \begin{vmatrix}
      a_{i_1i_1} & \cdots & a_{i_1i_k} \\
      \vdots     &        & \vdots \\
      a_{i_ki_1} & \cdots & a_{i_ki_k} \\
    \end{vmatrix}.
    \qed
  \end{equation*}
\end{question}

\noindent 
解説: この問題の結論は上の問題 \qref{q:char-poly-3.1} (1) の一般化になってい
る.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{$3$ 次正方行列の Jordan 標準形の求め方}
\label{sec:3x3-Jordan}

以下の問題 %
$\text{\qref{q:normal-form-3.1}},\ldots,\text{\qref{q:normal-form-3.5}}$ を
解く前に \qref{q:jordan-3x3-1} を先に解いて感じをつかんでおいた方が良いかも
しれない. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[10点]
  \label{q:normal-form-3.1}
  複素 $3$ 次正方行列 $A$ が
  互いに異なる3つの固有値 $\alpha$, $\beta$, $\gamma$ を持つとき, 
  以下が成立する:
  \begin{enumerate}
  \item[(1)] 
    $(A - \alpha E)(A - \beta E) \ne 0$ 
    かつ $(A - \alpha E)(A - \gamma E) \ne 0$ 
    かつ $(A - \beta E)(A - \gamma E) \ne 0$.
    (ヒント: $\gamma$ に対応する固有ベクトルに $(A - \alpha E)(A - \beta E)$ 
    を作用させると $0$ にならないことがわかる.)
  \item[(2)] 
    $(A - \beta E)(A - \gamma E)$ の $0$ でない列ベクトルの1つを $u$ と書き,
    $(A - \alpha E)(A - \gamma E)$ の $0$ でない列ベクトルの1つを $v$ と書き,
    $(A - \alpha E)(A - \beta E)$ の $0$ でない列ベクトルの1つを $w$ と書く
    ことにする.  このとき次が成立する:
    \begin{equation*}
      Au = \alpha u,  \quad  Av = \beta v, \quad Aw = \gamma w.
    \end{equation*}
    (ヒント: $(A-\alpha E)(A-\beta E)(A-\gamma E)=0$)
  \item[(3)] $3$ 次正方行列 $P$ を $P := [u, v, w]$ と定めると $P$ は逆行列
    を持つ. 
  \item[(4)] 次が成立する:
    \begin{equation*}
      P^{-1} A P 
      = 
      \begin{bmatrix}
        \alpha & 0 & 0 \\
        0 & \beta & 0 \\
        0 & 0 & \gamma \\
      \end{bmatrix}.
      \qed
    \end{equation*}
  \end{enumerate}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[15点]
  \label{q:normal-form-3.2}
  複素 $3$ 次正方行列 $A$ の特性多項式 $p_A(\lambda)$ は
  \begin{equation*}
    p_A(\lambda) = (\lambda - \alpha)^2 (\lambda - \gamma),
    \qquad \alpha \ne \gamma
  \end{equation*}
  という形をしており,
  \begin{equation*}
    (A - \alpha E)(A - \gamma E)\ne 0
  \end{equation*}
  が成立していると仮定する.  このとき, 以下が成立する:
  \begin{enumerate}
  \item[(1)] $(A - \alpha E)^2 \ne 0$.
    (ヒント: $\gamma$ に対応する固有ベクトルに $(A - \alpha E)^2$ 
    を作用させると $0$ にならないことがわかる.)
  \item[(2)] 
    $(A - \alpha E)(A - \gamma E)$ の $0$ でない列ベクトルの1つを $u$ と書き,
    $(A - \alpha E)^2$ の $0$ でない列ベクトルの1つを $w$ と書くことにする. 
    このとき次が成立する:
    \begin{equation*}
      Au = \alpha u,  \qquad Aw = \gamma w.
    \end{equation*}
  \item[(3)] $A - \gamma E$ の $0$ でない列ベクトル $v$ 
    で $u = (A - \alpha E)v$ を満たすものが存在する.
  \item[(4)] $3$ 次正方行列 $P$ を $P := [u, v, w]$ と定めると $P$ は逆行列
    を持つ. 
  \item[(5)] 次が成立する:
    \begin{equation*}
      P^{-1} A P 
      = 
      \begin{bmatrix}
        \alpha & 1 & 0 \\
        0 & \alpha & 0 \\
        0 & 0 & \gamma \\
      \end{bmatrix}.
      \qed
    \end{equation*}
  \end{enumerate}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[15点]
  \label{q:normal-form-3.3}
  複素 $3$ 次正方行列 $A$ の特性多項式 $p_A(\lambda)$ は
  \begin{equation*}
    p_A(\lambda) = (\lambda - \alpha)^2 (\lambda - \gamma),
    \qquad \alpha \ne \gamma
  \end{equation*}
  という形をしており,
  \begin{equation*}
    (A - \alpha E)(A - \gamma E) = 0
  \end{equation*}
  が成立していると仮定する.  このとき, 以下が成立する:
  \begin{enumerate}
  \item[(1)] $A - \alpha E$ の $0$ でない列ベクトル $w$ を取れる.
  \item[(2)] $A - \gamma E$ の2つの列ベクトル $u$, $v$ で一次独立なものを取
    れる.
    (ヒント: もしもそうでないならば $\rank(A - \gamma E) = 1$ となる.
    したがって $\gamma$ に対応する固有空間の次元
    は $3-\rank(A - \gamma E)=2$ になる.  そのとき, 
    特性多項式 $p_A(\lambda)$ は $(\lambda-\gamma)^2$ で割り切れる
    ので最初の仮定に反する.)
  \item[(3)] $3$ 次正方行列 $P$ を $P := [u, v, w]$ と定めると $P$ は逆行列
    を持つ. 
  \item[(4)] 次が成立する:
    \begin{equation*}
      P^{-1} A P 
      = 
      \begin{bmatrix}
        \alpha & 0 & 0 \\
        0 & \alpha & 0 \\
        0 & 0 & \gamma \\
      \end{bmatrix}.
      \qed
    \end{equation*}
  \end{enumerate}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[15点]
  \label{q:normal-form-3.4}
  複素 $3$ 次正方行列 $A$ の特性多項式 $p_A(\lambda)$ は
  \begin{equation*}
    p_A(\lambda) = (\lambda - \alpha)^3
  \end{equation*}
  という形をしており,
  \begin{equation*}
    (A - \alpha E)^2 \ne 0
  \end{equation*}
  が成立していると仮定する.  このとき, 以下が成立する:
  \begin{enumerate}
  \item[(1)] $(A - \alpha E)^2$ の $0$ でない列ベクトルの1つを $u$ とすると, 
    ある縦ベクトル $w$ で $u = (A - \alpha E)^2 w$ を満たすものが
    存在する.  $v = (A - \alpha E)w$ と置く.
  \item[(2)] $3$ 次正方行列 $P$ を $P := [u, v, w]$ と定めると $P$ は逆行列
    を持つ. 
  \item[(3)] 次が成立する:
    \begin{equation*}
      P^{-1} A P 
      = 
      \begin{bmatrix}
        \alpha & 1 & 0 \\
        0 & \alpha & 1 \\
        0 & 0 & \alpha \\
      \end{bmatrix}.
      \qed
    \end{equation*}
  \end{enumerate}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[15点]
  \label{q:normal-form-3.5}
  複素 $3$ 次正方行列 $A$ の特性多項式 $p_A(\lambda)$ は
  \begin{equation*}
    p_A(\lambda) = (\lambda - \alpha)^3
  \end{equation*}
  という形をしており,
  \begin{equation*}
    A \ne \alpha E, \qquad (A - \alpha E)^2 = 0
  \end{equation*}
  が成立していると仮定する.  このとき, 以下が成立する:
  \begin{enumerate}
  \item[(1)] $A - \alpha E$ の $0$ でない列ベクトルの1つを $u$ とする.
    ある縦ベクトル $v$ で $(A - \alpha E)v = u$ を満たすものが存在する.
  \item[(2)] $u$ と一次独立な縦ベクトル $w$ で $Aw=\alpha w$ を満たすものが
    存在する.  (ヒント: もしもそうでなければ $3 - \rank(A - \alpha) = 1$ で
    ある.  しかし, $(A - \alpha E)^2 = 0$ より %
    $2(3 - \rank(A - \alpha E)) \ge 3$ であるから, 矛盾する.)
  \item[(3)] $3$ 次正方行列 $P$ を $P := [u, v, w]$ と定めると $P$ は逆行列
    を持つ. 
  \item[(4)] 次が成立する:
    \begin{equation*}
      P^{-1} A P 
      = 
      \begin{bmatrix}
        \alpha & 1 & 0 \\
        0 & \alpha & 0 \\
        0 & 0 & \alpha \\
      \end{bmatrix}.
      \qed
    \end{equation*}
  \end{enumerate}
\end{question}

以上によって, 複素 $3$ 次正方行列 $A$ に対して, 正則行列 $P$ をうまくとって,
$P^{-1}AP$ を次のどれかの形にできることがわかった:
\begin{equation*}
  \begin{bmatrix}
    \alpha & 0 & 0 \\
    0 & \beta  & 0 \\
    0 & 0 & \gamma \\
  \end{bmatrix},
  \qquad
  \begin{bmatrix}
    \alpha & 1 & 0 \\
    0 & \alpha & 0 \\
    0 & 0 & \gamma \\
  \end{bmatrix},
  \qquad
  \begin{bmatrix}
    \alpha & 1 & 0 \\
    0 & \alpha & 1 \\
    0 & 0 & \alpha \\
  \end{bmatrix}.
\end{equation*}
すなわち, 複素 $3$ 次正方行列は上の形の行列のどれかに相似である.  この形の行
列を {\bf Jordan 標準形}と呼ぶ.

この結果は任意の複素 $n$ 次正方行列 (より一般には代数閉体上の $n$ 次正方行列)
に対して拡張される(Jordan標準型の理論).  以上の $n=3$ の場合でもまだわかり難
いかもしれないが, 任意の複素 $n$ 次正方行列 $A$ は問題 \qref{q:exp-Jordan} 
の $J = J(k,\alpha)$ の形の行列を対角線に並べた行列と相似になることを証明で
きる.  $A$ と相似な $J$ の形の行列を対角線に並べた行列を $A$ の{\bf Jordan 
標準形} と呼ぶ.  $J$ の形の行列を並べる順序だけが違う Jordan 標準形は同じも
のだとみなす.  二つの複素 $n$ 次正方行列 (より一般には代数閉体上の二つの $n$ 
次正方行列) が互いに相似であるための必要十分条件は同じ Jordan 標準形を持つこ
とであることが講義の方で証明されることになる.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[小問各8点]
\label{q:jordan-3x3-1}
  以下の行列の Jordan 標準形と標準形に相似変換する行列を求めよ:
  \begin{equation*}
    \text{(1)}\quad
    A =
    \begin{bmatrix}
      -1 &  0 &  0 \\
      -5 &  2 &  3 \\
      -1 &  0 & -1 \\
    \end{bmatrix},
    \qquad
    \text{(2)}\quad
    B =
    \begin{bmatrix}
      3 & 0 & -1 \\
      1 & 4 & -7 \\
      0 & 1 & -1 \\
    \end{bmatrix}.
    \qed
  \end{equation*}
\end{question}

\noindent
ヒント: (1) $p_A(\lambda)=(\lambda+1)^2(\lambda-2)$ で
かつ $(A+E)(A-2E)\ne 0$ なので問題 \qref{q:normal-form-3.2} を使えば良い. 
(2) $p_B(\lambda)=(\lambda-2)^3$ でかつ $(A-2E)^2\ne0$ なので
問題 \qref{q:normal-form-3.4} を使えば良い.

\commentout{
\medskip\noindent
略解: 計算結果は次のようになる:
\begin{align*}
  &
  \text{(1)} \quad
  A = PJP^{-1},
  \quad
  P =
  \begin{bmatrix}
     0 &  1 &  0 \\
     1 &  1 & -1 \\
    -1 &  1 &  0 \\
  \end{bmatrix},
  \quad
  J = 
  \begin{bmatrix}
    -1 &  1 &  0 \\
     0 & -1 &  0 \\
     0 &  0 &  2 \\
  \end{bmatrix},
  \\ &
  \text{(2)} \quad
  B = QKQ^{-1},
  \quad
  Q =
  \begin{bmatrix}
    1 & 1 & 1 \\
    3 & 1 & 0 \\
    1 & 0 & 0 \\
  \end{bmatrix},
  \quad
  K = 
  \begin{bmatrix}
    2 & 1 & 0 \\
    0 & 2 & 1 \\
    0 & 0 & 2 \\
  \end{bmatrix}.
  \qed
\end{align*}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{行列の指数函数}
\label{sec:exp}

複素 $n$ 次正方行列 $A$ の指数函数 $\exp A = e^A$ を次のように定める:
\begin{equation*}
  \exp A = e^A 
  = \sum_{k=0}^\infty \frac{1}{k!} A^k
  = E + A + \frac{1}{2}A^2 + \frac{1}{3!}A^3 + \frac{1}{4!}A^4 + \cdots.
\end{equation*}
ここで $E$ は単位行列である.
この演習では, この定義の無限級数が複素正方行列 $A$ に関して広義一様絶対収束
するという事実や $A$ の成分に関する偏微分を項別微分によって計算できるという
事実などを証明抜きで自由に用いて良い.  無限級数の収束性などについては気にせ
ずに形式的な計算を自由に行なって良い.

\bigskip

{\Large この演習の主要な目標の一つは
具体的に与えられた正方行列 $A$ に対して $e^{At}$ を
計算できるようになることである.}

\bigskip

他にも様々な目標があるが, この演習を受講する人はこの目標を常に頭の片隅に置い
ておくことが望ましい.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{行列の指数函数の基本性質}
\label{sec:sec-exp-properties}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[8点]
  $A$ は複素正方行列であるとする. 
  このとき, 複素数 $t$ の行列値函数 $e^{At}$ は次を満たしている:
  \begin{equation*}
    \od{t}e^{At} = A e^{At} = e^{At} A,
    \qquad e^{A0} = E.
    \qed
  \end{equation*}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[8点]
  $A$, $P$ は複素 $n$ 次正方行列であり, $P$ は逆行列を持つと仮定する.
  このとき,
  \begin{equation*}
    e^{PAP^{-1}} = P e^A P^{-1}.
    \qed
  \end{equation*}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[15点]
  \label{q:exp(A+B)}
  2つの複素 $n$ 次正方行列 $A$, $B$ が互いに可換%
  \footnote{$A$ と $B$ が{\bf 可換 (commutative)} であるとは $AB = BA$ が成
    立することである.}%
  ならば,
  \begin{equation*}
    e^{A+B} = e^A e^B = e^B e^A.
    \qed
  \end{equation*}
\end{question}

\noindent
ヒント: $AB=BA$ であれば次の二項定理を利用できる:
\begin{equation*}
  (A + B)^k = \sum_{i=0}^k \binom{k}{i} A^i B^{k-i}.
\end{equation*}
ここで,
\begin{equation*}
  \binom{k}{i} = \frac{k!}{i!(k-i)!}.
\qed
\end{equation*}

\medskip
\noindent 
注意: 可換性の仮定は本質的である.  その条件を外すとこの問題の結論は一般に成
立しなくなる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[15点]
  \(
    A =
    \begin{bmatrix}
      1 & 0 \\
      0 & -1 \\
    \end{bmatrix}
  \) と %
  \(
    B =
    \begin{bmatrix}
      0 & 1 \\
      0 & 0 \\
    \end{bmatrix}
  \) に対して $e^{At+Bs}$, $e^{At} e^{Bs}$, $e^{Bs} e^{At}$ は互いに異なる.
  \qed
\end{question}

\noindent
ヒント:   \(
  e^{At} =
  \begin{bmatrix}
    e^t & 0 \\
    0 & e^{-t} \\
  \end{bmatrix}
\), \(
  e^{Bs} =
  \begin{bmatrix}
    1 & s \\
    0 & 1 \\
  \end{bmatrix}
\), \(
  e^{At+Bs} =
  \begin{bmatrix}
    e^t & s t^{-1} \sinh t \\
    0 & e^{-t} \\
  \end{bmatrix}
\).
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{簡単に計算できる行列の指数函数の例}
\label{sec:sec-exp-easy}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[15点]
  複素正方行列 $A$, $B$, $C$ を次のように定義する:
  \begin{equation*}
    A =
    \begin{bmatrix}
      \alpha & 0 \\
      0 & \beta \\
    \end{bmatrix},
    \quad
    B =
    \begin{bmatrix}
      \alpha & 1 \\
      0 & \alpha \\
    \end{bmatrix},
    \quad
    C =
    \begin{bmatrix}
      0 & -1 \\
      1 &  0 \\
    \end{bmatrix}.
  \end{equation*}
  ここで $\alpha,\beta\in\C$ である. 
  $e^{At}$, $e^{Bt}$, $e^{Ct}$ を計算せよ. 
  $e^{C(t+s)} = e^{Ct}e^{Cs}$ から三角函数の加法公式を導け.
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[簡単なので5点]
  $A$ は複素 $m$ 次正方行列であり, $B$ は複素 $n$ 次正方行列であるとし, %
  $m+n$ 次正方行列 $X$ を %
  \(
    X =
    \begin{bmatrix}
      A & 0 \\
      0 & B \\
    \end{bmatrix}
  \)
  と定める. このとき, %
  \(
    e^X =
    \begin{bmatrix}
      e^A & 0 \\
      0 & e^B \\
    \end{bmatrix}.
    \qed
  \)
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[15点]
  \label{q:exp-Jordan}
  複素数 $\alpha$ に対して $k$ 次正方行列 $J = J(k,\alpha)$ を次のように定め
  る:
  \begin{equation*}
    J = J(k,\alpha) = 
    \begin{bmatrix}
    \alpha   & 1      &        & \bigzerou \\
             & \alpha & \ddots &   \\
             &        & \ddots & 1 \\
    \bigzerol &     &        & \alpha
    \end{bmatrix}
    \quad (\text{$k$ 次正方行列}).
  \end{equation*}
  この形の行列を {\bf Jordan ブロック}と呼ぶ.
  $e^{Jt}$ を計算せよ. \qed
\end{question}

\noindent
ヒント: 対角成分の一つ右上に $1$ が並び他の成分が $0$ の $n$ 次
正方行列を $N$ と書くと, $J = \alpha E + N$ である. 
$\alpha E$ と $N$ は互いに可換なので, \qref{q:exp(A+B)} より,
\begin{equation*}
  e^{Jt} = e^{\alpha t E} e^{tN} = e^{\alpha t} e^{tN}.
\end{equation*}
よって, $e^{tN}$ を計算すれば良い.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{定数係数線形常微分方程式と定数係数線形差分方程式への応用}
\label{sec:sec-exp-app}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\bigskip

函数 $f$ に対して, 
\begin{equation*}
  a_n(x)f^{(n)}+a_{n-1}(x)f^{(n-1)}+\cdots+a_2(x)f''+a_1(x)f'+a_0(x)f
\end{equation*}
を対応させる微分作用素を
\begin{equation*}
  a_n(x)\partial^n+\cdots+a_2(x)\partial^2+a_1(x)\partial+a_0(x)
\end{equation*}
と書くことにする. 例えば, 
\begin{align*}
  & \partial f = df/dx = f', \\
  & (\partial^2 + a(x)) f = f'' + a(x)f, \\
  & (\partial + a(x))(\partial + b(x))f = (\partial + a(x))(f'+b(x)f) \\
  & \quad
    = f'' +(b(x)f)' + a(x)(f'+b(x)f) 
    = f'' + (a(x)+b(x))f' + (b'(x) + a(x)b(x)) f.
\end{align*}

\begin{question}[25点]
  次の線形常微分方程式の解空間を求めよ:
  \begin{equation*}
    (\partial - \alpha_1)^{k_1} \cdots (\partial - \alpha_m)^{k_m} u = 0.
  \end{equation*}
  ここで, $\alpha_1,\ldots,\alpha_m$ は互いに異なる複素数であり, 
  $k_1,\ldots,k_m$ は正の整数であるとする.
  \qed
\end{question}

\noindent ヒント: 公式 %
\( %
  \partial (e^{\alpha x} f) = e^{\alpha x} (\partial + \alpha) f
\) %
より,
\( %
  (\partial - \alpha)^k(e^{\alpha x} f)
  = e^{\alpha x} \partial^k f
\) %
が成立することがわかる. これより, 線形常微分方程式
\begin{equation*}
  (\partial - \alpha)^k u = 0
  \tag{$*$}
\end{equation*}
の任意の解は
\begin{equation*}
  u = (a_0 + a_1 x + \cdots + a_{k-1} x^{k-1}) e^{\alpha x},
  \qquad
  \text{$a_i$ は定数}
\end{equation*}
と表わされることがわかる. なお, 上の問題を解くために, 
問題の方程式の解の全体が自然に $(k_1 + \cdots + k_m)$ 次元のベクトル空間をな
すという結果を用いて良い. 
\qed

\medskip
\noindent
参考: $v_0,v_1,\ldots,v_{k-1}$ を
\( %
  v_j = (\partial - \alpha)^j u
  \quad
  (j=0,1,\ldots,k-1)
\) %
と定め, 
\begin{equation*}
  v =
  \begin{bmatrix}
    v_0 \\ \vdots \\ v_{k-1}
  \end{bmatrix},
  \quad
  J =
  \begin{bmatrix}
    \alpha   & 1      &        & \bigzerou \\
             & \alpha & \ddots &   \\
             &        & \ddots & 1 \\
    \bigzerol &     &        & \alpha
  \end{bmatrix}
  \quad (\text{$k$ 次正方行列})
\end{equation*}
と置くと, 方程式 ($*$) は方程式 $\partial v = J v$ に変換される.
$J$ が Jordan ブロックの形になっていることに注意せよ.
線形常微分方程式 $\partial v = J v$ の一般解は
\begin{equation*}
  v = e^{Jx}v_0, \qquad \text{$v_0$ は定数ベクトル}
\end{equation*}
と書ける.  この結果に問題 \qref{q:exp-Jordan} を適用しても上のヒントの結論が
得られる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\bigskip

整数 $x\in\Z$ の函数 $f(x)$ に対して, 整数 $x$ の函数
\begin{equation*}
  x\mapsto
  a_n(x)f(x+n)+a_{n-1}(x)f(x+n-1)+\cdots+a_1(x)f(x+1)+a_0(x)f(x)
\end{equation*}
を対応させる差分作用素を
\begin{equation*}
  a_n(x)\sigma^n+a_{n-1}(x)\sigma^{n-1}
  +\cdots+a_2(x)\sigma^2+a_1(x)\sigma+a_0(x)
\end{equation*}
と書くことにする. 例えば, 
\begin{align*}
  & \sigma f(x) = f(x+1), \\
  & (\sigma^2 + a(x))f(x) = f(x+1) + a(x)f(x), \\
  & (\sigma + a(x))(\sigma + b(x))f(x) = (\sigma + a(x))(f(x+1)+b(x)f(x)) \\
  & \quad
    = f(x+2) + b(x+1)f(x+1) + a(x)(f(x+1)+b(x)f(x)) \\
  & \quad
    = f(x+2) + (a(x)+b(x+1))f(x+1) + (b(x+1) + a(x)b(x))f(x).
\end{align*}

\begin{question}[25点]
  次の線形差分方程式の解空間を求めよ:
  \begin{equation*}
    (\sigma - \alpha_1)^{k_1} \cdots (\sigma - \alpha_m)^{k_m} u = 0.
  \end{equation*}
  ここで, $\alpha_1,\ldots,\alpha_m$ は $0$ でない互いに異なる複素数で
  あり, $k_1,\ldots,k_m$ は正の整数であるとする.
  \qed
\end{question}

\noindent ヒント: 公式 %
\( %
  (\sigma-\alpha)(\alpha^x f(x)) = \alpha^{x+1}(\sigma-1)f(x)
\) %
より,
\( %
  (\sigma - \alpha)^k(\alpha^xf(x))
  = \alpha^{x+k}(\sigma-1)^k f(x)
\) %
が成立することがわかる. これより, $\alpha\ne0$ のとき線形差分方程式
\begin{equation*}
  (\sigma - \alpha)^k u = 0
  \tag{$*$}
\end{equation*}
の任意の解は
\begin{equation*}
  u(x) = (a_0 + a_1 x + a_2 x^{[2]}+\cdots + a_{k-1} x^{[k-1]}) \alpha^x,
  \qquad
  \text{$a_i$ は定数}
\end{equation*}
と表わされることがわかる. ここで,
\begin{equation*}
  x^{[i]} = x(x-1)\cdots(x-i+1)
\end{equation*}
である. $x^{[i]}$ は $(\sigma - 1)x^{[i]}=ix^{[i-1]}$ を満たしている.
\qed

\medskip
\noindent
参考: $v_0,v_1,\ldots,v_{k-1}$ を
\( %
  v_j = (\sigma - \alpha)^j u
  \quad
  (j=0,1,\ldots,k-1)
\) %
と定め, 
\begin{equation*}
  v =
  \begin{bmatrix}
    v_0 \\ \vdots \\ v_{k-1}
  \end{bmatrix},
  \quad
  J =
  \begin{bmatrix}
    \alpha   & 1      &        & \bigzerou \\
             & \alpha & \ddots &   \\
             &        & \ddots & 1 \\
    \bigzerol &     &        & \alpha
  \end{bmatrix}
  \quad (\text{$k$ 次正方行列})
\end{equation*}
と置くと, 方程式 ($*$) は方程式 $\sigma v = J v$ に変換される.
$J$ が Jordan ブロックの形になっていることに注意せよ.
線形差分方程式 $\sigma v = J v$ の一般解は次のようになる:
\begin{equation*}
  v = J^x v_0, \qquad \text{$v_0$ は定数ベクトル}
\end{equation*}
と書ける.  この結果を用いて上のヒントの結論を導くこともできる. 

対角成分の一つ右上に $1$ が並び他の成分が $0$ の $n$ 次
正方行列を $N$ と書くと, $J = \alpha E + N$ である. 
$\alpha E$ と $N$ は互いに可換なので, 
$x$ が $0$ 以上の整数のとき二項定理が適用できる. $N^k=0$ であるから,
\begin{equation*}
  J^x 
  = (\alpha E + N)^x 
  = \sum_{i=0}^{k-1} \binom{x}{i} \alpha^{x-i}N^i.
\end{equation*}
ここで,
\begin{equation*}
  \binom{x}{i} = \frac{x(x-1)\cdots(x-i+1)}{i!} = \frac{x^{[i]}}{i!}.
\end{equation*}
これは $x$ が負の整数であっても定義されていることに注意せよ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[10点]
  整数 $x$ の函数 $u$ に関する次の線形差分方程式の解空間を求めよ:
  \begin{equation*}
    u(x+2) - 5 u(x+1) + 6 u(x) = 0.
  \qed
  \end{equation*}
\end{question}

\noindent
ヒント: この問題の方程式は $(\sigma-2)(\sigma-3)u = 0$ と書き直せる. 
よって, 解は $u(x) =  a 2^x + b 3^x$ の形をしている.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[10点]
  整数 $x$ の函数 $u$ に関する次の線形差分方程式の解空間を求めよ:
  \begin{equation*}
    u(x+2) - 4 u(x+1) + 4 u(x) = 0.
  \qed
  \end{equation*}
\end{question}

\noindent
ヒント: この問題の方程式は $(\sigma-2)^2 u = 0$ と書き直せる. よって,
解は $u(x) =  2^x(a + bx)$ の形をしている.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Cayley-Hamilton の定理}
\label{sec:Cayley-Hamilton}

以下, 単に「数」「$n$ 次正方行列」を言えば「複素数」「複素 $n$ 次正方行列」
であることにする.  体について知っている人は「体 $K$ の元」「$K$ の元を成分に
持つ $n$ 次正方行列」であると考えても良い.  $E$ は $n$ 次単位行列であるとす
る. 

数を係数とする多項式 $f(\lambda)=\sum_{i=1}^N a_i\lambda^i$ と $n$ 次正方行
列 $A$ に対して, $n$ 次正方行列 $f(A)$ を次のように定義する:
\begin{equation*}
  f(A) = \sum_{i=0}^N a_i A^i 
  = a_N A^N + a_{N-1}A^{N-1} + \cdots + a_1 A + a_0 E
\end{equation*}
$f(\lambda)$ の定数項 $a_0$ が $f(A)$ では $a_0 E$ となっていることに注意せ
よ.

\begin{theorem}[Cayley-Hamilton の定理]
  任意の $n$ 次正方行列 $A$ と
  その特性多項式 $p_A(\lambda)=\det(\lambda E - A)$ に
  ついて $p_A(A)=0$.  \qed
\end{theorem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Cayley-Hamilton の定理の直接的証明}
\label{sec:CH-direct}

{\bf Cayley-Hamilton の定理の直接的証明:} 
$A=[a_{ij}]$ は $n$ 次正方行列であるとし, 
その特性多項式を $p_A(\lambda)=\det(\lambda E - A)$ と表わす.
$\lambda E - A$ の $(i,j)$ 余因子を $f_{ij}(\lambda)$ と書くと,
\begin{equation*}
  p_A(\lambda)\delta_{ik}
  = \sum_{j=1}^n f_{ij}(\lambda) (\delta_{kj}\lambda - a_{kj}).
\end{equation*}
この等式の両辺は $\lambda$ の多項式なので $\lambda$ に $A$ を代入できる:
\begin{equation*}
  p_A(A)\delta_{ik} = \sum_{j=1}^n f_{ij}(A)(\delta_{kj}A - a_{kj}E).
\end{equation*}
さらにこの等式の両辺を $e_k$ に%
\footnote{$e_1,\dots,e_n$ は $K^n$ の標準的な基底.}%
左から作用させて $k=1,\dots,n$ について和を取ると, 
\begin{equation*}
  p_A(A)e_i
  = \sum_{j=1}^n f_{ij}(A)\Bigl( A e_j - \sum_{k=1}^n a_{kj} e_k \Bigr)
  = 0.
\end{equation*}
最後の等号は $Ae_j=\sum_{k=1}^n e_k a_{kj}$ から出る. 
よって $p_A(A)=0$ である.
\qed

\begin{question}[15点]
  上の証明の細部を埋め, 黒板を用いて詳しく説明せよ. \qed
\end{question}

Cayley-Hamilton の定理の上のような証明の背後には
行列係数の多項式の剰余定理が隠れている.  
直接的に行列版の剰余定理を用いることを避けている分だけ
証明が簡単になっている.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{行列係数多項式の剰余定理を用いた証明}
\label{sec:CH-remainder}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

以下の証明の方針は杉浦 \cite{sugiura} の65--66頁にある.  

\begin{question}[行列係数多項式の剰余定理, 20点]
\label{q:matrix-remainder-theorem}
  $A$ は $n$ 次正方行列であり, 
  $F(\lambda)$ は $n$ 次正方行列を係数とする $\lambda$ の多項式であるとする:
  \begin{equation*}
    F(\lambda) = \sum_{i=0}^N F_i \lambda^i = \sum_{i=0}^N \lambda^i F_i,
    \qquad \text{$F_i$ は $n$ 次正方行列}.
  \end{equation*}
  このとき, 以下が成立する:
  \begin{enumerate}
  \item[(1)] $n$ 次正方行列 $R$ と $n$ 次正方行列を係数とする $\lambda$ の多 
    項式 $Q(\lambda)$ で
    \begin{equation*}
      F(\lambda) = Q(\lambda)(\lambda E - A) + R
    \end{equation*}
    を満たすものが一意に存在し, 次が成立する:
    \begin{equation*}
      R = \sum_{i=0}^N F_i A^i.
    \end{equation*}
  \item[(2)] $n$ 次正方行列 $R$ と $n$ 次正方行列を係数とする $\lambda$ の多 
    項式 $Q(\lambda)$ で
    \begin{equation*}
      F(\lambda) = (\lambda E - A)Q(\lambda) + R
    \end{equation*}
    を満たすものが一意に存在し, 次が成立する:
    \begin{equation*}
      R = \sum_{i=0}^N A^i F_i.
    \end{equation*}
  \item[(3)] 数が係数の任意の多項式 $f(\lambda)$ に対して, 
    $f(A)=0$ (行列としてゼロ) が成立するための必要十分条件は
    ある $n$ 次正方行列係数の多項式 $G(\lambda)$ 
    で $f(\lambda)E = G(\lambda)(\lambda E - A)$ を満たすものが
    存在することである.
  \item[(4)] 数が係数の任意の多項式 $f(\lambda)$ に対して, 
    $f(A)=0$ (行列としてゼロ) が成立するための必要十分条件は
    ある $n$ 次正方行列係数の多項式 $G(\lambda)$ 
    で $f(\lambda)E = (\lambda E - A)G(\lambda)$ を満たすものが
    存在することである.
    \qed
  \end{enumerate}
\end{question}

\noindent
ヒント: $\lambda E - A$ に関して割り算の筆算の仕方がそのまま成立していること 
がすぐにわかる.  ただし, 行列の積の順序は一般に交換不可能なので右割り算と左
割り算の区別をしなければいけないことに注意しなければいけない.
たとえば $N=3$ の場合にその筆算を実行してみよ.  
一般の $N$ でも場合も同様であることがすぐに納得できるだろう.

証明の方針は以下の通り. 
(2), (4) は (1), (3) と同様に証明できるので, (1), (3) のみについて証明の方針
を説明する.

(1)の証明の方針: $N$ に関する数学的帰納法によって $R$, $Q(\lambda)$ の存在
を証明する.  (帰納法の仮定に $R$ の形に関する仮定も入れておく.)
$R$, $Q(\lambda)$ の一意性を示すために, $R_1$, $Q_1(\lambda)$ 
も $F(\lambda) = Q_1(\lambda)(\lambda E - A) + R_1$ を満たしていると仮定する.  
そのとき, $(Q(\lambda) - Q_1(\lambda))(\lambda E - A) = R_1 - R$ であるから, 
もしも $Q(\lambda) \ne Q_1(\lambda)$ ならば左辺には $\lambda$ を含む項が残る
が, 右辺は定数行列なので矛盾する. 
よって, $Q(\lambda) = Q_1(\lambda)$ かつ $R_1 = R$ である. 

(3)の証明の方針: $F(\lambda)=f(\lambda)E$ に (1) を適用すれば, ある行列係数
の多項式 $Q(\lambda)$ が存在して
\begin{equation*}
  f(\lambda)E = Q(\lambda)(\lambda E - A) + f(A)
\end{equation*}
が成立する.  よって, $f(A)=0$ ならば $G(\lambda)=Q(\lambda)$ と
置けば $f(\lambda)E = G(\lambda)(\lambda E - A)$ を満たす $G(\lambda)$ の存
在が示される.  逆に, そのような $G(\lambda)$ が存在するならば, (1) の一意性
の主張より $G(\lambda)=Q(\lambda)$ かつ $0 = f(A)$ である. 
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\medskip
\noindent
参考: 一般に行列係数のモニックな多項式による割り算も同様に可能である.  ここ
で, 行列係数の多項式が{\bf モニック (monic)} であるとは最高次の係数が単位行
列であることである.

\begin{question}[15点]
  $F(\lambda)$, $A(\lambda)$ は $n$ 次正方行列係数の多項式であり, 
  $A(\lambda)$ はモニックでかつ $d$ 次であるとする
  (すなわち $A(\lambda)$ の最高次の項は $E \lambda^d$). 
  このとき, $n$ 次正方行列係数の多項式 $Q(\lambda)$ と
  次数が $d-1$ 以下の $n$ 次正方行列係数の多項式 $R(\lambda)$ で
  \begin{equation*}
    F(\lambda) = Q(\lambda)A(\lambda) + R(\lambda)
  \end{equation*}
  を満たすものが一意的に存在する. \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[15点]
  問題 \qref{q:matrix-remainder-theorem} の(3)または(4)を用いて, 
  Cayley-Hamilton の定理を証明せよ. \qed
\end{question}

\noindent
ヒント: 一般に $n$ 次正方行列 $X$ に対して,
その $(j,i)$ 余因子を $(i,j)$ 成分に持つ $n$ 次正方行列を $\Delta$ と
書くと, $\Delta X = X \Delta = \det(X)E$ が成立する.  
この結果を $X = \lambda E - A$ に適用する.  $\lambda E - A$ 
の $(j,i)$ 余因子を $(i,j)$ 成分に持つ行列を $G(\lambda)$ と書くと, 
$G(\lambda)(\lambda E - A) = (\lambda E - A)G(\lambda) = p_A(\lambda) E$.
\qed

\bigskip
\noindent
{\large {\bf まとめ:} 数を係数とする多項式に関する剰余定理は行列を係数とする
  多項式に拡張される.  行列版の剰余定理を前提にすれば行列式に関する基本的な
  結果から Cayley-Hamilton の定理がただちに導かれる.}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{正方行列の三角化可能性を用いた証明}
\label{sec:CH-triangulation}

Cayley-Hamilton の定理は別のやり方でも証明できる.  以下では最も素朴な方法だ
と考えられる行列の三角化可能性を用いた証明を紹介しよう.

\begin{question}[10点]
\label{q:nilpotent-matrix}
  $A$ は対角成分がすべて $0$ であるような上三角 $n$ 次正方行列であるとする.
  このとき $A^n=0$.
  \qed
\end{question}

\noindent
ヒント: $A$ の $(i,j)$ 成分を $a_{ij}$ と書くと, 
$A$ に関する仮定は $a_{ij}=0$ ($j<i+1$) と同値になる.
$A^p$ の $(i,j)$ 成分が $j<i+p$ のとき $0$ になることを示せ.
$p=1,2,3,\ldots$ に対して $A^p$ を計算するとその $0$ でない成分の
ありかがだんだん右上に移動して行く.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[複素正方行列の三角化可能性, 20点]
\label{q:triangularizable2}
  $A$ は複素 $n$ 次正方行列であるとする%
  \footnote{代数閉体の元を成分に持つ行列を考えても良い.}.  %
  $A$ の特性多項式 $p_A(\lambda)=\det(\lambda E - A)$ の互いに異なる根の全体
  は $\alpha_1,\ldots,\alpha_r$ であり, $p_A(\lambda)$ は次のように表わされ
  ているとする:
  \begin{equation*}
    p_A(\lambda)=\det(\lambda E - A)
    = (\lambda-\alpha_1)^{n_1}\cdots(\lambda-\alpha_r)^{n_r}.
  \end{equation*}
  このとき, 正則な複素 $n$ 次正方行列 $P$ で $P^{-1}AP$ が上三角行列になり, 
  しかも $P^{-1}AP$ の対角部分が特性多項式の根を重複を含めて全部並べ
  た $\diag(\alpha_1,\dots,\alpha_1,\dots,\alpha_r,\dots,\alpha_r)$ 
  (各 $\alpha_i$ が $n_i$ 個ずつ順番に並ぶ) に等しくなるものが存在する.
  \qed
\end{question}

\begin{proof}[ヒント]
$n$ に関する数学的帰納法.  $A$ の固有値 $\alpha$ とそれに付随する固
有ベクトル $v$ が存在する. $v$ は単位ベクトルに取れ, $v$ を含む
正規直交基底 $p_1=v,p_2,\dots,p_n$ が取れる.  
このとき, $P=[p_1\ \cdots\ p_n]$ と置くと, $P^{-1}AP$ は次の形になる:
\begin{equation*}
  P^{-1}AP = 
  \begin{bmatrix}
    \alpha & b_{12} & \cdots & b_{1n} \\
       0   & b_{22} & \cdots & b_{2n} \\
    \vdots & \vdots &        & \vdots \\
       0   & b_{n2} & \cdots & b_{nn} \\
  \end{bmatrix}.
\end{equation*}
行列 $B=[b_{ij}]_{2\le i,j\le n}$ に帰納法の仮定を用いよ.
\qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[15点]
  問題 \qref{q:nilpotent-matrix}, \qref{q:triangularizable2} の結果を
  用いて Cayley-Hamilton の定理を証明せよ. \qed
\end{question}

\noindent
ヒント: $p_A(P^{-1}AP)=P^{-1}p_A(A)P$ より, 
$A$ は問題 \qref{q:triangularizable2} における $P^{-1}AP$ の
形をしていると仮定して良い.  $A$ の対角線部分には
対角成分がすべて $\alpha_i$ であるような $n_i$ 次の上三角行列が並んでいると
みなせる.  よって, $(A-\alpha_j E)^{n_j}$ の対角線部分には
対角成分がすべて $(\alpha_i-\alpha_j)^{n_i}$ であるような $n_i$ 次上三角行列
が並ぶ.  ただし, $i=j$ 番目のブロックは問題 \qref{q:nilpotent-matrix} の
結果より $n_j$ 次の巾零行列になる.  
実はこのことだけから $(A-\alpha_j)^{n_j}$ を $j=1,\dots,r$ について掛け合わ
せると零行列になることを示せる.  たとえば $r=4$ の場合は
\begin{align*}
  &
  \begin{bmatrix}
    0 & * & * & * \\
      & * & * & * \\
      &   & * & * \\
      &   &   & * \\
  \end{bmatrix}
  \begin{bmatrix}
    * & * & * & * \\
      & 0 & * & * \\
      &   & * & * \\
      &   &   & * \\
  \end{bmatrix}
  \begin{bmatrix}
    * & * & * & * \\
      & * & * & * \\
      &   & 0 & * \\
      &   &   & * \\
  \end{bmatrix}
  \begin{bmatrix}
    * & * & * & * \\
      & * & * & * \\
      &   & * & * \\
      &   &   & 0 \\
  \end{bmatrix}
  \\
  = &
  \begin{bmatrix}
    0 & 0 & * & * \\
      & 0 & * & * \\
      &   & * & * \\
      &   &   & * \\
  \end{bmatrix}
  \begin{bmatrix}
    * & * & * & * \\
      & * & * & * \\
      &   & 0 & * \\
      &   &   & * \\
  \end{bmatrix}
  \begin{bmatrix}
    * & * & * & * \\
      & * & * & * \\
      &   & * & * \\
      &   &   & 0 \\
  \end{bmatrix}
  \\
  = &
  \begin{bmatrix}
    0 & 0 & 0 & * \\
      & 0 & 0 & * \\
      &   & 0 & * \\
      &   &   & * \\
  \end{bmatrix}
  \begin{bmatrix}
    * & * & * & * \\
      & * & * & * \\
      &   & * & * \\
      &   &   & 0 \\
  \end{bmatrix}
  \\
  = &
  \begin{bmatrix}
    0 & 0 & 0 & 0 \\
      & 0 & 0 & 0 \\
      &   & 0 & 0 \\
      &   &   & 0 \\
  \end{bmatrix}.
  \qed
\end{align*}

\bigskip
\noindent
{\large {\bf まとめ:} 複素 $n$ 次正方行列%
  \footnote{もしくは代数閉体の元を成分に持つ $n$ 次正方行列}
  の三角化可能性を $n$ に関する帰納法で証明できる.
  その結果から Cayley-Hamilton の定理がただちに導かれる.}

\bigskip
\noindent
比較: \secref{sec:CH-direct}と\secref{sec:CH-remainder}の方法の特徴は
特性多項式の根 (固有値) を一切使わずに Cayley-Hamilton の定理を
証明できたことである.  
そのために行列式に関する基本的な結果と
(本質的に)行列係数多項式の剰余定理を用いた.  
それに対して\secref{sec:CH-triangulation}では
行列係数多項式の剰余定理を用いていないが, 
特性多項式の根を本質的に用いている.  
特性多項式の根を自由に利用するためには代数学の基本定理%
\footnote{代数学の基本定理とは「1次以上の複素係数1変数多項式は複素数の中に
  必ず根を持つ」という定理である.}
が必要になる%
\footnote{複素数体の部分体 (例えば実数体や有理数体) の元を成分に持つ行列
  ではなく, 一般の体 $K$ の元を成分に持つ行列を扱う場合
  には $K$ 係数多項式の分解体の存在定理が必要になる.}.  %
どちらの方法も一長一短なので両方覚えておくと良いだろう.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{最小二乗法}

何らかの理由で観測できる量 $x_1,\ldots,x_n,y\in\R$ が近似的に
\begin{equation*}
  y = a_1 x_1 + \cdots + a_n x_n 
  \qquad (\text{$a_i\in\R$ は定数})
  \tag{$*$}
\end{equation*}
の関係で結ばれていることがわかっていると仮定する.
そのとき, 実際に観測された量 $x_{i1},\ldots,x_{in},y_i\in\R$ 
($i=1,\ldots,N$) から係数 $a_1,\ldots,a_n\in\R$ を推定するために
最小二乗法がよく使われる.

最小二乗法では, 誤差 $a_1 x_{i1} + \cdots + a_n x_{in} - y_i$ 
($i=1,\ldots,N$) の二乗和が最小になるような $a_1,\ldots,a_n\in\R$ を求める.

次の節では行列 $X=[x_{ij}]\in M_{N,n}(\R)$ の rank が $n$ であるとき,
実際にそのような $a_1,\ldots,a_n\in\R$ が一意的に存在することを証明する.
ただし証明の細部は演習問題とする.
実際に証明をフォローしてみれば数学科の授業で普通に習っている線形代数学が
役に立つことが納得できるだろう.

さらにその次の節では経済学における{\bf Okun の法則 (Okun's law)} を
題材に取り, 最小二乗法によって日本経済の Okun 係数を求める.
ただし例によって詳しい計算は演習問題とする.

\begin{rem}
  $y$ と $x_i$ たちの関係式に定数項がある場合
  \begin{equation*}
    y = a_1 x_1 + \cdots + a_n x_n + b
    \qquad (\text{$a_i,b\in\R$ は定数})
  \end{equation*}
  は $a_{n+1}=b$ でかつ $x_{n+1}$ が常に $1$ であると
  仮定すれば ($*$) の特殊な場合とみなせる.
  \qed
\end{rem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{基礎: 最小値の存在と一意性}

\begin{question}[実対称行列の対角化, 10点]
  \label{q:real-sym-diag}
  $P$ が $n$ 次の実対称行列であるならば, 
  ある $n$ 次直交行列 $U$ で $U^{-1}PU=D$ が実対角行列になるものが存在する.  
  そのとき $D$ の対角成分には $P$ の全ての固有値が重複を込めて並ぶ.
  特に実対称行列の固有値はすべて実数であり,
  $\det P$ は $P$ の固有値全体の積に等しい.
  \qed
\end{question}

\begin{proof}[ヒント]
  $n$ に関する帰納法で $P$ を直交行列で三角化する.
  $P$ が対称行列であることより $\tp{P}P=P^2=P\tp{P}$ が成立するので,
  その三角化は実は対角化であることがわかる.
  別のより洗錬された証明も存在するので,
  複数の教科書を見た方が良いだろう.
  \qed
\end{proof}

\begin{question}[5点]
  $P$ が $n$ 次の実対称行列ならば次の二つの条件は互いに同値である:
  \begin{itemize}
  \item[(a)] $P$ の固有値はすべて正である.
  \item[(b)] 任意の $0$ でないベクトル $v\in\R^n=M_{n,1}(\R)$ に
    対して $\tp{v}Pv > 0$ となる. \qed
  \end{itemize}
\end{question}

\begin{question}[5点]
  $P$ は $n$ 次の実対称行列であるとし, $q\in\R^n=M_{n,1}(\R)$, $r\in\R$ を
  任意に取り, $a\in\R^n$ の函数 $S(a)$ を次のように定める:
  \begin{equation*}
    S(a) := \tp{a}Pa + 2\tp{q}a + r.
  \end{equation*}
  $P$ の固有値がすべて正ならば $S(a)$ を最小にする $a\in\R^n$ 
  が唯一存在し, 次のように表わされる:
  \begin{equation*}
    a = - P^{-1}q.
    \qed
  \end{equation*}
\end{question}

\begin{proof}[ヒント]
  $pa^2-2qa = p(x-q/p)^2 - q^2/p$ の行列版を考える.
  $\tp{(a-P^{-1}q)}P(a-P^{-1}q)$ を計算してみよ.
  \qed
\end{proof}

\begin{question}[5点]
  実 $N\times n$ 行列 $X\in M_{N,n}(\R)$ を任意に取り, $P=\tp{X}X$ と置く.
  このとき $P$ は $n$ 次の実対称行列であり, 
  $P$ の全ての固有値は $0$ 以上である.
  特に $P$ の全ての固有値が正であるための必要十分条件
  は $\det P\ne 0$ が成立することである.
  \qed
\end{question}

\begin{proof}[ヒント]
  $P$ が実対称行列であることはすぐにわかる.
  問題 \qref{q:real-sym-diag} の結果より, 
  $P$ は対角化可能であり, その固有値はすべて実数である.
  $v\in\R^n=M_{n,1}(\R)$ に対して $\tp{v}Pv=\tp{(Xv)}Xv\ge 0$.
  \qed
\end{proof}

\begin{question}[Laplace展開, 10点]
  $K$ は任意の体であるとし, $N > n$ であるとする.
  縦長の行列 $X=[x_{ij}]\in M_{N,n}(K)$ と
  横長の行列 $Y=[y_{ij}]\in M_{n,N}(K)$ について以下が成立する:
  \begin{equation*}
    |YX| =
    \sum_{1\le i_1<\cdots<i_n\le N}
    \begin{vmatrix}
      y_{1i_1} & \cdots & y_{1i_n} \\
      \vdots   &        & \vdots   \\
      y_{ni_1} & \cdots & y_{ni_n} \\
    \end{vmatrix}
    \begin{vmatrix}
      x_{i_11} & \cdots & x_{i_1n} \\
      \vdots   &        & \vdots   \\
      x_{i_n1} & \cdots & x_{i_nn} \\
    \end{vmatrix}.
    \qed
  \end{equation*}
\end{question}

\begin{proof}[ヒント]
  $N=n$ の場合の公式 $|YX|=|Y||X|$ の証明の一般化. \qed
\end{proof}

\begin{question}[5点]
  $K$ は任意の体であり,  $N > n$ であるとし, 
  縦長の行列 $X=[x_{ij}]\in M_{N,n}(K)$ を任意に取る.
  このとき $X$ の rank が $n$ であるための必要十分条件は
  ある $i_1,\ldots,i_n$ で $1\le i_1<\cdots<i_n\le N$ かつ
  \begin{equation*}
    \begin{vmatrix}
      x_{i_11} & \cdots & x_{i_1n} \\
      \vdots   &        & \vdots   \\
      x_{i_n1} & \cdots & x_{i_nn} \\
    \end{vmatrix}
    \ne 0
  \end{equation*}
  を満たすものが存在することである.  \qed
\end{question}

\begin{question}[最小二乗法, 5点]
  $N>n$ であるとし, $X=[x_{ij}]\in M_{N,n}(\R)$, 
  $y=[y_i]\in\R^N=M_{N,1}(\R)$ を任意に取り, 
  $a=[a_j]\in\R^n=M_{n,1}(\R)$ の函数 $S(a)$ を次のように定める:
  \begin{equation*}
    S(a) = \tp{(Xa-y)}(Xa-y)
    = \sum_{i=1}^N
    \left(
      \sum_{j=1}^n a_j x_{ij} - b_i
    \right)^2.
  \end{equation*}
  もしも $A$ の rank が $n$ ならば $S(a)$ を最小にする $a\in\R^n$ が
  唯一存在し, 次のように表わされる:
  \begin{equation*}
    a = \left( \tp{X}X \right)^{-1} \tp{X}y.
    \qed
  \end{equation*}
\end{question}

\begin{proof}[ヒント]
  以上の問題を総合すれば簡単に証明できる. \qed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{応用: Okunの法則}

ほとんどの国では経済成長率と失業率の変化の間に
次の形のかなり安定した関係が成立している:
\begin{equation*}
  (\text{経済成長率}) = - \alpha (\text{失業率の変化}) + \beta
  \qquad (\text{$\alpha, \beta$ は正の定数})
\end{equation*}
この結果は経済学者の Arthur Okun によって1960年代に発見されたので, 
{\bf Okun の法則 (Okun's law)} と呼ばれている.
$\alpha$ は {\bf Okun 係数}と呼ばれており, 
たとえば $\alpha=3$ ならば失業率が $1\%$ 増えると
経済成長率はその $3$ 倍の $3\%$ 減少することになる.

Okun の法則は{\bf 潜在成長率} (持続可能な自然な経済成長率) を求めるために
よく使われる. 
失業率はマイナスにはなれないので, 
失業率を減らしながらの経済成長はいつかは不可能になってしまう. 
逆に失業率を毎年増やしながらの経済成長も持続不可能だろう. 
したがって持続可能な経済成長率は失業率の変化を
ゼロにするような成長率であると考えられる. すなわち
\begin{equation*}
  (\text{Okunの法則から推定した潜在成長率}) = \beta.
\end{equation*}
これはかなり大雑把な推定であるが,
Okun の法則は複雑な経済の世界で珍しいことにかなり安定しているので
現実の政策を考えるときには非常に役に立つ.
潜在成長率を達成できなかった中央政府と中央銀行は
経済政策に失敗した可能性が相当に高い.
(Okun の法則によって潜在成長率の達成に失敗すると
失業率が上昇してしまうことに注意せよ.)

\begin{table}[htbp]
  \centering
  \begin{tabular}{cccc}
    歴年 & 失業率(\%) & 失業率の変化(\%) & 経済成長率(\%) \\
    \hline
    1988 & 2.5 & & \\
    1989 & 2.3 & $-$0.2 &  5.3 \\
    1990 & 2.1 & $-$0.2 &  5.2 \\
    1991 & 2.1 &  0.0 &  3.4 \\
    1992 & 2.2 &  0.1 &  1.0 \\
    1993 & 2.5 &  0.3 &  0.2 \\
    1994 & 2.9 &  0.4 &  1.1 \\
    1995 & 3.2 &  0.3 &  1.9 \\
    1996 & 3.4 &  0.2 &  3.4 \\
    1997 & 3.4 &  0.0 &  1.9 \\
    1998 & 4.1 &  0.7 & $-$1.1 \\
    1999 & 4.7 &  0.6 &  0.1 \\
    2000 & 4.7 &  0.0 &  2.9 \\
    2001 & 5.0 &  0.3 &  0.4 \\
    2002 & 5.4 &  0.4 & $-$0.5 \\
    2003 & 5.3 & $-$0.1 &  2.5 \\
  \end{tabular}
  \caption{日本の失業率と経済成長率}
  \label{tab:J}
\end{table}

\begin{question}[日本経済のOkun係数と潜在成長率の推定, 15点]
  \tableref{tab:J}はインターネットからダウンロードした
  統計データ \cite{unemp2004}, \cite{SNA2003} から数字をコピーして作成した.
  \tableref{tab:J}に最小二乗法を適用して
  日本経済の Okun 係数 $\alpha$ と潜在成長率 $\beta$ を推定せよ.
  \qed
\end{question}

\begin{proof}[ヒント]
  $y=(\text{経済成長率})$, $n=2$, $x_1=(\text{失業率の変化})$, $x_2=1$,
  $a_1=-\alpha$, $a_2=\beta$, $N=15$ とみなし, 前節までの結果を用いよ.
  まず $15\times 2$ 行列 $X$ の第1列に\tableref{tab:J}の失業率の変化を代入し,
  第2列の成分はすべて $1$ であるとする.
  次に $y\in\R^{15}$ には\tableref{tab:J}の経済成長率を代入する.
  そして $a=\tp{[-\alpha,\beta]}$ を $a=(\tp{X}X)^{-1}\tp{X}y$ に
  よって計算する.
  電卓やコンピューターを用いて $\alpha$, $\beta$ の近似値を求めよ.
  \qed
\end{proof}

\commentout{
\begin{proof}[略解]
  $\alpha=6.11034=(\text{Okun係数の推定値})$, 
  $\beta=2.98726\%=(\text{潜在成長率の推定値})$.
  日本経済の潜在成長率は $3\%$ 程度である可能性が高く,
  日本政府と日本銀行は経済政策に10年以上に渡って失敗し続け,
  失業率を $2\%$ 台から $5\%$ に上昇させてしまった.
  失業率を $1\%$ 下げるためには潜在成長率よりも $6\%$ も高い
  経済成長率を必要とする.
  \qed
\end{proof}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{thebibliography}{ABC}

\bibitem[Dirac]{Dirac}
ディラック,~P.~A.~M.:
量子力学, 原書第4版,
朝永振一郎他共訳, 
岩波書店, 1968

\bibitem[Infeld]{Infeld}
インフェルト,~L.:
ガロアの生涯—神々の愛でし人
市井三郎訳, 
日本評論社, 新版第3版, 1996

%\bibitem[Gardner]{Gardner}
%Martin~Gardner: 自然界における左と右, 紀伊国屋書店

\bibitem[佐武]{satake} 佐武一郎: 線型代数学, 裳華房数学選書 1, 324頁.

\bibitem[杉浦]{sugiura}
杉浦光夫, Jordan標準形と単因子論 I, II, 岩波講座基礎数学, 線型代数 iii, 1976

%\bibitem[齋藤]{saito} 齋藤正彦: 線型代数入門, 東京大学出版会基礎数学 
%1, 278頁.

\bibitem[堀田]{10wa} 堀田良之: 加群十話 --- 代数学入門, 朝倉書店, すうがく
ぶっくす 3, 186頁.

%\bibitem[志賀]{shiga}
%志賀浩二: 集合への30講, 朝倉書店 数学30講シリーズ 3, 187頁.

\bibitem[横田]{Yokota}
横田一郎: 群と位相, 裳華房, 基礎数学選書 5

\bibitem[山内・杉浦]{YS}
山内恭彦, 杉浦光雄: 連続群論入門, 培風館, 新数学シリーズ 18

\bibitem[失業率]{unemp2004}
労働力調査　長期時系列データ \\
{\tt http://www.stat.go.jp/howto/case1/01.htm} \\
から「第3表(3)年齢階級(5歳階級)，男女別完全失業者数及び完全失業率」 \\
{\tt http://www.stat.go.jp/data/roudou/longtime/zuhyou/lt03-03.xls} \\
をダウンロード

\bibitem[GDP]{SNA2003} 
平成15年度国民経済計算 \\
{\tt http://www.esri.cao.go.jp/jp/sna/h17-nenpou/17annual-report-j.html} \\
から「4．主要系列表（3）経済活動別国内総生産　実質暦年」\\
{\tt http://www.esri.cao.go.jp/jp/sna/h17-nenpou/80fcm3r\verb,_,jp.xls} \\
をダウンロード

\end{thebibliography}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
